# matchGlob

**Type:** Documentation
**Repository:** Yoshi-Audit
**File:** internal/docker/protection.go
**Language:** go
**Lines:** 47-58
**Complexity:** 5.0

---

## Source Code

```go
func matchGlob(pattern, name string) bool {
	if strings.HasPrefix(pattern, "*") && strings.HasSuffix(pattern, "*") && !strings.Contains(pattern[1:len(pattern)-1], "*") {
		inner := pattern[1 : len(pattern)-1]
		return strings.Contains(strings.ToLower(name), strings.ToLower(inner))
	}

	matched, err := filepath.Match(strings.ToLower(pattern), strings.ToLower(name))
	if err != nil {
		return false
	}
	return matched
}
```

---

## Documentation

### Documentation for `matchGlob` Function

**Purpose and Behavior:**
The `matchGlob` function determines if a given file name matches a glob pattern, considering special cases where the pattern contains only wildcards (`*`). It performs case-insensitive matching using Go's `filepath.Match` for standard patterns and custom logic for wildcard-only patterns.

**Key Implementation Details:**
- The function first checks if the pattern consists solely of wildcards. If so, it converts both the name and inner pattern to lowercase and checks for substring presence.
- For non-wildcard patterns, it uses Go's `filepath.Match` with case-insensitive conversion to determine a match.

**When/Why to Use:**
Use this function when you need to perform file name matching against glob patterns in a case-insensitive manner. It is particularly useful in scenarios where wildcard-only patterns or mixed pattern types are involved.

**Patterns and Gotchas:**
- The function assumes that the input pattern will be either a standard glob pattern or one containing only wildcards.
- Be cautious with performance when using this function extensively, as `filepath.Match` involves string manipulation. For large-scale matching, consider optimizing or caching results if applicable.

---

*Generated by CodeWorm on 2026-03-01 07:51*
