# parseCPULine

**Type:** Documentation
**Repository:** Yoshi-Audit
**File:** internal/system/cpu.go
**Language:** go
**Lines:** 15-34
**Complexity:** 5.0

---

## Source Code

```go
func parseCPULine(line string) (idle, total uint64, err error) {
	fields := strings.Fields(line)
	if len(fields) < 5 {
		return 0, 0, fmt.Errorf("not enough fields in cpu line: %q", line)
	}

	var sum uint64
	for i := 1; i < len(fields); i++ {
		val, parseErr := strconv.ParseUint(fields[i], 10, 64)
		if parseErr != nil {
			return 0, 0, fmt.Errorf("failed to parse field %d: %w", i, parseErr)
		}
		sum += val
		if i == 4 {
			idle = val
		}
	}

	return idle, sum, nil
}
```

---

## Documentation

### Documentation for `parseCPULine`

**Purpose and Behavior:**
The function `parseCPULine` extracts CPU idle time from a line of text, typically parsed from system monitoring output. It returns the idle time as an `uint64`, the total CPU usage as a sum of all fields, and an error if parsing fails.

**Key Implementation Details:**
- The function takes a single string argument representing a line of CPU data.
- It uses `strings.Fields` to split the input into fields.
- If there are fewer than 5 fields, it returns an error indicating insufficient data.
- Each field is parsed as a uint64. If parsing fails for any field, it returns an error with detailed information about which field caused the issue.
- The idle time is identified and stored in the `idle` variable when processing the fourth field.

**When/Why to Use This Code:**
Use this function whenever you need to parse CPU usage data from a log or monitoring tool. It ensures robust parsing by validating input length and handling errors gracefully, making it suitable for integration with various system monitoring tools that output CPU statistics in a tabular format.

**Patterns/Gotchas:**
- The function handles errors comprehensively, providing clear error messages indicating the exact field causing issues.
- Using `uint64` ensures that large values are handled correctly without overflow. However, ensure input data is within expected ranges to avoid unexpected behavior.
- The function assumes a specific format for CPU line fields; adjust if your input format varies.

---

*Generated by CodeWorm on 2026-03-01 08:10*
