# ShannonEntropy

**Type:** Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/rules/entropy.go
**Language:** go
**Lines:** 48-83
**Complexity:** 9.0

---

## Source Code

```go
func ShannonEntropy(data, charset string) float64 {
	if len(data) == 0 {
		return 0.0
	}

	filtered := data
	if charset != "" {
		cs := charsetSet(charset)
		var b strings.Builder
		b.Grow(len(data))
		for _, c := range data {
			if cs[c] {
				b.WriteRune(c)
			}
		}
		filtered = b.String()
		if len(filtered) == 0 {
			return 0.0
		}
	}

	freq := make(map[rune]int)
	for _, c := range filtered {
		freq[c]++
	}

	length := float64(len([]rune(filtered)))
	entropy := 0.0
	for _, count := range freq {
		p := float64(count) / length
		if p > 0 {
			entropy -= p * math.Log2(p)
		}
	}
	return entropy
}
```

---

## Documentation

### Documentation for `ShannonEntropy` Function

**Purpose and Behavior:**
The `ShannonEntropy` function calculates the Shannon entropy of a given string relative to a specified character set. Entropy measures the unpredictability or randomness in the data, which can be useful in analyzing the information content or detecting anomalies.

**Key Implementation Details:**
- **Filtering:** The input string is optionally filtered based on a provided character set. If `charset` is non-empty, characters not in this set are removed.
- **Frequency Calculation:** A map tracks the frequency of each character in the (possibly) filtered data.
- **Entropy Calculation:** Using these frequencies, the function computes the Shannon entropy using logarithms.

**When/Why to Use:**
This code should be used when you need to quantify the randomness or unpredictability of a string. It's particularly useful in cybersecurity for detecting patterns that might indicate encrypted or compressed data.

**Patterns and Gotchas:**
- **Error Handling:** The function does not explicitly handle errors, relying on return values.
- **Performance Considerations:** Filtering large strings can be costly; consider the input size when using this function.
- **Charset Dependency:** Ensure the `charset` is correctly specified to avoid unexpected results.

---

*Generated by CodeWorm on 2026-03-01 02:14*
