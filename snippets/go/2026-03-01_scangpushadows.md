# ScanGPUShadows

**Type:** Documentation
**Repository:** Yoshi-Audit
**File:** internal/audit/scanner.go
**Language:** go
**Lines:** 143-163
**Complexity:** 4.0

---

## Source Code

```go
func (s *Scanner) ScanGPUShadows(procs []system.ProcessInfo, gpuProcs []system.GPUProcess) []Finding {
	pidSet := make(map[int]bool)
	for _, p := range procs {
		pidSet[p.PID] = true
	}

	var findings []Finding
	for _, gp := range gpuProcs {
		if !pidSet[gp.PID] {
			findings = append(findings, Finding{
				Type:     FindingGPUShadow,
				Severity: SeverityWarn,
				PID:      gp.PID,
				Name:     fmt.Sprintf("gpu-pid-%d", gp.PID),
				Message:  "GPU process not visible in process list",
				Detail:   fmt.Sprintf("VRAM usage: %d MiB", gp.UsedVRAM/(1024*1024)),
			})
		}
	}
	return findings
}
```

---

## Documentation

### Documentation for `ScanGPUShadows` Function

**Purpose and Behavior:**
The `ScanGPUShadows` function in the `Scanner` struct checks for GPU processes that are not listed in the main process list. It returns a slice of findings, each detailing an unmatched GPU process with its VRAM usage.

**Key Implementation Details:**
1. **PID Set Construction:** A map is created to store PIDs from the main process list (`procs`).
2. **Finding Collection:** For each GPU process in `gpuProcs`, if its PID is not found in the map, a `Finding` struct is appended to the results.
3. **Finding Struct:** Each finding includes details like severity, type, and VRAM usage.

**When/Why to Use:**
Use this function when you need to identify GPU processes that are running but not listed among regular system processes. This can help in detecting potential security or performance issues related to hidden processes.

**Patterns/Gotchas:**
- **Error Handling:** The code assumes no errors from `fmt.Sprintf`. Ensure proper error handling if using these functions.
- **Performance:** Iterating over both process lists could be costly for large systems, consider optimizations if necessary.

---

*Generated by CodeWorm on 2026-03-01 08:51*
