# GetMemoryInfo

**Type:** Documentation
**Repository:** Yoshi-Audit
**File:** internal/system/memory.go
**Language:** go
**Lines:** 36-89
**Complexity:** 8.0

---

## Source Code

```go
func GetMemoryInfo() (MemoryInfo, error) {
	f, err := os.Open("/proc/meminfo")
	if err != nil {
		return MemoryInfo{}, err
	}
	defer f.Close()

	values := make(map[string]uint64)
	scanner := bufio.NewScanner(f)
	for scanner.Scan() {
		line := scanner.Text()
		parts := strings.SplitN(line, ":", 2)
		if len(parts) != 2 {
			continue
		}

		key := strings.TrimSpace(parts[0])
		valStr := strings.TrimSpace(parts[1])
		valStr = strings.TrimSuffix(valStr, " kB")
		valStr = strings.TrimSpace(valStr)

		val, parseErr := strconv.ParseUint(valStr, 10, 64)
		if parseErr != nil {
			continue
		}

		values[key] = val * 1024
	}

	if err := scanner.Err(); err != nil {
		return MemoryInfo{}, err
	}

	memTotal, ok := values["MemTotal"]
	if !ok {
		return MemoryInfo{}, fmt.Errorf("MemTotal not found in /proc/meminfo")
	}

	memAvailable, ok := values["MemAvailable"]
	if !ok {
		return MemoryInfo{}, fmt.Errorf("MemAvailable not found in /proc/meminfo")
	}

	swapTotal := values["SwapTotal"]
	swapFree := values["SwapFree"]

	return MemoryInfo{
		TotalRAM:     memTotal,
		UsedRAM:      memTotal - memAvailable,
		AvailableRAM: memAvailable,
		TotalSwap:    swapTotal,
		UsedSwap:     swapTotal - swapFree,
	}, nil
}
```

---

## Documentation

### Documentation for `GetMemoryInfo` Function

**Purpose and Behavior:**
The `GetMemoryInfo` function reads system memory information from the `/proc/meminfo` file on Linux systems, parsing key metrics such as total RAM, used RAM, available RAM, total swap space, and used swap space. It returns a structured `MemoryInfo` object along with an error if any issues occur.

**Key Implementation Details:**
- The function opens and reads the `/proc/meminfo` file using `os.Open`.
- It uses a `bufio.Scanner` to parse each line of the file.
- Each parsed line is split into key-value pairs, where keys are memory-related metrics like "MemTotal" and values are in kilobytes (converted to bytes by multiplying with 1024).
- The function handles potential parsing errors and missing keys by returning appropriate error messages.

**When/Why to Use:**
Use this code when you need to retrieve detailed system memory statistics, such as for monitoring or diagnostics purposes. It is particularly useful in Linux environments where `/proc/meminfo` provides comprehensive memory information.

**Patterns/Gotchas:**
- The function employs idiomatic Go error handling with `return MemoryInfo{}, err`.
- It uses `defer f.Close()` to ensure the file is closed after reading.
- Missing keys like "MemTotal" or "MemAvailable" will result in an error, so always check if these values are present before using them.

---

*Generated by CodeWorm on 2026-03-01 00:00*
