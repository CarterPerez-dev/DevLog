# CategorizeVolume

**Type:** Documentation
**Repository:** Yoshi-Audit
**File:** internal/docker/categorize.go
**Language:** go
**Lines:** 40-63
**Complexity:** 8.0

---

## Source Code

```go
func CategorizeVolume(vol VolumeInfo, protectionPatterns []string) SafetyCategory {
	pe := NewProtectionEngine(protectionPatterns)
	if pe.MatchesPattern(vol.Name) {
		return CategoryDoNotTouch
	}

	if strings.Contains(strings.ToLower(vol.Name), "backup") {
		return CategoryCheckFirst
	}

	if vol.Links > 0 {
		return CategoryDoNotTouch
	}

	if looksLikeHash(vol.Name) && vol.Size <= 0 {
		return CategorySafe
	}

	if vol.Name != "" && vol.Size > 0 {
		return CategoryProbablySafe
	}

	return CategorySafe
}
```

---

## Documentation

### Documentation for `CategorizeVolume` Function

**Purpose and Behavior:**
The `CategorizeVolume` function categorizes a volume based on its name, size, and links count against predefined protection patterns. It returns one of several safety categories to indicate the handling required.

**Key Implementation Details:**
- **Protection Engine:** Utilizes a `NewProtectionEngine(protectionPatterns)` to match the volume's name against defined patterns.
- **String Matching:** Checks if "backup" is in the volume’s name (case-insensitive).
- **Link Count and Size:** Ignores volumes with links > 0 or negative size, categorizing them as safe.
- **Hash-like Names:** Categorizes volumes that look like hashes and have a non-positive size as `CategorySafe`.

**When/Why to Use:**
This function is useful in scenarios where you need to quickly classify volumes for backup or security purposes. It can be employed in automated systems that require categorization based on volume metadata.

**Patterns and Gotchas:**
- **Case Sensitivity:** The "backup" check is case-insensitive, which might lead to false positives if the name contains mixed cases.
- **Pattern Matching:** Relying solely on pattern matching could miss volumes with similar names. Consider expanding protection patterns for better accuracy.
- **Error Handling:** No explicit error handling for `NewProtectionEngine` or `looksLikeHash`. Ensure robustness in production environments by adding appropriate checks.

This function embodies Go’s simplicity and conciseness, making it a good example of conditional logic in file system analysis.

---

*Generated by CodeWorm on 2026-03-01 00:08*
