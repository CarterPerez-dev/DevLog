# email_validator

**Type:** Documentation
**Repository:** CertGames-Core
**File:** backend/api/domains/account/middleware/schemas.py
**Language:** python
**Lines:** 197-240
**Complexity:** 13.0

---

## Source Code

```python
def email_validator(email: str) -> str:
    """
    Validates an email with strict rules:
    """
    errors = []
    if not email:
        raise ValueError("Email is required.")

    email_nfc = trim_and_normalize(email).lower()

    if not AuthConfig.Email.MIN_LENGTH <= len(
            email_nfc) <= AuthConfig.Email.MAX_LENGTH:
        errors.append(
            f"Email length must be between {AuthConfig.Email.MIN_LENGTH} and {AuthConfig.Email.MAX_LENGTH} characters."
        )

    for ch in email_nfc:
        if ch in AuthConfig.Email.FORBIDDEN_CHARS:
            errors.append(
                "Email contains forbidden characters like <, >, or whitespace."
            )
            break

    if email_nfc.count("@") != 1:
        errors.append("Email must contain exactly one '@' symbol.")
    else:
        parts = email_nfc.split("@")
        if len(parts) == 2:
            local_part, domain_part = parts
            if not local_part:
                errors.append("Email must have a local part before '@'.")
            if not domain_part:
                errors.append("Email must have a domain after '@'.")
            elif "." not in domain_part:
                errors.append(
                    "Email domain must contain at least one '.'."
                )
            elif domain_part.startswith(".") or domain_part.endswith("."):
                errors.append("Email domain cannot start or end with '.'.")

    if errors:
        raise ValueError("; ".join(errors))

    return str(email_nfc)
```

---

## Documentation

### Documentation for `email_validator` Function

**Purpose and Behavior:**
The `email_validator` function validates an email string according to strict rules, ensuring it meets length requirements, avoids forbidden characters, contains exactly one '@' symbol, and has a valid local and domain part. If any validation fails, it raises a `ValueError` with detailed error messages.

**Key Implementation Details:**
- **Normalization:** The input email is normalized using the `trim_and_normalize()` function to remove leading/trailing whitespace and convert to lowercase.
- **Length Check:** Validates that the email length falls within specified limits (`MIN_LENGTH` and `MAX_LENGTH`).
- **Character Validation:** Checks for forbidden characters in the email.
- **Symbol Counting:** Ensures there is exactly one '@' symbol, splits the email into local and domain parts, and validates each part.

**When/Why to Use:**
Use this function whenever you need to validate user-provided email addresses before processing or storing them. It ensures data integrity by catching common issues like invalid characters, incorrect length, and malformed structure.

**Patterns/Gotchas:**
- The function uses a list of errors to accumulate multiple validation failures, which are then joined into a single error message.
- The `trim_and_normalize()` function is assumed to exist but not defined in the snippet. Ensure this function handles edge cases like non-alphanumeric characters.
- Be cautious with the forbidden character check; adding more forbidden characters requires updating both the list and the error message template.

---

*Generated by CodeWorm on 2026-02-27 18:01*
