# QuestionSchema.validate_choices

**Repository:** CertGames-Core
**File:** backend/api/admin/domains/testing/schemas.py
**Language:** python
**Lines:** 93-112
**Complexity:** 7.0

---

## Source Code

```python
def validate_choices(cls, v: list[str]) -> list[str]:
        """
        Validate answer choices
        """
        if not v:
            raise ValueError("At least 2 choices are required")

        valid_choices = []
        for choice in v:
            if isinstance(choice, str) and choice.strip():
                if len(choice.strip()) > 500:
                    raise ValueError(
                        "Choice text too long (max 500 characters)"
                    )
                valid_choices.append(choice.strip())

        if len(valid_choices) < 2:
            raise ValueError("At least 2 valid choices are required")

        return valid_choices
```

---

## Documentation

### Documentation for `validate_choices`

**Purpose and Behavior:**
The `validate_choices` method is a class method that validates a list of answer choices for a question schema. It ensures at least two non-empty, valid choices are provided and each choice does not exceed 500 characters.

**Key Implementation Details:**
- **Input:** A list of strings (`v`).
- **Output:** A validated list of strings.
- **Validation Steps:**
  - Checks if the input list is empty; raises `ValueError` if true.
  - Iterates through each choice, strips leading/trailing spaces, and checks its length. If a choice exceeds 500 characters, it raises an error.
  - Collects valid choices into a new list.
  - Ensures at least two valid choices are present; otherwise, raises `ValueError`.

**When/Why to Use:**
Use this method in schema validation for question models where answer choices need to be validated. It ensures data integrity by enforcing minimum choice requirements and character limits.

**Patterns/Gotchas:**
- The use of `strip()` on each choice is a common pattern to clean input data.
- Raising specific `ValueError` messages helps with debugging and user feedback.
- This method can be applied using the `@field_validator('choices')` decorator, ensuring it runs during schema validation.

---

*Generated by CodeWorm on 2026-01-12 18:05*
