# alert_formatter

**Type:** Documentation
**Repository:** Telehook
**File:** src/telehook/formatters/alert.py
**Language:** python
**Lines:** 11-31
**Complexity:** 4.0

---

## Source Code

```python
def alert_formatter(
    title: str,
    app: str | None = None,
    last_error: str | None = None,
    details: str | None = None,
) -> str:
    header = f"\u26a0\ufe0f <b>{title}</b>"
    if app:
        header = f"\u26a0\ufe0f <b>{app}: {title}</b>"

    timestamp = datetime.now(UTC).strftime("%Y-%m-%d %H:%M:%S UTC")
    parts = [header, ""]

    if last_error:
        parts.append(f"<b>Last error:</b> <code>{last_error}</code>")
    if details:
        parts.append(f"{details}")

    parts.append(f"<b>Time:</b> {timestamp}")

    return truncate("\n".join(parts))
```

---

## Documentation

### Documentation for `alert_formatter`

**Purpose and Behavior:**
The `alert_formatter` function constructs a formatted alert message suitable for Telegram notifications. It takes in a title, optional application name (`app`), last error message (`last_error`), and additional details (`details`). The function formats these inputs into a structured string with a timestamp and returns it truncated if necessary.

**Key Implementation Details:**
- **Type Hints:** The parameters are annotated with type hints to specify expected input types.
- **Conditional Formatting:** Depending on the presence of `app`, the title is prefixed accordingly. Additional details like `last_error` and `details` can be appended conditionally.
- **Timestamp Generation:** Uses `datetime.now(UTC)` to get the current time in UTC, formatted as a string.
- **Truncation:** The final message is truncated using the `truncate` function.

**When/Why to Use:**
Use this function when you need to generate structured alert messages for Telegram notifications. It handles optional parameters gracefully and ensures that the output includes relevant information such as error details and timestamps, making it ideal for logging or notification purposes.

**Patterns/Gotchas:**
- Ensure `truncate` is defined elsewhere in your codebase, as it's used but not defined here.
- The use of Unicode symbols (`\u26a0\ufe0f`) for alert indicators should be consistent with the Telegram API requirements.

---

*Generated by CodeWorm on 2026-02-28 19:10*
