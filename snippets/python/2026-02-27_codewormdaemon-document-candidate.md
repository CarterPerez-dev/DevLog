# CodeWormDaemon._document_candidate

**Type:** Documentation
**Repository:** CodeWorm
**File:** codeworm/daemon.py
**Language:** python
**Lines:** 579-657
**Complexity:** 6.0

---

## Source Code

```python
async def _document_candidate(self, candidate: AnalysisCandidate) -> bool:
        """
        Legacy method - generate documentation and commit for an AnalysisCandidate
        """
        self.logger.info(
            "documenting",
            function = candidate.snippet.display_name,
            repo = candidate.snippet.repo,
            score = round(candidate.score,
                          2),
            dry_run = self.dry_run,
        )

        try:
            client = await self._init_llm()
            generator = DocumentationGenerator(client, self.settings.prompts)
            doc = await generator.generate(candidate)

            if self.dry_run:
                self.logger.info(
                    "dry_run_complete",
                    function = candidate.snippet.display_name,
                    tokens = doc.tokens_used,
                    time_ms = doc.generation_time_ms,
                    would_commit = doc.commit_message,
                )
                return True

            markdown_content = doc.to_markdown(candidate)

            file_path = self.devlog.write_snippet(
                content = markdown_content,
                filename = doc.snippet_filename,
                language = candidate.snippet.language.value,
            )

            result = self.devlog.commit(
                message = doc.commit_message,
                files = [file_path],
            )

            self.state.record_documentation(
                snippet = candidate.snippet,
                snippet_path = str(file_path.relative_to(self.devlog.repo_path)),
                git_commit = result.commit_hash,
            )

            self.logger.info(
                "documentation_committed",
                function = candidate.snippet.display_name,
                commit = result.commit_hash,
                tokens = doc.tokens_used,
                time_ms = doc.generation_time_ms,
            )

            if self.settings.devlog.remote:
                try:
                    self.devlog.push()
                    self.logger.info("push_successful")
                except Exception as e:
                    self.logger.warning("push_failed", error = str(e))

            return True

        except OllamaError as e:
            self.logger.error(
                "llm_error",
                function = candidate.snippet.display_name,
                error = str(e),
            )
            return False

        except Exception as e:
            self.logger.exception(
                "documentation_failed",
                function = candidate.snippet.display_name,
                error = str(e),
            )
            return False
```

---

## Documentation

### Documentation for `_document_candidate` Method

**Purpose and Behavior:**
The `CodeWormDaemon._document_candidate` method is responsible for generating documentation for a given `AnalysisCandidate`. It uses an LLM client to generate the documentation, writes it to a Markdown file, commits the changes to a Git repository, and logs relevant information. The method handles both dry-run scenarios and actual commits.

**Key Implementation Details:**
- **Asynchronous Execution:** Uses `async` for asynchronous operations like initializing the LLM client.
- **Logging:** Extensive logging is used to track the progress and outcomes of each step.
- **Error Handling:** Catches specific errors (`OllamaError`) and generic exceptions, providing detailed logs on failures.

**When/Why to Use This Code:**
This method should be used when integrating or extending the documentation generation process in a code analysis tool. It ensures that candidate snippets are documented according to specified prompts and settings, facilitating better understanding and maintenance of the codebase.

**Patterns and Gotchas:**
- **Dry Run:** The method supports dry runs to simulate commits without actually pushing changes, useful for testing.
- **Error Handling:** Robust error handling is crucial as it logs detailed information on failures, aiding in debugging.
- **Asynchronous Operations:** Proper use of async/await ensures efficient execution, especially when dealing with I/O-bound tasks like file operations and network requests.

---

*Generated by CodeWorm on 2026-02-27 22:19*
