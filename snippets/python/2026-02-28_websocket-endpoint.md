# websocket_endpoint

**Type:** Documentation
**Repository:** CodeWorm
**File:** dashboard/backend/ws.py
**Language:** python
**Lines:** 113-125
**Complexity:** 4.0

---

## Source Code

```python
async def websocket_endpoint(websocket: WebSocket) -> None:
    await manager.connect(websocket)
    try:
        while True:
            data = await websocket.receive_text()
            if data == "ping":
                await websocket.send_text(
                    orjson.dumps({
                        "type": "pong"
                    }).decode("utf-8")
                )
    except (WebSocketDisconnect, RuntimeError):
        manager.disconnect(websocket)
```

---

## Documentation

### Documentation for `websocket_endpoint` Function

**Purpose and Behavior:**
The `websocket_endpoint` function is an asynchronous handler designed to manage WebSocket connections in a web application. It connects the incoming WebSocket, listens for text messages, and handles specific logic when receiving "ping" messages by sending back a "pong" message.

**Key Implementation Details:**
- **Parameters:** Takes a single parameter `websocket`, which is annotated as a `WebSocket` object.
- **Asynchronous Handling:** Uses `async/await` to handle asynchronous operations like connecting, receiving, and sending data over the WebSocket connection.
- **Error Handling:** Catches `WebSocketDisconnect` and `RuntimeError` exceptions to ensure proper cleanup by calling `manager.disconnect(websocket)`.

**When/Why to Use This Code:**
This function is ideal for implementing WebSocket endpoints in real-time applications such as chat systems, live updates, or any scenario requiring bidirectional communication between the client and server. It ensures that connections are properly managed and handles unexpected disconnections gracefully.

**Patterns and Gotchas:**
- **Type Hints:** The use of `WebSocket` type hints improves code readability and maintainability.
- **Error Handling:** Proper error handling is crucial to avoid leaving WebSocket connections in an undefined state, which could lead to resource leaks or other issues.
- **JSON Encoding:** Note the use of `orjson.dumps()` for encoding data. This can be optimized if performance becomes a concern.

This function exemplifies best practices in asynchronous web development with Python and WebSockets.

---

*Generated by CodeWorm on 2026-02-28 13:15*
