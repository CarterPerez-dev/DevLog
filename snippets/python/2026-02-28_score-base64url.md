# _score_base64url

**Type:** Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 95-119
**Complexity:** 11.0

---

## Source Code

```python
def _score_base64url(data: str) -> float:
    stripped = "".join(data.split())
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0
    if not all(c in BASE64URL_CHARSET for c in stripped):
        return 0.0

    score = W.B64URL_BASE

    has_url_chars = any(c in stripped for c in "-_")
    has_std_chars = any(c in stripped for c in "+/")

    if has_url_chars and not has_std_chars:
        score += W.B64URL_SAFE_CHARS
    elif not has_url_chars:
        return 0.0

    decoded = try_decode(stripped, EncodingFormat.BASE64URL)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Documentation

### Documentation for `_score_base64url` Function

**Purpose and Behavior:**
The function `_score_base64url` evaluates the validity of a Base64URL-encoded string by checking its structure, character set, and decodability. It returns a score between 0.0 and 1.0 based on various criteria.

**Key Implementation Details:**
- **Input Validation:** The input is stripped of whitespace and checked for minimum length and valid characters.
- **Character Set Check:** Scores are adjusted if the string contains URL-safe characters (`-` or `_`) but not standard Base64 characters (`+` or `/`).
- **Decoding Attempt:** The function attempts to decode the string using `try_decode`. If successful, it adds a score for correct decoding and further checks if the result is printable text.
- **Score Clamping:** The final score is capped at 1.0.

**When/Why to Use:**
This function should be used in scenarios where you need to validate Base64URL-encoded data, such as ensuring input integrity before processing or storing it. It helps in identifying valid encodings and detecting common errors early.

**Patterns/Gotchas:**
- The use of `try_decode` is a key pattern for handling potential decoding failures gracefully.
- The function relies on external definitions for `MIN_INPUT_LENGTH`, `BASE64URL_CHARSET`, `W.B64URL_BASE`, etc., which should be defined elsewhere in the codebase.
- The score calculation involves multiple conditional checks, making it crucial to ensure that all conditions are correctly accounted for.

---

*Generated by CodeWorm on 2026-02-28 15:36*
