# DataInputService.update_video

**Type:** Documentation
**Repository:** angelamos-operations
**File:** CarterOS-Server/src/aspects/analytics/facets/data_input/service.py
**Language:** python
**Lines:** 112-130
**Complexity:** 2.0

---

## Source Code

```python
async def update_video(
        session: AsyncSession,
        video_id: UUID,
        data: TikTokVideoUpdate,
    ) -> TikTokVideoResponse:
        """
        Update a video record
        """
        video = await TikTokVideoRepository.get_by_id(session, video_id)
        if not video:
            raise TikTokVideoNotFound(video_id)

        update_dict = data.model_dump(exclude_unset = True)
        video = await TikTokVideoRepository.update(
            session,
            video,
            **update_dict
        )
        return TikTokVideoResponse.model_validate(video)
```

---

## Documentation

### Documentation for `update_video`

**Purpose and Behavior:**
The `update_video` function updates a video record in the database using an asynchronous session. It first retrieves the video by its ID, then applies any provided update data to the video object, and finally returns a response containing the updated video details.

**Key Implementation Details:**
- **Parameters:** 
  - `session`: An instance of `AsyncSession` for database operations.
  - `video_id`: A `UUID` representing the video's unique identifier.
  - `data`: An instance of `TikTokVideoUpdate`, containing fields to update.
  
- **Return Value:**
  - Returns an instance of `TikTokVideoResponse` with updated video data.

- **Error Handling:** 
  - Raises a `TikTokVideoNotFound` exception if the video is not found in the database.

- **Data Transformation:**
  - Uses `data.model_dump(exclude_unset=True)` to create a dictionary containing only fields that have been set, which are then applied to the video object using `update`.

**When/Why to Use This Code:**
Use this function whenever you need to update specific fields of a video record in your database. It ensures that only specified fields are updated, making it efficient and safe.

**Patterns and Gotchas:**
- **Asynchronous Handling:** The use of `async` makes the function suitable for integration with other asynchronous operations.
- **Repository Pattern:** The function relies on repository methods (`get_by_id`, `update`) to interact with the database, promoting separation of concerns.
- **Data Validation:** By excluding unset fields in the update dictionary, it prevents accidental overwriting of unchanged fields.

---

*Generated by CodeWorm on 2026-02-27 19:17*
