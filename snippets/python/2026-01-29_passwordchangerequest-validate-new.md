# PasswordChangeRequest.validate_new_password

**Repository:** vuemantics
**File:** backend/schemas/user.py
**Language:** python
**Lines:** 121-135
**Complexity:** 4.0

---

## Source Code

```python
def validate_new_password(cls, v: str, info: ValidationInfo) -> str:
        """
        Validate new password using centralized validation logic.
        """
        is_valid, error_msg = validate_password_strength(v)
        if not is_valid:
            raise ValueError(error_msg)

        if "current_password" in info.data and v == info.data[
                "current_password"]:
            raise ValueError(
                "New password must be different from current password"
            )

        return v
```

---

## Documentation

### Documentation for `validate_new_password`

**Purpose and Behavior**
The `validate_new_password` method is a class method that validates a new password against certain criteria:
1. It checks if the password meets predefined strength requirements.
2. It ensures the new password is different from the current password.

**Key Implementation Details**
- **Parameters**: 
  - `v: str`: The new password to validate.
  - `info: ValidationInfo`: Contains contextual information, including the current password.
  
- **Logic**:
  - Calls `validate_password_strength(v)` to check strength and raises a `ValueError` if invalid.
  - Compares the new password with the current one; raises an error if they match.

- **Return**: Returns the validated password string if all checks pass.

**When/Why to Use This Code**
Use this method in your validation logic for user password changes. It ensures passwords meet complexity requirements and are not reused, enhancing security.

**Patterns/Gotchas**
- The `@field_validator("new_password")` decorator indicates it's part of a schema validation process.
- Ensure that the `ValidationInfo` object is correctly populated with the current password to avoid false positives.
- Be cautious about performance if `validate_password_strength` involves complex operations, as this method is called for every new password change.

---

*Generated by CodeWorm on 2026-01-29 12:22*
