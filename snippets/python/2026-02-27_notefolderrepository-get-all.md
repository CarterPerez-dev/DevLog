# NoteFolderRepository.get_all

**Type:** Documentation
**Repository:** angelamos-operations
**File:** CarterOS-Server/src/aspects/life_manager/facets/notes/repository.py
**Language:** python
**Lines:** 24-37
**Complexity:** 2.0

---

## Source Code

```python
async def get_all(
        cls,
        session: AsyncSession,
    ) -> Sequence[NoteFolder]:
        """
        Get all non-deleted folders ordered by sort_order and name
        """
        result = await session.execute(
            select(NoteFolder).where(
                NoteFolder.deleted_at.is_(None)
            ).order_by(NoteFolder.sort_order,
                       NoteFolder.name)
        )
        return result.scalars().all()
```

---

## Documentation

### Documentation for `NoteFolderRepository.get_all`

**Purpose and Behavior:**
The `get_all` method retrieves all non-deleted `NoteFolder` objects from the database, ordered first by `sort_order` and then by `name`. It uses an asynchronous session to execute a SQL query that filters out deleted folders.

**Key Implementation Details:**
- **Asynchronous Functionality:** The function is marked with `async`, indicating it operates within an asynchronous context.
- **Session Dependency:** It takes an `AsyncSession` object as a parameter, which is used to interact with the database asynchronously.
- **SQLAlchemy Usage:** The method uses SQLAlchemy's `select` and `where` constructs to build and execute a query. The result is filtered by non-deleted folders using `deleted_at.is_(None)`.
- **Ordering:** Results are ordered first by `sort_order`, then by `name`.

**When/Why to Use This Code:**
Use this method when you need to fetch all active (non-deleted) folder entries in a sorted manner. It is particularly useful for displaying folders in a user interface where order and relevance matter.

**Patterns and Gotchas:**
- **Asynchronous Context:** Ensure that the calling function or context manager supports asynchronous operations.
- **Session Management:** Properly manage the `AsyncSession` to avoid database connection issues, such as closing it after use with a context manager like `async with session:`.
- **Error Handling:** Consider adding error handling for cases where the session might fail or the query returns no results.

---

*Generated by CodeWorm on 2026-02-27 19:47*
