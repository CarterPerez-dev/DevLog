# ChallengeService.update_log

**Type:** Documentation
**Repository:** angelamos-operations
**File:** CarterOS-Server/src/aspects/challenge/facets/tracker/service.py
**Language:** python
**Lines:** 311-358
**Complexity:** 3.0

---

## Source Code

```python
async def update_log(
        session: AsyncSession,
        log_date: date,
        data: LogUpdate,
    ) -> LogResponse:
        """
        Update a log by date
        """
        challenge = await ChallengeRepository.get_active(session)
        if not challenge:
            raise ChallengeNotFound()

        log = await ChallengeLogRepository.get_by_date(
            session,
            challenge.id,
            log_date,
        )
        if not log:
            raise LogNotFound(log_date)

        update_dict = data.model_dump(exclude_unset = True)
        log = await ChallengeLogRepository.update(
            session,
            log,
            **update_dict
        )

        return LogResponse(
            id = log.id,
            challenge_id = log.challenge_id,
            log_date = log.log_date,
            day_number = ChallengeService._calculate_day_number(
                challenge,
                log.log_date
            ),
            tiktok = log.tiktok,
            instagram_reels = log.instagram_reels,
            youtube_shorts = log.youtube_shorts,
            twitter = log.twitter,
            reddit = log.reddit,
            linkedin_personal = log.linkedin_personal,
            linkedin_company = log.linkedin_company,
            youtube_full = log.youtube_full,
            medium = log.medium,
            jobs_applied = log.jobs_applied,
            created_at = log.created_at,
            updated_at = log.updated_at,
        )
```

---

## Documentation

### Documentation for `update_log` Function

**Purpose and Behavior:**
The `update_log` function updates a log entry in the database based on a specified date, ensuring that only relevant fields are updated by using data from an instance of `LogUpdate`. It retrieves the active challenge, checks if a log exists for the given date, and then updates it with new data.

**Key Implementation Details:**
- **Async Operations:** Uses asynchronous methods to interact with the database.
- **Data Validation:** Ensures that both the challenge and log exist before proceeding. Raises custom exceptions `ChallengeNotFound` and `LogNotFound`.
- **Partial Updates:** Utilizes Pydantic's `model_dump(exclude_unset=True)` to update only fields that have been set in the input data.

**When/Why to Use:**
This function is used when you need to update a log entry for a specific challenge date. It ensures that updates are performed efficiently by only modifying necessary fields, making it ideal for scenarios where partial updates are common.

**Patterns and Gotchas:**
- **Custom Exceptions:** The use of custom exceptions (`ChallengeNotFound`, `LogNotFound`) helps in handling specific error conditions gracefully.
- **Repository Pattern:** Leverages repository methods to abstract database interactions, promoting cleaner code and easier testing.
- **Partial Updates:** Using `model_dump(exclude_unset=True)` avoids unnecessary updates, which can improve performance.

---

*Generated by CodeWorm on 2026-02-27 18:17*
