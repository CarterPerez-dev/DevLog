# identify_protocol

**Type:** Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/network-traffic-analyzer/python/src/netanal/analyzer.py
**Language:** python
**Lines:** 41-68
**Complexity:** 12.0

---

## Source Code

```python
def identify_protocol(packet: Packet) -> Protocol:
    """
    Identify the highest level protocol in a packet
    """
    if packet.haslayer(DNS):
        return Protocol.DNS

    if packet.haslayer(TCP):
        tcp_layer = packet[TCP]
        if tcp_layer.dport == Ports.HTTP or tcp_layer.sport == Ports.HTTP:
            return Protocol.HTTP
        if tcp_layer.dport == Ports.HTTPS or tcp_layer.sport == Ports.HTTPS:
            return Protocol.HTTPS
        return Protocol.TCP

    if packet.haslayer(UDP):
        udp_layer = packet[UDP]
        if udp_layer.dport == Ports.DNS or udp_layer.sport == Ports.DNS:
            return Protocol.DNS
        return Protocol.UDP

    if packet.haslayer(ICMP):
        return Protocol.ICMP

    if packet.haslayer(ARP):
        return Protocol.ARP

    return Protocol.OTHER
```

---

## Documentation

### Documentation for `identify_protocol` Function

**Purpose and Behavior:**
The `identify_protocol` function determines the highest-level protocol present in a network packet based on layer presence and port numbers. It returns an instance of the `Protocol` enum, which categorizes protocols like DNS, HTTP, HTTPS, TCP, UDP, ICMP, ARP, and OTHER.

**Key Implementation Details:**
- The function takes a single parameter `packet`, annotated as `Packet`.
- It uses conditional checks to identify specific layers (`DNS`, `TCP`, `UDP`, `ICMP`, `ARP`) within the packet.
- For TCP and UDP, it further checks destination and source port numbers to refine protocol identification.

**When/Why to Use:**
This function is ideal for network traffic analysis where you need to quickly categorize packets based on their protocols. It's particularly useful in security tools or network monitoring systems that require real-time protocol identification.

**Patterns and Gotchas:**
- The code uses a series of `if` statements, which can be extended with additional protocols.
- Be cautious when adding new protocols; ensure all necessary layers are checked.
- The function assumes the presence of specific layers (`DNS`, `TCP`, etc.), so it may not work correctly if these layers are missing or altered.

---

*Generated by CodeWorm on 2026-02-28 17:03*
