# error_formatter

**Type:** Documentation
**Repository:** Telehook
**File:** src/telehook/formatters/error.py
**Language:** python
**Lines:** 12-50
**Complexity:** 4.0

---

## Source Code

```python
def error_formatter(
    exception: BaseException,
    component: str,
    app: str | None = None,
) -> str:
    error_type = type(exception).__name__
    error_msg = str(exception)

    frames = tb_module.extract_tb(exception.__traceback__)
    condensed_lines = []
    for frame in frames:
        filename = frame.filename.rsplit("/", maxsplit = 1)[-1]
        condensed_lines.append(
            f"  {filename}:{frame.lineno} \u2192 {frame.name}()"
        )

    condensed_tb = "\n".join(
        condensed_lines
    ) if condensed_lines else "  (no traceback)"

    header = f"\U0001f534 <b>Error: {component}</b>"
    if app:
        header = f"\U0001f534 <b>{app} \u2014 Error: {component}</b>"

    timestamp = datetime.now(UTC).strftime("%Y-%m-%d %H:%M:%S UTC")

    parts = [
        header,
        "",
        f"<code>{error_type}: {error_msg}</code>",
        "",
        "<b>Traceback (condensed):</b>",
        f"<pre>{condensed_tb}</pre>",
        "",
        f"<b>Component:</b> {component}",
        f"<b>Time:</b> {timestamp}",
    ]

    return truncate("\n".join(parts))
```

---

## Documentation

### Documentation for `error_formatter`

**Purpose and Behavior:**
The `error_formatter` function formats an exception into a human-readable string, including the error type, message, traceback (condensed), component name, and timestamp. It is designed to provide clear and structured error messages.

**Key Implementation Details:**
- **Parameters:** 
  - `exception`: The BaseException instance.
  - `component`: A string indicating the affected component.
  - `app` (optional): An app-specific identifier for more detailed logging.
  
- **Traceback Handling:** 
  - Extracts and condenses the traceback to show only relevant file names, line numbers, and function names.

- **Formatting:**
  - Uses Unicode symbols and HTML-like tags (`<code>`, `<pre>`), suitable for rendering in web interfaces or logs.
  - Appends a header with an emoji and component name, optionally including app details.

**When/Why to Use This Code:**
Use this function when you need to log or display detailed error information in a structured format. It is particularly useful in logging frameworks where clear, formatted errors are required for debugging and monitoring.

**Patterns/Gotchas:**
- Ensure that the `tb_module` and `datetime` imports are available.
- The `truncate` function must be defined elsewhere; otherwise, this will raise an error.
- Be mindful of the emoji usage if your logging system does not support Unicode symbols.

---

*Generated by CodeWorm on 2026-02-28 18:14*
