# ReportService.get_report

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/bug-bounty-platform/backend/app/report/service.py
**Language:** python
**Lines:** 79-136
**Complexity:** 11.0

---

## Source Code

```python
async def get_report(
        self,
        user: User,
        report_id: UUID,
    ) -> ReportDetailResponse:
        """
        Get report by ID with details
        """
        report = await ReportRepository.get_by_id_with_details(
            self.session,
            report_id
        )
        if not report:
            raise ReportNotFound(str(report_id))

        program = await ProgramRepository.get_by_id(
            self.session,
            report.program_id
        )

        is_researcher = report.researcher_id == user.id
        is_program_owner = program and program.company_id == user.id

        if not is_researcher and not is_program_owner:
            raise ReportNotFound(str(report_id))

        comments = report.comments
        if is_researcher and not is_program_owner:
            comments = [c for c in comments if not c.is_internal]

        return ReportDetailResponse(
            id = report.id,
            created_at = report.created_at,
            updated_at = report.updated_at,
            program_id = report.program_id,
            researcher_id = report.researcher_id,
            title = report.title,
            description = report.description,
            steps_to_reproduce = report.steps_to_reproduce,
            impact = report.impact,
            severity_submitted = report.severity_submitted,
            severity_final = report.severity_final,
            status = report.status,
            cvss_score = report.cvss_score,
            cwe_id = report.cwe_id,
            bounty_amount = report.bounty_amount,
            duplicate_of_id = report.duplicate_of_id,
            triaged_at = report.triaged_at,
            resolved_at = report.resolved_at,
            disclosed_at = report.disclosed_at,
            comments = [
                CommentResponse.model_validate(c) for c in comments
            ],
            attachments = [
                AttachmentResponse.model_validate(a)
                for a in report.attachments
            ],
        )
```

---

## Documentation

### Documentation for `ReportService.get_report`

**Purpose and Behavior:**
The `get_report` method retrieves a detailed report by its ID, checking permissions based on the user's role (researcher or program owner). It returns a structured response containing the report details and comments.

**Key Implementation Details:**
- **Asynchronous:** Uses `async/await` for database operations.
- **Error Handling:** Raises `ReportNotFound` if the report is not found or access is denied.
- **Permissions Check:** Ensures the user has permission to view the report by comparing their ID with the researcher's and program owner's IDs.
- **Comment Filtering:** Filters out internal comments if the user is a researcher but not an owner.

**When/Why to Use:**
Use this method when you need to fetch detailed information about a specific bug report, ensuring that only authorized users can access it. Itâ€™s particularly useful in a bug bounty platform where permissions and data visibility are critical.

**Patterns and Gotchas:**
- **Type Hints:** Utilizes type hints for parameters and return types, enhancing code readability.
- **Context Managers:** Implicitly uses context managers for database sessions (not shown but implied).
- **Validation:** Uses Pydantic models to validate the response structure, ensuring data integrity.

This method is a good example of handling asynchronous operations, permission checks, and structured responses in Python.

---

*Generated by CodeWorm on 2026-01-16 20:10*
