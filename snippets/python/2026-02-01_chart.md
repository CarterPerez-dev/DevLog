# chart

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/network-traffic-analyzer/src/netanal/main.py
**Language:** python
**Lines:** 372-444
**Complexity:** 10.0

---

## Source Code

```python
def chart(
    pcap_file: Annotated[
        Path,
        typer.Argument(help = "PCAP file to visualize")
    ],
    chart_type: Annotated[
        str,
        typer.Option(
            "--type",
            "-t",
            help = "Chart type (protocols, top-talkers, bandwidth, all)"
        ),
    ] = "all",
    output: Annotated[
        Path | None,
        typer.Option(
            "--output",
            "-o",
            help = "Output file path (for single chart)"
        ),
    ] = None,
    output_dir: Annotated[
        Path | None,
        typer.Option(
            "--output-dir",
            "-d",
            help = "Output directory (for all charts)"
        ),
    ] = None,
) -> None:
    """
    [bold green]Generate charts[/bold green] from capture data

    Examples:
        anal chart traffic.pcap --type protocols -o protocols.png
        anal chart traffic.pcap --type all -d ./charts/
    """
    if not pcap_file.exists():
        print_error(f"File not found: {pcap_file}")
        raise typer.Exit(1)

    packets = analyze_pcap_file(str(pcap_file))

    from netanal.statistics import StatisticsCollector
    collector = StatisticsCollector()
    collector.start()

    for packet in packets:
        collector.record_packet(packet)

    stats = collector.get_statistics()

    if chart_type == "all":
        out_dir = output_dir or Path(".")
        generated = generate_all_charts(stats, out_dir)
        for path in generated:
            print_success(f"Generated {path}")
    else:
        if not output:
            output = Path(f"{chart_type}.png")

        if chart_type == "protocols":
            fig = create_protocol_bar_chart(stats)
        elif chart_type == "top-talkers":
            fig = create_top_talkers_chart(stats)
        elif chart_type == "bandwidth":
            fig = create_bandwidth_chart(stats)
        else:
            print_error(f"Unknown chart type: {chart_type}")
            raise typer.Exit(1)

        save_chart(fig, output)
        print_success(f"Generated {output}")
```

---

## Documentation

### Documentation for `chart` Function

**Purpose and Behavior:**  
The `chart` function generates network traffic analysis charts from a PCAP file. It supports various chart types (protocols, top-talkers, bandwidth) and can output to either a single file or a directory.

**Key Implementation Details:**
- Utilizes Typer for command-line argument parsing.
- Validates the input PCAP file existence before processing.
- Uses `StatisticsCollector` from `netanal.statistics` to collect packet statistics.
- Dynamically generates charts based on specified type and saves them to either an output file or directory.

**When/Why to Use:**
Use this function when analyzing network traffic data visually. It's particularly useful for security analysts, network administrators, or researchers who need quick insights into traffic patterns without manually creating each chart.

**Patterns & Gotchas:**
- The `chart_type` parameter is optional and defaults to "all", which generates all types of charts.
- Ensure the PCAP file exists before running; otherwise, it exits with an error message.
- The function handles different output scenarios (single file or directory) based on user input.

This function encapsulates complex chart generation logic into a single command-line utility, making network traffic analysis more accessible and efficient.

---

*Generated by CodeWorm on 2026-02-01 09:43*
