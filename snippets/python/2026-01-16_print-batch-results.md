# print_batch_results

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/dns-lookup/dnslookup/output.py
**Language:** python
**Lines:** 269-328
**Complexity:** 13.0

---

## Source Code

```python
def print_batch_results(results: list[DNSResult]) -> None:
    """
    Display batch lookup results in a summary table
    """
    table = Table(
        title = "[bold]Batch Results[/bold]",
        box = box.ROUNDED,
        border_style = "blue",
        row_styles = ["",
                      "dim"],
    )

    table.add_column("Domain", style = "cyan", min_width = 25)
    table.add_column("A", justify = "center", width = 15)
    table.add_column("MX", justify = "center", width = 5)
    table.add_column("NS", justify = "center", width = 5)
    table.add_column(
        "Time",
        justify = "right",
        style = "dim",
        width = 8
    )

    for result in results:
        a_records = [
            r for r in result.records if r.record_type == RecordType.A
        ]
        mx_count = len(
            [
                r for r in result.records
                if r.record_type == RecordType.MX
            ]
        )
        ns_count = len(
            [
                r for r in result.records
                if r.record_type == RecordType.NS
            ]
        )

        a_value = a_records[0].value if a_records else "[dim]-[/dim]"
        mx_value = str(mx_count) if mx_count else "[dim]-[/dim]"
        ns_value = str(ns_count) if ns_count else "[dim]-[/dim]"

        table.add_row(
            result.domain,
            a_value,
            mx_value,
            ns_value,
            f"{result.query_time_ms:.0f}ms",
        )

    console.print(table)

    total_records = sum(len(r.records) for r in results)
    total_time = sum(r.query_time_ms for r in results)
    console.print(
        f"\n[green]:heavy_check_mark:[/green] {len(results)} domains, {total_records} total records in {total_time:.0f}ms"
    )
    console.print()
```

---

## Documentation

### Documentation for `print_batch_results`

**Purpose and Behavior:**
The function `print_batch_results` displays a summary table of DNS lookup results. It takes a list of `DNSResult` objects, each containing multiple records (A, MX, NS), and formats them into a readable table with domain names, record types, and query times.

**Key Implementation Details:**
- Utilizes the `rich` library for creating styled tables.
- Dynamically adds columns based on DNS record types.
- Handles cases where certain record types are missing by displaying "[dim]-[/dim]".
- Calculates total records and query time across all domains.

**When/Why to Use This Code:**
Use this function when you need a clear, formatted output of DNS lookup results. It's particularly useful for batch processing and summarizing large sets of domain data in a user-friendly manner.

**Patterns and Gotchas:**
- The function relies on the `rich` library for table creation, which must be installed.
- Ensure that each `DNSResult` object contains valid records to avoid runtime errors.
- The `console.print()` calls are essential for outputting the summary information. Adjust the console settings as needed for different environments.

This code is ideal for integrating into a larger DNS lookup application where detailed reporting is required, ensuring both functionality and readability.

---

*Generated by CodeWorm on 2026-01-16 18:30*
