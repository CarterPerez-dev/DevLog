# ExperienceFactory.create

**Repository:** my-portfolio
**File:** v1/backend/conftest.py
**Language:** python
**Lines:** 326-359
**Complexity:** 4.0

---

## Source Code

```python
async def create(
        cls,
        session: AsyncSession,
        *,
        language: Language = Language.ENGLISH,
        company: str | None = None,
        role: str | None = None,
        start_date: date | None = None,
        end_date: date | None = None,
        is_current: bool = False,
        description: str | None = None,
        employment_type: EmploymentType = EmploymentType.FULL_TIME,
        is_visible: bool = True,
    ) -> Experience:
        cls._counter += 1

        experience = Experience(
            language = language,
            company = company or f"Test Company {cls._counter}",
            role = role or f"Software Engineer {cls._counter}",
            start_date = start_date or date(2023,
                                            1,
                                            1),
            end_date = end_date,
            is_current = is_current,
            description = description
            or f"Experience description {cls._counter}",
            employment_type = employment_type,
            is_visible = is_visible,
        )
        session.add(experience)
        await session.flush()
        await session.refresh(experience)
        return experience
```

---

## Documentation

### Documentation for `ExperienceFactory.create`

#### 1. Purpose and Behavior
The `create` method is a class method that asynchronously creates an instance of the `Experience` class within an `AsyncSession`. It initializes various attributes with default values or user-provided ones, adds the new experience to the session, and flushes the session to ensure changes are written to the database. Finally, it refreshes the object to update its state.

#### 2. Key Implementation Details
- **Class Method**: The `@classmethod` decorator indicates that this method operates on the class itself rather than an instance of the class.
- **Default Values and Optional Parameters**: The method accepts optional parameters for various attributes like `company`, `role`, `start_date`, etc., with default values provided. These defaults are useful when creating test data or initializing experiences without specifying all details.
- **Session Management**: Uses an `AsyncSession` to manage database operations asynchronously, ensuring that changes are committed properly.

#### 3. When/Why to Use This Code
This method is ideal for scenarios where you need to programmatically create experience entries in a database, such as during testing or when populating initial data. The flexibility of default values allows easy creation of multiple instances with minimal code.

#### 4. Patterns and Gotchas
- **Counter Logic**: The `_counter` class-level variable increments each time `create` is called, which can be useful for generating unique identifiers but may lead to issues if not managed carefully across different sessions or tests.
- **Default Values vs. None Handling**: While default values provide convenience, always consider whether a `None` value should trigger the fallback logic, as this might not align with all use cases.

This method encapsulates complex database interaction into a simple API, making it easier to manage and test experience data in your application.

---

*Generated by CodeWorm on 2026-01-25 19:00*
