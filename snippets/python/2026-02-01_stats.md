# stats

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/network-traffic-analyzer/src/netanal/main.py
**Language:** python
**Lines:** 251-312
**Complexity:** 8.0

---

## Source Code

```python
def stats(
    pcap_file: Annotated[
        Path,
        typer.Argument(help = "PCAP file to analyze")
    ],
    bandwidth: Annotated[
        bool,
        typer.Option(
            "--bandwidth",
            "-b",
            help = "Show bandwidth statistics"
        ),
    ] = False,
    protocols: Annotated[
        bool,
        typer.Option(
            "--protocols",
            "-p",
            help = "Show protocol distribution"
        ),
    ] = False,
    endpoints: Annotated[
        bool,
        typer.Option(
            "--endpoints",
            "-e",
            help = "Show endpoint statistics"
        ),
    ] = False,
) -> None:
    """
    [bold green]Display statistics[/bold green] from a PCAP file

    Examples:
        anal stats traffic.pcap --bandwidth
        anal stats traffic.pcap --protocols --endpoints
    """
    if not pcap_file.exists():
        print_error(f"File not found: {pcap_file}")
        raise typer.Exit(1)

    packets = analyze_pcap_file(str(pcap_file))

    from netanal.statistics import StatisticsCollector
    collector = StatisticsCollector()
    collector.start()

    for packet in packets:
        collector.record_packet(packet)

    stats = collector.get_statistics()

    print_capture_summary(stats)

    if protocols or (not bandwidth and not endpoints):
        print_protocol_table(stats)

    if endpoints:
        print_top_talkers(stats, limit = 20)

    if bandwidth:
        print_bandwidth_stats(stats)
```

---

## Documentation

### Documentation for `stats` Function

**Purpose and Behavior:**  
The `stats` function analyzes a PCAP (Packet Capture) file and generates various network traffic statistics, including bandwidth, protocol distribution, and endpoint activity. It uses command-line arguments to customize the output.

**Key Implementation Details:**
- **Type Hints and Typer Decorators:** The function parameters are annotated with type hints and decorated using `typer` for command-line argument parsing.
- **Packet Analysis:** Packets from the PCAP file are analyzed using a custom `StatisticsCollector`.
- **Conditional Output:** Depending on user input, different types of statistics (bandwidth, protocols, endpoints) are printed.

**When/Why to Use:**
This function is ideal for network administrators or cybersecurity analysts who need to quickly assess the characteristics of network traffic. It can be used in automated scripts or interactively via a command line interface.

**Patterns and Gotchas:**
- **Command-Line Interface:** The use of `typer` simplifies handling command-line arguments, making it easy to extend functionality.
- **Error Handling:** If the PCAP file does not exist, an error message is printed, and execution exits. Ensure robustness by providing a valid path.
- **Performance Considerations:** Processing large PCAP files can be resource-intensive; consider optimizing packet analysis for performance.

This function provides a flexible way to generate network traffic statistics based on user preferences, making it a valuable tool in network monitoring and analysis.

---

*Generated by CodeWorm on 2026-02-01 09:55*
