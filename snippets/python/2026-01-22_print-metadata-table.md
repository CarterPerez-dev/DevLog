# print_metadata_table

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/metadata-scrubber-tool/src/utils/display.py
**Language:** python
**Lines:** 22-115
**Complexity:** 11.0

---

## Source Code

```python
def print_metadata_table(metadata: dict[str, Any]):
    """
    Display metadata in a formatted table organized by logical groups.

    Organizes metadata into categories (Device Info, Exposure Settings,
    Image Data, Dates) and displays them in a Rich panel with color coding.

    Args:
        metadata: Dict of metadata key-value pairs to display.
    """

    # Define the groups using simple lists of keys
    groups = {
        "üìÑ Document Info": [
            "Author",
            "author",
            "/Author",
            "/Creator",
        ],
        "üì∏ Device Info": ["Make",
                          "Model",
                          "Software",
                          "ExifVersion"],
        "‚öôÔ∏è Exposure Settings": [
            "ExposureTime",
            "FNumber",
            "ISOSpeedRatings",
            "ShutterSpeedValue",
            "ApertureValue",
            "Flash",
            "FocalLength",
        ],
        "üñºÔ∏è Image Data": [
            "ImageWidth",
            "ImageLength",
            "PixelXDimension",
            "PixelYDimension",
            "Orientation",
            "ResolutionUnit",
        ],
        "üìÖ Dates": [
            "DateTime",
            "DateTimeOriginal",
            "DateTimeDigitized",
            "OffsetTime",
            "created",
            "modified",
            "/CreationDate",
            "/ModDate",
        ],
    }

    # Create the main table
    table = Table(box = box.ROUNDED, show_header = True, header_style = "bold magenta")
    table.add_column("Property", style = "cyan")
    table.add_column("Value", style = "green")

    # Track which keys we have displayed to handle the "leftovers"
    displayed_keys = set()

    # Loop through the defined groups to create sections
    for section_name, keys in groups.items():
        # Check if we have any data for this section
        section_data = {k: metadata[k] for k in keys if k in metadata}

        if section_data:
            # Add a section row (acts as a sub-header)
            table.add_row(Text(section_name, style = "bold yellow"), "")

            for key, val in section_data.items():
                table.add_row(f"  {key}", clean_value(val))
                displayed_keys.add(key)

            # Add a blank row for spacing
            table.add_section()

    # Handle "Other" (Any keys that isn't in the groups)
    leftovers = {
        k: v
        for k, v in metadata.items()
        if k not in displayed_keys and k != "JPEGInterchangeFormat"
    }  # skip binary blobs
    if leftovers:
        table.add_row(Text("üìù Other", style = "bold yellow"), "")
        for key, val in leftovers.items():
            table.add_row(f"  {key}", clean_value(val))

    # Print nicely inside a panel
    console.print(
        Panel(table,
              title = "Metadata Report",
              border_style = "blue",
              expand = False)
    )
```

---

## Documentation

### Documentation for `print_metadata_table`

**Purpose and Behavior:**
The `print_metadata_table` function organizes metadata from a dictionary into logical groups (e.g., Document Info, Device Info) and displays them in a formatted table using the Rich library. Each group is displayed as a section with color-coded headers, and individual key-value pairs are shown with clean values.

**Key Implementation Details:**
- **Metadata Grouping:** Metadata keys are categorized into predefined groups like "Document Info," "Device Info," etc., defined in a dictionary.
- **Rich Table Creation:** A Rich table is created to display the metadata. Each group has its header, and key-value pairs within each group are displayed with appropriate styling.
- **Handling Leftovers:** Any metadata keys not categorized into predefined groups are grouped under an "Other" section.

**When/Why to Use:**
Use this function when you need to present complex metadata in a structured and visually appealing format. It's particularly useful for debugging or displaying detailed information about files, such as EXIF data from images.

**Patterns and Gotchas:**
- **Type Hints:** The `metadata` parameter is annotated with `dict[str, Any]`, indicating it can contain any type of value.
- **Rich Library Usage:** Utilizes the Rich library for enhanced console output. Ensure this dependency is installed in your environment.
- **Key Handling:** Carefully manage key presence and absence to avoid errors or missing data.

This function provides a clean, organized way to display metadata, making it easier to understand and debug complex datasets.

---

*Generated by CodeWorm on 2026-01-22 03:23*
