# AnalyticsService._calculate_performance_status

**Repository:** CertGames-Core
**File:** backend/api/admin/domains/analytics/services.py
**Language:** python
**Lines:** 686-726
**Complexity:** 13.0

---

## Source Code

```python
def _calculate_performance_status(metrics: dict[str, Any]) -> str:
        """
        Calculate overall performance status based on key metrics.
        """
        try:
            score = 100

            exec_time = metrics.get("avg_execution_time_ms", 0)
            if exec_time > 100:
                score -= 30
            elif exec_time > 50:
                score -= 15

            hit_rate = metrics.get("index_hit_rate", 100)
            if hit_rate < 80:
                score -= 25
            elif hit_rate < 95:
                score -= 10

            slow_queries = metrics.get("slow_queries_count", 0)
            if slow_queries > 10:
                score -= 20
            elif slow_queries > 5:
                score -= 10

            errors = metrics.get("error_count", 0)
            if errors > 0:
                score -= 15

            if score >= 90:
                return "excellent"
            if score >= 75:
                return "good"
            if score >= 50:
                return "warning"
            if score >= 0:
                return "critical"
            return "critical"

        except Exception:
            return "unknown"
```

---

## Documentation

### Documentation for `_calculate_performance_status`

**Purpose and Behavior**
The function `AnalyticsService._calculate_performance_status` evaluates the overall performance status of a system based on various metrics such as average execution time, index hit rate, slow queries count, and error count. It returns one of four statuses: "excellent," "good," "warning," or "critical."

**Key Implementation Details**
- **Metrics Handling**: The function accepts a dictionary `metrics` containing performance-related keys like `avg_execution_time_ms`, `index_hit_rate`, `slow_queries_count`, and `error_count`.
- **Scoring System**: A score is initialized at 100, which decreases based on the values of these metrics. For instance, if the average execution time exceeds 50ms, points are deducted.
- **Exception Handling**: The function includes a try-except block to handle potential errors gracefully by returning "unknown" in case of an exception.

**When/Why to Use This Code**
Use this code when you need to assess and categorize system performance based on multiple metrics. It is particularly useful for monitoring and reporting purposes, ensuring that critical issues are flagged early.

**Patterns and Gotchas**
- **Static Method**: The `@staticmethod` decorator indicates that the method does not operate on an instance of the class but can be called directly from the class.
- **Hardcoded Scores**: The scoring system is hardcoded, making it less flexible. Consider using a configuration file or environment variables for dynamic score adjustments.
- **Potential Deduction Logic**: Ensure all conditions and deductions are correctly defined to avoid unintended performance status classifications.

---

*Generated by CodeWorm on 2026-01-21 15:10*
