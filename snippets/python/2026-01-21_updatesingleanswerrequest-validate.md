# UpdateSingleAnswerRequest.validate_question_id

**Repository:** CertGames-Core
**File:** backend/api/domains/testing/middleware/schemas.py
**Language:** python
**Lines:** 120-157
**Complexity:** 8.0

---

## Source Code

```python
def validate_question_id(cls, v: int | str) -> int | str:

        if isinstance(v, str):
            v_str: str = trim_and_normalize(v)
            if not v_str:
                raise ValidationError("Question ID is required")
            try:
                return int(v_str)
            except ValueError:
                if len(v_str) > Business.TEST_QUESTION_ID_MAX_LENGTH:
                    raise ValidationError(
                        "Question ID too long",
                        context = {
                            "length": len(v_str),
                            "max": Business.TEST_QUESTION_ID_MAX_LENGTH
                        }
                    ) from None
                return v_str
        elif isinstance(v, int):
            if v < 0:
                raise ValidationError(
                    "Question ID cannot be negative",
                    context = {"value": v}
                )
            if v > Business.TEST_QUESTION_ID_MAX_VALUE:
                raise ValidationError(
                    "Question ID too large",
                    context = {
                        "value": v,
                        "max": Business.TEST_QUESTION_ID_MAX_VALUE
                    }
                )
            return v
        else:
            raise ValidationError(
                "Question ID must be integer or string",
                context = {"type": type(v).__name__}
            )
```

---

## Documentation

### Documentation for `validate_question_id`

**Purpose and Behavior**
The function `validate_question_id` ensures that a provided question ID is either an integer or a string, and meets specific validation criteria. It trims and normalizes the input if it's a string, checks its length, and converts it to an integer when possible.

**Key Implementation Details**
- **Type Handling**: The function accepts `v` as an `int | str` and returns the same type.
- **Validation Steps**:
  - Converts strings to integers after trimming and normalizing.
  - Checks for empty strings or negative integers, raising `ValidationError` if necessary.
  - Ensures string lengths do not exceed a maximum defined in `Business.TEST_QUESTION_ID_MAX_LENGTH`.
  - Validates integer values against `Business.TEST_QUESTION_ID_MAX_VALUE`.

**When/Why to Use This Code**
Use this function when validating question IDs in API requests. It ensures consistency and correctness of input data, preventing issues like invalid or too large IDs from reaching the business logic.

**Patterns and Gotchas**
- **Type Checking**: The function uses `isinstance` for type checking, which is Pythonic.
- **Error Handling**: It raises a custom `ValidationError` with context to provide detailed error messages. Be mindful of the context provided in exceptions as it can be crucial for debugging.
- **Trimming and Normalizing**: String inputs are trimmed and normalized before conversion, ensuring that leading/trailing spaces do not affect validation.

This function is particularly useful in scenarios where you need robust input validation to maintain data integrity.

---

*Generated by CodeWorm on 2026-01-21 20:37*
