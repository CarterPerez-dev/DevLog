# lookup_whois

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/dns-lookup/dnslookup/whois_lookup.py
**Language:** python
**Lines:** 62-126
**Complexity:** 23.0

---

## Source Code

```python
def lookup_whois(domain: str) -> WhoisResult:
    """
    Perform WHOIS lookup for a domain
    """
    result = WhoisResult(domain = domain)

    try:
        w = whois.whois(domain)

        if w is None or (hasattr(w,
                                 "domain_name")
                         and w.domain_name is None):
            result.error = "Domain not found or WHOIS data unavailable"
            return result

        result.registrar = w.registrar if hasattr(
            w,
            "registrar"
        ) else None
        result.creation_date = w.creation_date if hasattr(
            w,
            "creation_date"
        ) else None
        result.expiration_date = w.expiration_date if hasattr(
            w,
            "expiration_date"
        ) else None
        result.updated_date = w.updated_date if hasattr(
            w,
            "updated_date"
        ) else None

        if hasattr(w, "status"):
            status = w.status
            if isinstance(status, str):
                result.status = [status]
            elif isinstance(status, list):
                result.status = status
            else:
                result.status = []

        if hasattr(w, "name_servers") and w.name_servers:
            ns = w.name_servers
            if isinstance(ns, str):
                result.name_servers = [ns.lower()]
            elif isinstance(ns, list):
                result.name_servers = [n.lower() for n in ns if n]
            else:
                result.name_servers = []

        if hasattr(w, "org"):
            result.registrant = w.org
        elif hasattr(w, "name"):
            result.registrant = w.name

        if hasattr(w, "country"):
            result.registrant_country = w.country

        if hasattr(w, "dnssec"):
            result.dnssec = str(w.dnssec) if w.dnssec else None

    except Exception as e:
        result.error = str(e)

    return result
```

---

## Documentation

### Documentation for `lookup_whois` Function

**Purpose and Behavior:**
The `lookup_whois` function performs a WHOIS lookup for a given domain name, returning structured results in the form of a `WhoisResult` object. It handles various attributes such as registrar, creation date, expiration date, updated date, status, name servers, registrant, country, and DNSSEC.

**Key Implementation Details:**
- The function accepts a single parameter (`domain`) and returns an instance of `WhoisResult`.
- It uses the `whois` library to fetch WHOIS data.
- Conditional checks ensure that only present attributes are assigned to the result object.
- Error handling captures exceptions, setting the error message in the result if something goes wrong.

**When/Why to Use:**
Use this function when you need detailed information about a domain's registration and status. It is particularly useful for validation or monitoring purposes where WHOIS data is required but not readily available through other means.

**Patterns/Gotchas:**
- The use of `try-except` ensures robust error handling.
- Conditional checks on attributes (e.g., `hasattr`) prevent potential `AttributeError`.
- Lowercasing name servers and filtering empty values ensure clean, consistent data.

---

*Generated by CodeWorm on 2026-01-13 23:21*
