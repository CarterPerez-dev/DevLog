# WebVital.record_metric

**Repository:** CertGames-Core
**File:** backend/api/admin/models/analytics/WebVital.py
**Language:** python
**Lines:** 78-114
**Complexity:** 6.0

---

## Source Code

```python
def record_metric(
        cls,
        metric_name,
        value,
        *,
        page_url = None,
        user_agent = None,
        session_id = None,
        unit = None,
        **kwargs
    ):
        """
        Record a web vital metric
        """
        user_agent_family = None
        if user_agent:
            if 'Chrome' in user_agent:
                user_agent_family = 'Chrome'
            elif 'Firefox' in user_agent:
                user_agent_family = 'Firefox'
            elif 'Safari' in user_agent:
                user_agent_family = 'Safari'
            elif 'Edge' in user_agent:
                user_agent_family = 'Edge'

        vital = cls(
            metric_name = metric_name,
            value = value,
            page_url = page_url,
            user_agent = user_agent,
            user_agent_family = user_agent_family,
            session_id = session_id,
            unit = unit,
            **kwargs
        )
        vital.save()
        return vital
```

---

## Documentation

### Documentation for `record_metric` Method

**Purpose and Behavior**
The `record_metric` method is a class method that records web vital metrics, such as page load times or user interaction data. It initializes a new instance of the `WebVital` class with provided metric details and saves it to the database.

**Key Implementation Details**
- **Parameters**: 
  - `cls`: The class itself (using `@classmethod`).
  - `metric_name`, `value`: Required fields for the metric.
  - `page_url`, `user_agent`, `session_id`, `unit`: Optional parameters with default values.
  - `**kwargs`: Additional keyword arguments to pass through.

- **User Agent Parsing**: The method checks if the user agent string contains keywords like "Chrome", "Firefox", etc., and sets the corresponding `user_agent_family`.

- **Initialization and Saving**: A new `WebVital` instance is created with all provided parameters, then saved to the database using the `save()` method.

**When/Why to Use This Code**
Use this method when you need to log web vital metrics for analytics. It handles optional fields gracefully and ensures that user agent information is categorized appropriately.

**Patterns and Gotchas**
- The use of `@classmethod` allows the method to be called on the class itself, not an instance.
- The method assumes that the `WebVital` class has a `save()` method for persistence. Ensure this method exists in your implementation.
- The user agent parsing is simple but may need expansion if more browser families are added or if more complex logic is required.

---

*Generated by CodeWorm on 2026-01-13 19:19*
