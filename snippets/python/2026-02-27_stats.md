# stats

**Type:** Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/network-traffic-analyzer/python/src/netanal/main.py
**Language:** python
**Lines:** 263-315
**Complexity:** 7.0

---

## Source Code

```python
def stats(
    pcap_file: Annotated[
        Path,
        typer.Argument(help="PCAP file to analyze"),
    ],
    bandwidth: Annotated[
        bool,
        typer.Option(
            "--bandwidth",
            "-b",
            help="Show bandwidth statistics",
        ),
    ] = False,
    protocols: Annotated[
        bool,
        typer.Option(
            "--protocols",
            "-p",
            help="Show protocol distribution",
        ),
    ] = False,
    endpoints: Annotated[
        bool,
        typer.Option(
            "--endpoints",
            "-e",
            help="Show endpoint statistics",
        ),
    ] = False,
) -> None:
    """
    [bold green]Display statistics[/bold green] from a PCAP file

    Examples:
        netanal stats traffic.pcap --bandwidth
        netanal stats traffic.pcap --protocols --endpoints
    """
    if not pcap_file.exists():
        print_error(f"File not found: {pcap_file}")
        raise typer.Exit(1)

    stats_result, _ = _analyze_pcap_to_stats(pcap_file)

    print_capture_summary(stats_result)

    if protocols or (not bandwidth and not endpoints):
        print_protocol_table(stats_result)

    if endpoints:
        print_top_talkers(stats_result, limit=20)

    if bandwidth:
        print_bandwidth_stats(stats_result)
```

---

## Documentation

### Documentation for `stats` Function

**Purpose and Behavior:**
The `stats` function in the `netanal` module analyzes a PCAP (Packet Capture) file and displays various statistics, including bandwidth, protocol distribution, and endpoint statistics.

**Key Implementation Details:**
- The function accepts four optional boolean flags (`--bandwidth`, `--protocols`, `--endpoints`) to control which statistics are displayed.
- It uses the `typer` library for command-line argument parsing.
- If the specified PCAP file does not exist, an error message is printed and the program exits.

**When/Why to Use This Code:**
Use this function when you need to quickly analyze network traffic data from a PCAP file. The ability to selectively display different types of statistics makes it flexible for various use cases, such as troubleshooting or reporting.

**Patterns and Gotchas:**
- The function leverages `typer` for command-line interface (CLI) arguments, making it easy to integrate into a CLI tool.
- Boolean flags default to `False`, allowing the user to selectively enable only the required statistics without specifying all options.
- Ensure that the PCAP file path is correctly specified and exists; otherwise, the function will exit with an error.

---

*Generated by CodeWorm on 2026-02-27 17:59*
