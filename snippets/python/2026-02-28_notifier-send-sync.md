# Notifier.send_sync

**Type:** Documentation
**Repository:** Telehook
**File:** src/telehook/notifier.py
**Language:** python
**Lines:** 48-60
**Complexity:** 4.0

---

## Source Code

```python
def send_sync(self, content: str | Message) -> None:
        try:
            loop = asyncio.get_running_loop()
        except RuntimeError:
            loop = None

        if loop and loop.is_running():
            import concurrent.futures

            with concurrent.futures.ThreadPoolExecutor(max_workers = 1) as pool:
                pool.submit(asyncio.run, self.send(content)).result()
        else:
            asyncio.run(self.send(content))
```

---

## Documentation

### Documentation for `Notifier.send_sync`

**Purpose and Behavior:**
The `send_sync` method ensures that a message is sent synchronously, even if the event loop is already running. If the current thread does not have an active event loop, it directly runs the send operation. Otherwise, it uses a single-threaded executor to submit the task asynchronously.

**Key Implementation Details:**
- The function accepts `content` which can be either a string or a `Message` object.
- It checks if there is a running event loop using `asyncio.get_running_loop()`.
- If an active loop exists and it is running, it uses `ThreadPoolExecutor` to submit the task asynchronously. This ensures that the send operation does not block the current thread.
- Otherwise, it directly runs the `send` method using `asyncio.run`.

**When/Why to Use:**
Use this code when you need to ensure that a message is sent synchronously from a context where an event loop might already be running. This pattern helps in maintaining control over asynchronous operations without blocking the current thread.

**Patterns and Gotchas:**
- The use of `ThreadPoolExecutor` with only one worker ensures that the task runs asynchronously but does not consume multiple threads.
- Directly using `asyncio.run` inside a ThreadPoolExecutor can lead to unexpected behavior if not used carefully, as it starts a new event loop. Always ensure you understand the implications of starting an event loop within another context.

This approach is particularly useful in scenarios where you need to integrate synchronous and asynchronous code seamlessly.

---

*Generated by CodeWorm on 2026-02-28 19:49*
