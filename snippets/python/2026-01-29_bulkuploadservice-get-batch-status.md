# BulkUploadService.get_batch_status

**Repository:** vuemantics
**File:** backend/services/bulk_upload_service.py
**Language:** python
**Lines:** 240-277
**Complexity:** 6.0

---

## Source Code

```python
async def get_batch_status(
        batch_id: UUID,
        user_id: UUID,
    ) -> BatchStatusResult:
        """
        Get batch status for a user

        Args:
            batch_id: Batch UUID
            user_id: User UUID

        Returns:
            BatchStatusResult
        """
        batch = await UploadBatch.find_by_id(batch_id)

        if not batch:
            raise NotFoundError("Batch not found")

        if batch.user_id != user_id:
            raise NotFoundError("Batch not found")

        return BatchStatusResult(
            batch_id = batch.id,
            status = batch.status,
            total_uploads = batch.total_uploads,
            processed_uploads = batch.processed_uploads,
            successful_uploads = batch.successful_uploads,
            failed_uploads = batch.failed_uploads,
            progress_percentage = batch.get_progress_percentage(),
            created_at = batch.created_at.isoformat()
            if batch.created_at else None,
            started_at = batch.started_at.isoformat()
            if batch.started_at else None,
            completed_at = batch.completed_at.isoformat()
            if batch.completed_at else None,
            error_message = batch.error_message,
        )
```

---

## Documentation

### Documentation for `get_batch_status`

**Purpose and Behavior**
The `get_batch_status` function retrieves the status of a batch upload process associated with a specific user. It checks if the batch exists and belongs to the provided user, then returns detailed information about the batch's status.

**Key Implementation Details**
- **Asynchronous Function**: The function is marked as `async`, indicating it performs asynchronous operations.
- **Type Hints**: Parameters are annotated with `UUID` for type safety. The return type is `BatchStatusResult`.
- **Error Handling**: It raises a `NotFoundError` if the batch does not exist or if the batch does not belong to the specified user.
- **Data Retrieval and Formatting**: The function fetches relevant data from the `UploadBatch` model, formats it into a `BatchStatusResult`, and returns this structured result.

**When/Why to Use This Code**
Use this function when you need to check the status of a batch upload for a specific user. It ensures that only authorized users can access batch information, enhancing security. The function is particularly useful in scenarios where real-time updates or batch processing statuses are required.

**Patterns and Gotchas**
- **Asynchronous Operations**: Ensure your application supports asynchronous operations.
- **Error Handling**: Always handle potential `NotFoundError` exceptions to avoid runtime errors.
- **UUID Validation**: Verify that the input UUIDs are valid before passing them to this function.

---

*Generated by CodeWorm on 2026-01-29 13:20*
