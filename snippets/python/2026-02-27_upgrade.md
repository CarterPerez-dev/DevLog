# upgrade

**Type:** Documentation
**Repository:** my-portfolio
**File:** v1/backend/alembic/versions/20260103_054418_portfolio.py
**Language:** python
**Lines:** 19-160
**Complexity:** 1.0

---

## Source Code

```python
def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    language_enum = postgresql.ENUM('unknown', 'en', 'zh', 'hi', 'es', 'fr', 'ar', 'pt', name='language', create_type=False)
    language_enum.create(op.get_bind(), checkfirst=True)

    op.create_table('blogs',
    sa.Column('language', postgresql.ENUM('unknown', 'en', 'zh', 'hi', 'es', 'fr', 'ar', 'pt', name='language', create_type=False), nullable=False),
    sa.Column('title', sa.String(length=300), nullable=False),
    sa.Column('description', sa.String(length=1000), nullable=False),
    sa.Column('external_url', sa.String(length=2048), nullable=False),
    sa.Column('category', postgresql.ENUM('unknown', 'tutorial', 'deep_dive', 'career', 'project', 'opinion', name='blogcategory', create_type=True), nullable=True),
    sa.Column('tags', postgresql.ARRAY(sa.String(length=50)), nullable=True),
    sa.Column('thumbnail_url', sa.String(length=2048), nullable=True),
    sa.Column('published_date', sa.Date(), nullable=True),
    sa.Column('read_time_minutes', sa.Integer(), nullable=True),
    sa.Column('views_count', sa.Integer(), nullable=True),
    sa.Column('display_order', sa.Integer(), nullable=False),
    sa.Column('is_visible', sa.Boolean(), nullable=False),
    sa.Column('is_featured', sa.Boolean(), nullable=False),
    sa.Column('id', sa.Uuid(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id', name=op.f('pk_blogs'))
    )
    op.create_table('certifications',
    sa.Column('language', postgresql.ENUM('unknown', 'en', 'zh', 'hi', 'es', 'fr', 'ar', 'pt', name='language', create_type=False), nullable=False),
    sa.Column('name', sa.String(length=200), nullable=False),
    sa.Column('issuer', sa.String(length=200), nullable=False),
    sa.Column('issuer_url', sa.String(length=2048), nullable=True),
    sa.Column('issuer_logo_url', sa.String(length=2048), nullable=True),
    sa.Column('credential_id', sa.String(length=100), nullable=True),
    sa.Column('verification_url', sa.String(length=2048), nullable=True),
    sa.Column('date_obtained', sa.Date(), nullable=False),
    sa.Column('expiry_date', sa.Date(), nullable=True),
    sa.Column('is_expired', sa.Boolean(), nullable=False),
    sa.Column('badge_image_url', sa.String(length=2048), nullable=True),
    sa.Column('category', postgresql.ENUM('unknown', 'security', 'cloud', 'programming', 'networking', 'database', 'devops', name='certificationcategory', create_type=True), nullable=True),
    sa.Column('display_order', sa.Integer(), nullable=False),
    sa.Column('is_visible', sa.Boolean(), nullable=False),
    sa.Column('id', sa.Uuid(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=Tru
```

---

## Documentation

### Documentation for `upgrade()` Function

#### Purpose and Behavior
The `upgrade()` function is part of an Alembic migration script used in a database schema management process. It creates several tables: `blogs`, `certifications`, and `experiences`. Each table has columns with specific data types, constraints, and relationships defined to store various pieces of user or project information.

#### Key Implementation Details
- **Language Enumerations**: The function defines multiple enumerations (`language`, `blogcategory`, `certificationcategory`, `employmenttype`) using PostgreSQL's ENUM type. These are used as column data types in the tables.
- **Table Creation**: Each table is created with columns representing different attributes such as text, date, and boolean fields. For example, `blogs` has columns for title, description, external URL, tags, and more.
- **Constraints and Indexes**: Primary keys (`pk_blogs`, `pk_certifications`, `pk_experiences`) are defined to ensure data integrity.

#### When/Why to Use This Code
This code should be used during the initial setup or when upgrading an existing database schema. It ensures that all necessary tables and their associated columns are created, allowing for structured storage of blog posts, certifications, and work experiences in a PostgreSQL database.

#### Patterns and Gotchas
- **Enum Type Management**: The `create_type=False` parameter is used to avoid creating the enum type multiple times, which could lead to errors if not managed carefully.
- **Column Lengths**: Ensure that column lengths (e.g., `title`, `description`) are appropriate for your use case. Incorrect lengths can lead to data truncation issues.

This function is crucial for setting up a database schema that supports the application's core functionalities, ensuring that all necessary data can be stored and queried efficiently.

---

*Generated by CodeWorm on 2026-02-27 20:02*
