# WiseAdapter.validate_recipient

**Repository:** stripe-referral
**File:** src/stripe_referral/adapters/wise.py
**Language:** python
**Lines:** 176-229
**Complexity:** 12.0

---

## Source Code

```python
def validate_recipient(
        self,
        recipient_data: dict[str,
                             Any]
    ) -> RecipientValidation:
        """
        Validate Wise recipient data
        """
        required_fields = ["account_holder_name", "details"]

        missing_fields = [
            field for field in required_fields
            if field not in recipient_data
        ]

        if missing_fields:
            return RecipientValidation(
                valid = False,
                error =
                f"Missing required fields: {', '.join(missing_fields)}",
            )

        account_holder_name = recipient_data.get(
            "account_holder_name",
            ""
        )
        if not account_holder_name or len(account_holder_name) < 2:
            return RecipientValidation(
                valid = False,
                error = "Invalid account holder name",
            )

        details = recipient_data.get("details", {})
        if not isinstance(details, dict):
            return RecipientValidation(
                valid = False,
                error = "Details must be a dictionary",
            )

        account_type = recipient_data.get("account_type", "aba")
        if account_type == "aba":
            if "accountNumber" not in details or "routingNumber" not in details:
                return RecipientValidation(
                    valid = False,
                    error =
                    "Missing accountNumber or routingNumber for ABA transfer",
                )
        elif account_type == "iban" and "iban" not in details:
            return RecipientValidation(
                valid = False,
                error = "Missing IBAN for IBAN transfer",
            )

        return RecipientValidation(valid = True)
```

---

## Documentation

### Documentation for `validate_recipient`

**Purpose and Behavior:**
The `validate_recipient` method in the `WiseAdapter` class validates recipient data for a Wise transfer, ensuring all required fields are present and correctly formatted.

**Key Implementation Details:**
- **Input:** A dictionary containing potential recipient details.
- **Output:** An instance of `RecipientValidation`, indicating whether validation passed or failed with an error message if applicable.
- **Steps:**
  - Checks for missing required fields (`account_holder_name` and `details`).
  - Validates the `account_holder_name` length.
  - Ensures `details` is a dictionary.
  - Verifies specific requirements based on `account_type` (ABA or IBAN).

**When/Why to Use:**
Use this method whenever you need to validate recipient data before initiating a transfer. It ensures that all necessary information is present and correctly formatted, preventing errors downstream.

**Patterns and Gotchas:**
- The function uses list comprehensions for concise missing field detection.
- Type hints are used effectively but could be enhanced with more specific types.
- Conditional validation based on `account_type` might need updates if new account types are added.

---

*Generated by CodeWorm on 2026-01-26 05:31*
