# print_whois_result

**Repository:** Cybersecurity-Projects
**File:** PROJECTS/dns-lookup/dnslookup/whois_lookup.py
**Language:** python
**Lines:** 129-189
**Complexity:** 12.0

---

## Source Code

```python
def print_whois_result(result: WhoisResult) -> None:
    """
    Display WHOIS result in a nice table
    """
    console.print()
    console.print(
        f":clipboard: [bold cyan]WHOIS:[/bold cyan] [bold white]{result.domain}[/bold white]"
    )
    console.rule(style = "blue")

    if result.error:
        console.print(f"[red]:x:[/red] {result.error}")
        console.print()
        return

    table = Table(
        box = box.ROUNDED,
        border_style = "blue",
        show_header = False,
        padding = (0,
                   1),
    )

    table.add_column("Field", style = "cyan", width = 15)
    table.add_column("Value", style = "green")

    if result.registrar:
        table.add_row("Registrar", result.registrar)

    if result.registrant:
        table.add_row("Registrant", result.registrant)

    if result.registrant_country:
        table.add_row("Country", result.registrant_country)

    table.add_row("Created", format_date(result.creation_date))
    table.add_row("Expires", format_date(result.expiration_date))
    table.add_row("Updated", format_date(result.updated_date))

    if result.status:
        status_display = result.status[0] if len(
            result.status
        ) == 1 else f"{len(result.status)} statuses"
        table.add_row("Status", status_display)

    if result.name_servers:
        for i, ns in enumerate(result.name_servers[: 4]):
            label = "Name Servers" if i == 0 else ""
            table.add_row(label, ns)

        if len(result.name_servers) > 4:
            table.add_row(
                "",
                f"[dim]... and {len(result.name_servers) - 4} more[/dim]"
            )

    if result.dnssec:
        table.add_row("DNSSEC", result.dnssec)

    console.print(table)
    console.print()
```

---

## Documentation

### Documentation for `print_whois_result`

**Purpose and Behavior:**
The function `print_whois_result` displays a WHOIS lookup result in a formatted table using the Rich library's console module. It handles errors, formats dates, and organizes data into columns for readability.

**Key Implementation Details:**
- The function accepts a single parameter `result`, which is expected to be an instance of `WhoisResult`.
- It uses conditional statements to add rows to the table based on available data.
- The table is styled with colors and rounded borders for better visual presentation.
- If there are more than four name servers, only the first four are displayed, followed by a summary.

**When/Why to Use:**
Use this function when you need to present WHOIS lookup results in a structured and visually appealing format. Itâ€™s particularly useful for command-line interfaces or logs where detailed information needs to be presented clearly.

**Patterns and Gotchas:**
- The use of conditional statements (`if result.error`, `if result.registrar`) ensures that only relevant data is displayed, making the output cleaner.
- The handling of name servers with a summary when more than four are present prevents cluttering the display while still providing full information if needed.

This function adheres to Pythonic practices by using type hints and leveraging Rich for styled console output.

---

*Generated by CodeWorm on 2026-01-17 12:11*
