# _score_hex

**Type:** Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 127-171
**Complexity:** 16.0

---

## Source Code

```python
def _score_hex(data: str) -> float:
    stripped = data.strip()
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0

    hex_only = stripped
    for sep in HEX_SEPARATORS:
        hex_only = hex_only.replace(sep, "")

    if not hex_only:
        return 0.0
    if not all(c in HEX_CHARSET for c in hex_only):
        return 0.0
    if len(hex_only) % 2 != 0:
        return 0.0

    score = W.HEX_BASE

    has_separators = any(sep in stripped for sep in HEX_SEPARATORS)
    if has_separators:
        score += W.HEX_SEPARATOR_PRESENT

    has_alpha = any(c in "abcdefABCDEF" for c in hex_only)
    if has_alpha:
        score += W.HEX_ALPHA_CHARS
    else:
        score -= W.HEX_NO_ALPHA_PENALTY

    is_consistent_case = (
        hex_only == hex_only.lower() or hex_only == hex_only.upper()
    )
    if is_consistent_case:
        score += W.HEX_CONSISTENT_CASE

    if len(hex_only) >= 8:
        score += W.LONGER_INPUT

    decoded = try_decode(stripped, EncodingFormat.HEX)
    if decoded is None:
        return 0.0
    score += W.HEX_DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Documentation

### Documentation for `_score_hex` Function

**Purpose and Behavior:**
The `_score_hex` function evaluates the quality of a hexadecimal string input based on various criteria such as length, character set validity, presence of separators, case consistency, and successful decoding to printable text. It returns a score between 0.0 and 1.0.

**Key Implementation Details:**
- **Input Validation:** Strips leading/trailing whitespace, checks for minimum length, ensures only valid hexadecimal characters are present, and validates even length.
- **Score Calculation:** Incrementally builds a score based on conditions like separator presence, alphanumeric characters, consistent case, and successful decoding to printable text. Penalizes the absence of alphabetic characters.
- **Decoding:** Attempts to decode the input as hex before returning its score.

**When/Why to Use:**
Use this function in scenarios where you need to assess the validity and quality of hexadecimal data inputs. It is particularly useful for validating user inputs or filtering potential valid hex strings from a dataset.

**Patterns and Gotchas:**
- The function uses multiple conditions to incrementally build a score, which can be seen as a pattern for scoring systems.
- Be cautious with the `try_decode` function; ensure it handles errors gracefully. Missing or incorrect implementations here could lead to unexpected behavior.
- The scoring logic is sensitive to edge cases like separators and case consistency, so test thoroughly to cover all scenarios.

---

*Generated by CodeWorm on 2026-02-18 07:11*
