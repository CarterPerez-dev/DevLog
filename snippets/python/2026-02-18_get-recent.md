# get_recent

**Type:** Documentation
**Repository:** CodeWorm
**File:** dashboard/backend/api.py
**Language:** python
**Lines:** 149-197
**Complexity:** 8.0

---

## Source Code

```python
async def get_recent(
    limit: int = Query(default=50, ge=1, le=200),
    offset: int = Query(default=0, ge=0),
    repo: str | None = Query(default=None),
    doc_type: str | None = Query(default=None),
) -> list[RecentDoc]:
    db = _get_db_path()
    if not db.exists():
        return []

    query = "SELECT * FROM documented_snippets"
    params: list = []
    conditions: list[str] = []
    has_doc_type = False

    with _get_conn() as check_conn:
        has_doc_type = _has_column(check_conn, "documented_snippets", "doc_type")

    if repo:
        conditions.append("source_repo = ?")
        params.append(repo)
    if doc_type and has_doc_type:
        conditions.append("doc_type = ?")
        params.append(doc_type)

    if conditions:
        query += " WHERE " + " AND ".join(conditions)

    query += " ORDER BY documented_at DESC LIMIT ? OFFSET ?"
    params.extend([limit, offset])

    with _get_conn() as conn:
        rows = conn.execute(query, params).fetchall()

    results = []
    for row in rows:
        results.append(RecentDoc(
            id=row["id"],
            source_repo=row["source_repo"],
            source_file=row["source_file"],
            function_name=row["function_name"],
            class_name=row["class_name"],
            doc_type=row["doc_type"] if "doc_type" in row.keys() else "function_doc",
            documented_at=row["documented_at"],
            snippet_path=row["snippet_path"],
            git_commit=row["git_commit"],
        ))

    return results
```

---

## Documentation

### Documentation for `get_recent` Function

**Purpose and Behavior:**
The `get_recent` function retrieves a list of recent documented snippets from a database, optionally filtered by repository and document type. It returns up to 50 records sorted by the date they were documented in descending order.

**Key Implementation Details:**
- **Query Construction:** The SQL query is dynamically built based on provided filters (`repo`, `doc_type`), ensuring flexibility.
- **Database Interaction:** Uses context managers for safe database connection handling, and executes a parameterized query to prevent SQL injection.
- **Type Hints:** Utilizes Pydantic models (e.g., `RecentDoc`) for structured data handling.

**When/Why to Use:**
Use this function when you need to fetch recent documented code snippets from the CodeWorm repository. It is particularly useful in scenarios requiring real-time updates or filtering based on specific criteria like document type and source repository.

**Patterns/Gotchas:**
- **Dynamic Query Construction:** Be cautious with dynamic query building to avoid SQL injection.
- **Type Checking:** The function checks for the existence of columns before querying, which prevents potential errors if the database schema changes.

---

*Generated by CodeWorm on 2026-02-18 09:49*
