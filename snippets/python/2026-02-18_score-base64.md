# _score_base64

**Type:** Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 32-68
**Complexity:** 18.0

---

## Source Code

```python
def _score_base64(data: str) -> float:
    stripped = "".join(data.split())
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0
    if not all(c in BASE64_CHARSET for c in stripped):
        return 0.0
    if len(stripped) % 4 != 0:
        return 0.0

    score = W.B64_BASE
    content = stripped.rstrip("=")

    padding = len(stripped) - len(content)
    if padding <= 2:
        score += W.B64_VALID_PADDING

    if any(c in stripped for c in "+/"):
        score += W.B64_SPECIAL_CHARS

    has_upper = any(c.isupper() for c in content)
    has_lower = any(c.islower() for c in content)
    if has_upper and has_lower:
        score += W.B64_MIXED_CASE
    elif not has_upper and not any(c in stripped for c in "+/="):
        score -= W.B64_NO_SIGNAL_PENALTY

    if len(stripped) >= 8:
        score += W.LONGER_INPUT

    decoded = try_decode(stripped, EncodingFormat.BASE64)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Documentation

### Documentation for `_score_base64` Function

**Purpose and Behavior:**
The function `_score_base64` evaluates the validity and quality of a given Base64 string `data`. It returns a score between 0.0 and 1.0, where higher scores indicate better quality or more valid Base64 data.

**Key Implementation Details:**
- **Input Validation:** Strips whitespace, checks length, character set, and padding.
- **Score Calculation:** Incrementally builds a score based on various criteria such as presence of special characters, case mix, decoding success, and printable text.
- **Decoding Attempt:** Uses `try_decode` to attempt Base64 decoding. If successful, additional points are awarded.

**When/Why to Use:**
This function is useful in scenarios where you need to assess the quality or validity of Base64 encoded data before processing it further. It can be employed in validation routines, security checks, or as part of a larger system that requires reliable Base64 strings.

**Patterns and Gotchas:**
- **Static Imports:** The constants `W.B64_BASE`, `W.B64_VALID_PADDING`, etc., are assumed to be defined elsewhere.
- **Decoding Failure:** If decoding fails, the function returns 0.0 immediately without further evaluation.
- **Case Sensitivity:** The presence of mixed case in the content can positively impact the score, but all-caps strings with no special characters might also get a penalty.

This function embodies a practical approach to quality assessment by combining multiple validation checks into a single scoring mechanism.

---

*Generated by CodeWorm on 2026-02-18 08:48*
