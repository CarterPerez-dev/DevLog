# meets_achievement_criteria

**Repository:** CertGames-Core
**File:** backend/api/domains/progression/services/achieve_engine.py
**Language:** python
**Lines:** 12-61
**Complexity:** 20.0

---

## Source Code

```python
def meets_achievement_criteria(
    criteria: dict[str,
                   Any],
    user: User,
    user_counters: dict[str,
                        Any]
) -> bool:
    """
    Check if user meets the achievement criteria for unlock eligibility.
    """
    if not criteria:
        return False

    if "level" in criteria and (user.level or 1) < criteria["level"]:
        return False

    if "coins" in criteria and (user.coins or 0) < criteria["coins"]:
        return False

    if "testCount" in criteria:
        current_tests = user_counters.get("total_tests_completed", 0)
        if current_tests < criteria["testCount"]:
            return False

    if "perfectTests" in criteria:
        current_perfect = user_counters.get("perfect_tests_count", 0)
        if current_perfect < criteria["perfectTests"]:
            return False

    if "totalQuestions" in criteria:
        current_questions = user_counters.get(
            "total_questions_answered",
            0
        )
        if current_questions < criteria["totalQuestions"]:
            return False

    if "minScore" in criteria:
        highest_score = user_counters.get("highest_score_ever", 0)
        if highest_score < criteria["minScore"]:
            return False

    if "minScoreBefore" in criteria and "minScoreAfter" in criteria:
        lowest_score = user_counters.get("lowest_score_ever", 100)
        highest_score = user_counters.get("highest_score_ever", 0)
        if not (lowest_score <= criteria["minScoreBefore"]
                and highest_score >= criteria["minScoreAfter"]):
            return False

    return True
```

---

## Documentation

### Documentation for `meets_achievement_criteria`

**Purpose and Behavior:**
This function checks if a user meets the specified criteria to unlock an achievement. It evaluates various conditions such as user level, coins, test counts, perfect tests, total questions answered, and scores.

**Key Implementation Details:**
- The function takes three parameters: `criteria` (dict), `user` (User object), and `user_counters` (dict).
- It iterates through the criteria to check if each condition is met. If any condition fails, it returns `False`.
- Default values are provided for missing keys in user attributes.
- The function uses nested conditions to evaluate multiple criteria.

**When/Why to Use:**
Use this code when you need to determine if a user has achieved specific milestones or thresholds required for unlocking achievements. It is particularly useful in game development where various levels of progression and performance metrics are tracked.

**Patterns/Gotchas:**
- The function employs early return patterns, making the logic clear and concise.
- Default values like `1` and `0` are used to handle missing keys gracefully.
- Ensure that all criteria keys exist in both `criteria` and `user_counters` dictionaries to avoid runtime errors.

---

*Generated by CodeWorm on 2026-01-19 17:49*
