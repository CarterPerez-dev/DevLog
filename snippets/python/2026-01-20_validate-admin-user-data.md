# validate_admin_user_data

**Repository:** CertGames-Core
**File:** backend/api/admin/qa/helpers.py
**Language:** python
**Lines:** 122-170
**Complexity:** 26.0

---

## Source Code

```python
def validate_admin_user_data(admin_user_data: dict) -> list[str]:
    """
    Validate admin user data and return list of validation errors
    """
    errors = []

    required_fields = ['email', 'role']
    for field in required_fields:
        if field not in admin_user_data:
            errors.append(f"Missing required field: {field}")

    if 'email' in admin_user_data:
        email = admin_user_data['email']
        if not email or '@' not in email:
            errors.append("Invalid email format")

    if 'role' in admin_user_data:
        role = admin_user_data['role']
        if isinstance(role, str):
            valid_roles = [r.value for r in AdminRole]
            if role not in valid_roles:
                errors.append(f"Invalid role: {role}")
        elif not isinstance(role, AdminRole):
            errors.append("Role must be AdminRole enum or valid string")

    if 'password' in admin_user_data and admin_user_data['password']:
        password = admin_user_data['password']
        if len(password) < 8:
            errors.append("Password must be at least 8 characters")
        if not any(c.isupper() for c in password):
            errors.append("Password must contain uppercase letter")
        if not any(c.islower() for c in password):
            errors.append("Password must contain lowercase letter")
        if not any(c.isdigit() for c in password):
            errors.append("Password must contain digit")
        if not any(c in '!@#$%^&*()_+-=' for c in password):
            errors.append("Password must contain special character")

    oauth_provider = admin_user_data.get('oauth_provider')
    if oauth_provider:
        valid_providers = ['google', 'github', 'apple']
        if oauth_provider not in valid_providers:
            errors.append(f"Invalid OAuth provider: {oauth_provider}")

        if 'oauth_id' not in admin_user_data or not admin_user_data[
                'oauth_id']:
            errors.append("oauth_id required when oauth_provider is set")

    return errors
```

---

## Documentation

### Documentation for `validate_admin_user_data`

**Purpose and Behavior:**
The function `validate_admin_user_data` checks a dictionary containing admin user data against predefined validation rules. It returns a list of error messages if any fields fail validation.

**Key Implementation Details:**
- The function takes a single parameter, `admin_user_data`, which is expected to be a dictionary.
- It validates the presence and format of required fields (`email` and `role`).
- Password complexity checks are performed, including length and character type requirements.
- OAuth provider validation ensures valid providers and requires an `oauth_id`.

**When/Why to Use:**
Use this function whenever you need to validate admin user data before processing or storing it. It helps ensure that only properly formatted and complete data is accepted, reducing potential errors in the system.

**Patterns/Gotchas:**
- The use of a list to accumulate validation errors makes it easy to return all issues at once.
- The `AdminRole` enum is assumed to be defined elsewhere; make sure it's imported or defined correctly.
- The function checks for both string and enum types for roles, which can help enforce proper data integrity.

This function is particularly useful in backend API validation logic where robust input checking is crucial.

---

*Generated by CodeWorm on 2026-01-20 01:54*
