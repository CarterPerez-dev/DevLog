# Repository.calculate_activity_score

**Repository:** kill-pr0cess.inc
**File:** backend/src/models/github.rs
**Language:** rust
**Lines:** 213-264
**Complexity:** 12.0

---

## Source Code

```rust
pub fn calculate_activity_score(&self) -> f64 {
        let mut score = 0.0;

        // Stars contribute to score (logarithmic scale to prevent skewing)
        if self.stargazers_count > 0 {
            score += (self.stargazers_count as f64).ln() * 10.0;
        }

        // Recent activity bonus
        if let Some(pushed_at) = self.pushed_at {
            let days_since_push = (Utc::now() - pushed_at).num_days();
            if days_since_push < 30 {
                score += 20.0;
            } else if days_since_push < 90 {
                score += 10.0;
            }
        }

        // Fork ratio (indicates usefulness)
        if self.stargazers_count > 0 {
            let fork_ratio = self.forks_count as f64 / self.stargazers_count as f64;
            score += fork_ratio * 15.0;
        }

        // Issue management (lower open issues ratio is better)
        if self.open_issues_count > 0 {
            score -= (self.open_issues_count as f64).ln() * 2.0;
        }

        // Documentation (has description and topics)
        if self.description.is_some() {
            score += 5.0;
        }
        if let Some(topics) = &self.topics {
            if !topics.is_empty() {
                score += topics.len() as f64 * 2.0;
            }
        }

        // License indicates maturity
        if self.license_name.is_some() {
            score += 5.0;
        }

        // Penalize archived repositories
        if self.is_archived {
            score *= 0.5;
        }

        // Normalize to 0-100 scale
        score.max(0.0).min(100.0)
    }
```

---

## Documentation

### Documentation for `calculate_activity_score`

**Purpose and Behavior:**
The function `calculate_activity_score` computes a score representing the activity level of a GitHub repository based on various metrics such as stargazers, recent pushes, fork ratio, issue management, documentation presence, license, and archiving status. The score is normalized to a 0-100 scale.

**Key Implementation Details:**
- **Stars Contribution:** Uses logarithmic scaling for stargazers count to prevent skewing.
- **Recent Activity Bonus:** Adds points based on the recency of pushes (up to 30 days).
- **Fork Ratio:** Higher ratio indicates more usefulness, contributing positively to the score.
- **Issue Management:** Penalizes repositories with many open issues using logarithmic scaling.
- **Documentation and License:** Positive contributions for having a description and license name.
- **Normalization:** Ensures the final score is within 0-100.

**When/Why to Use:**
This function should be used in scenarios where you need to rank or filter repositories based on their activity level. It's particularly useful for GitHub repository analysis, prioritizing active projects, and identifying potentially valuable contributions.

**Patterns/Gotchas:**
- **Borrowing and Option Handling:** The code effectively uses `Option` types to handle optional fields like `pushed_at`, `description`, and `topics`. This ensures safe handling of missing data.
- **Normalization:** The final score is capped at 100, preventing scores from going into negative territory or becoming too high due to outlier metrics.

---

*Generated by CodeWorm on 2026-01-24 02:47*
