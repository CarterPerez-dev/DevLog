# GitHubService.get_repository_readme

**Repository:** kill-pr0cess.inc
**File:** backend/src/services/github_service.rs
**Language:** rust
**Lines:** 263-306
**Complexity:** 9.0

---

## Source Code

```rust
async fn get_repository_readme(&self, owner: &str, name: &str) -> Result<String> {
    let readme_variants = vec!["README.md", "readme.md", "README", "readme", "README.txt"];

    for readme_file in readme_variants {
        self.check_rate_limit().await?;

        let url = format!(
            "{}/repos/{}/{}/contents/{}",
            self.base_url, owner, name, readme_file
        );
        let response_result = self.client.get(&url).send().await;

        match response_result {
            Ok(mut resp) => {
                self.update_rate_limit_from_headers(&resp).await;
                if resp.status().is_success() {
                    match resp.json::<serde_json::Value>().await {
                        Ok(content_response_val) => {
                            if let Some(content) = content_response_val.get("content")
                                .and_then(|c| c.as_str()) {
                                if let Ok(decoded) = base64::decode(&content.replace('\n', "")) {
                                    if let Ok(readme_text) = String::from_utf8(decoded) {
                                        debug!("Found README: {} for {}/{}", readme_file, owner, name);
                                        return Ok(readme_text);
                                    }
                                }
                            }
                        }
                        Err(e) => {
                            warn!("Failed to parse JSON for README {}: {}", readme_file, e);
                        }
                    }
                }
            }
            Err(e) => {
                warn!("Failed to send request for README {}: {}", readme_file, e);
                // Continue to next variant if sending request fails
            }
        }
    }

    debug!("No README found for {}/{}", owner, name);
    Ok(String::new())
}
```

---

## Documentation

### Documentation for `get_repository_readme`

**Purpose and Behavior:**
The function `get_repository_readme` in the `GitHubService` struct attempts to retrieve the README file from a GitHub repository by checking multiple potential filenames. It uses asynchronous requests to handle rate limits, parses JSON responses, decodes Base64 content, and handles errors gracefully.

**Key Implementation Details:**
- **Rate Limit Handling:** The function calls `check_rate_limit()` before each request to manage API usage.
- **Error Handling:** Uses `Result` extensively for error propagation. It logs warnings for failed requests or JSON parsing issues.
- **Multiple Filename Checks:** Iterates over a list of possible README filenames, returning the first successful match.

**When/Why to Use:**
This function is useful when you need to programmatically access the README file from any GitHub repository without knowing its exact filename. Itâ€™s particularly handy for automation scripts or tools that interact with multiple repositories.

**Patterns and Gotchas:**
- **Borrowing:** The `&str` references are used throughout, ensuring efficient memory usage.
- **Asynchronous I/O:** The use of `async/await` ensures non-blocking network operations.
- **Error Propagation:** The function returns a `Result<String>` to handle both successful and failed outcomes gracefully. Note that it continues searching even if one request fails, which might not be ideal in all scenarios.

This approach is flexible but could lead to unnecessary requests if the first filename in the list always exists.

---

*Generated by CodeWorm on 2026-01-24 22:34*
