# routes

**Type:** File Overview
**Repository:** social-media-notes
**File:** backend/app/video/routes.py
**Language:** python
**Lines:** 1-143
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025
routes.py
"""

from uuid import UUID

from fastapi import (
    APIRouter,
    Query,
    status,
)

from config import Platform
from core.dependencies import CurrentUser
from core.responses import (
    AUTH_401,
    NOT_FOUND_404,
)
from .schemas import (
    CopyToTargetRequest,
    VideoEntryCreate,
    VideoEntryListResponse,
    VideoEntryResponse,
    VideoEntryUpdate,
)
from .dependencies import VideoServiceDep


router = APIRouter(prefix="/videos", tags=["videos"])


@router.post(
    "",
    response_model=VideoEntryResponse,
    status_code=status.HTTP_201_CREATED,
    responses={**AUTH_401},
)
async def create_video_entry(
    video_service: VideoServiceDep,
    current_user: CurrentUser,
    data: VideoEntryCreate,
) -> VideoEntryResponse:
    """
    Create a new video entry
    """
    return await video_service.create_entry(current_user.id, data)


@router.get(
    "",
    response_model=VideoEntryListResponse,
    responses={**AUTH_401},
)
async def list_video_entries(
    video_service: VideoServiceDep,
    current_user: CurrentUser,
    platform: Platform | None = Query(default=None),
    page: int = Query(default=1, ge=1),
    size: int = Query(default=20, ge=1, le=100),
) -> VideoEntryListResponse:
    """
    List video entries with optional platform filter
    """
    return await video_service.list_entries(
        current_user.id,
        platform=platform,
        page=page,
        size=size,
    )


@router.get(
    "/{entry_id}",
    response_model=VideoEntryResponse,
    responses={**AUTH_401, **NOT_FOUND_404},
)
async def get_video_entry(
    video_service: VideoServiceDep,
    current_user: CurrentUser,
    entry_id: UUID,
) -> VideoEntryResponse:
    """
    Get a video entry by ID
    """
    return await video_service.get_entry(entry_id, current_user.id)


@router.patch(
    "/{entry_id}",
    response_model=VideoEntryResponse,
    responses={**AUTH_401, **NOT_FOUND_404},
)
async def update_video_entry(
    video_service: VideoServiceDep,
    current_user: CurrentUser,
    entry_id: UUID,
    data: VideoEntryUpdate,
) -> VideoEntryResponse:
    """
    Update a video entry
    """
    return await video_service.update_entry(entry_id, current_user.id, data)


@router.delete(
    "/{entry_id}",
    status_code=status.HTTP_204_NO_CONTENT,
    responses={**AUTH_401, **NOT_FOUND_404},
)
async def delete_video_entry(
    video_service: VideoServiceDep,
    current_user: CurrentUser,
    entry_id: UUID,
) -> None:
    """
    Delete a video entry
    """
    await video_service.delete_entry(entry_id, current_user.id)


@router.post(
    "/{entry_id}/copy",
    response_model=VideoEntryResponse,
    status_code=status.HTTP_201_CREATED,
    responses={**AUTH_401, **NOT_FOUND_404},
)
async def copy_video_entry(
    video_service: VideoServiceDep,
    current_user: CurrentUser,
    entry_id: UUID,
    data: CopyToTargetRequest,
) -> VideoEntryResponse:
    """
    Copy a video entry to another platfor
```

---

## File Overview

### Purpose and Responsibility

This `routes.py` file defines the API endpoints for managing video entries within a social media application. It handles CRUD operations (Create, Read, Update, Delete) as well as copying videos to different platforms.

### Key Exports and Public Interface

- **Endpoints**:
  - `POST /videos`: Create a new video entry.
  - `GET /videos`: List video entries with optional platform filter.
  - `GET /videos/{entry_id}`: Retrieve a specific video entry by ID.
  - `PATCH /videos/{entry_id}`: Update an existing video entry.
  - `DELETE /videos/{entry_id}`: Delete a video entry.
  - `POST /videos/{entry_id}/copy`: Copy a video entry to another platform.

- **Dependencies**:
  - `VideoServiceDep`: Dependency for the video service.
  - `CurrentUser`: Current user context.
  - `Platform`: Enum for different platforms (e.g., Instagram, TikTok).

### How It Fits in the Project

This file is part of the backend API layer, specifically handling video-related operations. It integrates with the `VideoService` to perform database interactions and business logic. The endpoints are secured using `CurrentUser`, ensuring that only authenticated users can access or modify their own entries.

### Notable Design Decisions

- **Dependency Injection**: Utilizes dependency injection for `VideoServiceDep` and `CurrentUser` to maintain clean, testable code.
- **Response Models**: Uses Pydantic models (`VideoEntryCreate`, `VideoEntryUpdate`) for data validation and consistent response formats.
- **Error Handling**: Consistently handles errors by returning appropriate HTTP status codes and responses (e.g., `AUTH_401`, `NOT_FOUND_404`).

---

*Generated by CodeWorm on 2026-02-20 22:05*
