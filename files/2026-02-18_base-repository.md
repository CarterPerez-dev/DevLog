# base_repository

**Type:** File Overview
**Repository:** Cybersecurity-Projects
**File:** TEMPLATES/fullstack-template/backend/app/core/base_repository.py
**Language:** python
**Lines:** 1-107
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025
base_repository.py
"""

from collections.abc import Sequence
from typing import (
    Any,
    Generic,
    TypeVar,
)
from uuid import UUID

from sqlalchemy import func, select
from sqlalchemy.ext.asyncio import AsyncSession

from .Base import Base


ModelT = TypeVar("ModelT", bound = Base)


class BaseRepository(Generic[ModelT]):
    """
    Generic repository with common CRUD operations
    """
    model: type[ModelT]

    @classmethod
    async def get_by_id(
        cls,
        session: AsyncSession,
        id: UUID,
    ) -> ModelT | None:
        """
        Get a single record by ID
        """
        return await session.get(cls.model, id)

    @classmethod
    async def get_multi(
        cls,
        session: AsyncSession,
        skip: int = 0,
        limit: int = 100,
    ) -> Sequence[ModelT]:
        """
        Get multiple records with pagination
        """
        result = await session.execute(
            select(cls.model).offset(skip).limit(limit)
        )
        return result.scalars().all()

    @classmethod
    async def count(cls, session: AsyncSession) -> int:
        """
        Count total records
        """
        result = await session.execute(
            select(func.count()).select_from(cls.model)
        )
        return result.scalar_one()

    @classmethod
    async def create(
        cls,
        session: AsyncSession,
        **kwargs: Any,
    ) -> ModelT:
        """
        Create a new record
        """
        instance = cls.model(**kwargs)
        session.add(instance)
        await session.flush()
        await session.refresh(instance)
        return instance

    @classmethod
    async def update(
        cls,
        session: AsyncSession,
        instance: ModelT,
        **kwargs: Any,
    ) -> ModelT:
        """
        Update an existing record
        """
        for key, value in kwargs.items():
            setattr(instance, key, value)
        await session.flush()
        await session.refresh(instance)
        return instance

    @classmethod
    async def delete(
        cls,
        session: AsyncSession,
        instance: ModelT,
    ) -> None:
        """
        Delete a record
        """
        await session.delete(instance)
        await session.flush()

```

---

## File Overview

### base_repository.py

**Purpose**: This file defines a generic `BaseRepository` class responsible for implementing common CRUD (Create, Read, Update, Delete) operations using SQLAlchemy. It provides a reusable framework that can be extended to manage different database models.

**Key Exports and Public Interface**:
- **get_by_id(session: AsyncSession, id: UUID) -> ModelT | None**: Retrieves a single record by its ID.
- **get_multi(session: AsyncSession, skip: int = 0, limit: int = 100) -> Sequence[ModelT]**: Fetches multiple records with pagination support.
- **count(session: AsyncSession) -> int**: Returns the total number of records in the database table.
- **create(session: AsyncSession, **kwargs: Any) -> ModelT**: Creates a new record based on provided keyword arguments.
- **update(session: AsyncSession, instance: ModelT, **kwargs: Any) -> ModelT**: Updates an existing record with specified fields.
- **delete(session: AsyncSession, instance: ModelT)**: Deletes a given record from the database.

**How it Fits into the Project**: This repository pattern is designed to be inherited by specific model repositories. It abstracts common database operations, promoting code reuse and consistency across different parts of the application.

**Notable Design Decisions**:
- **Generics (TypeVar ModelT)**: The class uses generics to ensure type safety when working with various SQLAlchemy models.
- **Async Operations**: All methods are asynchronous, facilitating non-blocking I/O operations typical in web applications.
- **SQLAlchemy Integration**: Utilizes SQLAlchemy for database interactions, ensuring robust and efficient data handling.
```

This documentation provides an overview of the file's purpose, key exports, integration within the project, and notable design choices.

---

*Generated by CodeWorm on 2026-02-18 20:15*
