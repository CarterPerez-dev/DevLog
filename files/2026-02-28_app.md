# app

**Type:** File Overview
**Repository:** CodeWorm
**File:** dashboard/backend/app.py
**Language:** python
**Lines:** 1-62
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2026
dashboard/backend/app.py
"""
from __future__ import annotations

from collections.abc import AsyncIterator
from contextlib import asynccontextmanager
from pathlib import Path

from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse
from fastapi.staticfiles import StaticFiles

from dashboard.backend.api import router as api_router
from dashboard.backend.ws import (
    router as ws_router,
    start_redis_subscriber,
    stop_redis_subscriber,
)


@asynccontextmanager
async def lifespan(app: FastAPI) -> AsyncIterator[None]:
    await start_redis_subscriber()
    yield
    await stop_redis_subscriber()


app = FastAPI(
    title = "CodeWorm Dashboard",
    version = "1.0.2",
    lifespan = lifespan,
)

app.add_middleware(
    CORSMiddleware,
    allow_origins = ["*"],
    allow_credentials = True,
    allow_methods = ["*"],
    allow_headers = ["*"],
)

app.include_router(api_router, prefix = "")
app.include_router(ws_router, prefix = "")


@app.get("/health")
async def health() -> JSONResponse:
    return JSONResponse({"status": "healthy"})


static_dir = Path(__file__).parent.parent / "frontend" / "dist"
if static_dir.exists():
    app.mount(
        "/",
        StaticFiles(directory = str(static_dir),
                    html = True),
        name = "static"
    )

```

---

## File Overview

### Purpose and Responsibility

This file, `app.py`, serves as the entry point for the backend application of the CodeWorm Dashboard. It initializes a FastAPI instance, configures middleware, includes routers, and sets up static file serving.

### Key Exports and Public Interface

- **FastAPI App Instance**: The main `app` object is exported.
- **Lifespan Manager**: An async context manager for managing Redis subscriber lifecycle.
- **Health Check Endpoint**: A simple health check endpoint at `/health`.
- **Static File Serving**: Mounts the static files from the frontend build directory.

### How It Fits in the Project

This file acts as the central hub, integrating various components such as API routers and WebSocket handlers. It also handles middleware for CORS and serves static files, ensuring a seamless interaction between the backend and the React frontend.

### Notable Design Decisions

- **Async Context Manager**: Utilizes `@asynccontextmanager` to manage Redis connections efficiently.
- **CORS Middleware**: Configured permissive settings to allow cross-origin requests from any origin.
- **Static File Serving**: Dynamically checks for the existence of static files and mounts them if available, promoting a clean separation between backend logic and frontend assets.
```

This documentation provides an overview of the file's role in the project, its key components, and significant design choices.

---

*Generated by CodeWorm on 2026-02-28 21:37*
