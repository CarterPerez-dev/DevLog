# finding

**Type:** File Overview
**Repository:** docksec
**File:** internal/finding/finding.go
**Language:** go
**Lines:** 1-272
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
finding.go
*/

package finding

import (
	"crypto/sha256"
	"encoding/hex"
	"fmt"
	"strings"
	"time"
)

const (
	containerIDShortLength = 12
	imageIDShortLength     = 12
)

type Severity int

const (
	SeverityInfo Severity = iota
	SeverityLow
	SeverityMedium
	SeverityHigh
	SeverityCritical
)

var severityToString = map[Severity]string{
	SeverityInfo:     "INFO",
	SeverityLow:      "LOW",
	SeverityMedium:   "MEDIUM",
	SeverityHigh:     "HIGH",
	SeverityCritical: "CRITICAL",
}

var stringToSeverity = func() map[string]Severity {
	m := make(map[string]Severity, len(severityToString))
	for sev, str := range severityToString {
		m[str] = sev
	}
	return m
}()

var severityColors = map[Severity]string{
	SeverityInfo:     "\033[36m",
	SeverityLow:      "\033[34m",
	SeverityMedium:   "\033[33m",
	SeverityHigh:     "\033[31m",
	SeverityCritical: "\033[35m",
}

func (s Severity) String() string {
	if str, ok := severityToString[s]; ok {
		return str
	}
	return "UNKNOWN"
}

func (s Severity) Color() string {
	if color, ok := severityColors[s]; ok {
		return color
	}
	return "\033[0m"
}

func ParseSeverity(s string) (Severity, bool) {
	sev, ok := stringToSeverity[strings.ToUpper(strings.TrimSpace(s))]
	return sev, ok
}

type TargetType string

const (
	TargetContainer  TargetType = "container"
	TargetImage      TargetType = "image"
	TargetDockerfile TargetType = "dockerfile"
	TargetCompose    TargetType = "compose"
	TargetDaemon     TargetType = "daemon"
)

type Target struct {
	Type TargetType
	Name string
	ID   string
}

func (t Target) String() string {
	if t.ID != "" && len(t.ID) >= containerIDShortLength {
		return fmt.Sprintf(
			"%s:%s (%s)",
			t.Type,
			t.Name,
			t.ID[:containerIDShortLength],
		)
	}
	if t.ID != "" {
		return fmt.Sprintf("%s:%s (%s)", t.Type, t.Name, t.ID)
	}
	return fmt.Sprintf("%s:%s", t.Type, t.Name)
}

type Location struct {
	Path   string
	Line   int
	Column int
}

func (l Location) String() string {
	if l.Line > 0 {
		return fmt.Sprintf("%s:%d", l.Path, l.Line)
	}
	return l.Path
}

type CISControl struct {
	ID          string
	Section     string
	Title       string
	Description string
	Scored      bool
	Level       int
}

func (c CISControl) String() string {
	return fmt.Sprintf("CIS %s", c.ID)
}

type Finding struct {
	ID          string
	RuleID      string
	Title       string
	Description string
	Severity    Severity
	Category    string
	Target      Target
	Location    *Location
	Remediation string
	References  []string
	CISControl  *CISControl
	Timestamp   time.Time
}

func New(
	ruleID string,
	title string,
	severity Severity,
	target Target,
) *Finding {
	f := &Finding{
		RuleID:    ruleID,
		Title:     title,
		Severity:  severity,
		Target:    target,
		Timestamp: time.Now(),
	}
	f.ID = f.generateID()
	return f
}

func (f *Finding) generateID() string {
	data := fmt.Sprintf(
		"%s|%s|%s|%s",
		f.RuleID,
		f.Target.Type,
		f.Target.Name,
		f.Target.ID,
	)
	if f.Location != nil {
		data += fmt.Sprintf
```

---

## File Overview

### finding.go

**Purpose and Responsibility:**
This Go source file defines the `finding` package, which is responsible for modeling security findings within a Docker environment. It includes structures for `Severity`, `Target`, `Location`, `CISControl`, and `Finding`. The package provides methods to create, manipulate, and filter `Finding` objects.

**Key Exports and Public Interface:**
- **Structs:** `Severity`, `TargetType`, `Target`, `Location`, `CISControl`, `Finding`.
- **Functions:** `ParseSeverity`, `New`, `generateID`, various methods on the `Finding` struct for setting properties, and collection filtering methods.
- **Collections:** `Collection` type with aggregation and filtering methods.

**How It Fits in the Project:**
This package is a core component of the `docksec` project, providing a structured way to represent security findings. It integrates with other parts of the application that handle Docker containers, images, and configurations by offering detailed information about potential vulnerabilities or issues.

**Notable Design Decisions:**
- **Error Handling:** Primarily uses standard Go error handling mechanisms.
- **Color Coding:** Utilizes ANSI escape codes for severity colorization in terminal output.
- **Hashing:** Uses SHA256 hashing to generate unique IDs for findings, ensuring consistency and uniqueness across different environments.
- **Modularity:** The `Finding` struct is designed to be flexible, allowing for various properties like `Remediation`, `References`, and `CISControl`, making it adaptable to different security checks.

---

*Generated by CodeWorm on 2026-02-20 19:59*
