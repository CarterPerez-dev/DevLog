# protection

**Type:** File Overview
**Repository:** Yoshi-Audit
**File:** internal/docker/protection.go
**Language:** go
**Lines:** 1-59
**Complexity:** 0.0

---

## Source Code

```go
// Â©AngelaMos | 2026
// protection.go

package docker

import (
	"path/filepath"
	"strings"
)

type ProtectionEngine struct {
	patterns  []string
	protected map[string]bool
}

func NewProtectionEngine(patterns []string) *ProtectionEngine {
	return &ProtectionEngine{
		patterns:  patterns,
		protected: make(map[string]bool),
	}
}

func (pe *ProtectionEngine) IsProtected(name string) bool {
	if pe.protected[name] {
		return true
	}
	return pe.MatchesPattern(name)
}

func (pe *ProtectionEngine) Protect(name string) {
	pe.protected[name] = true
}

func (pe *ProtectionEngine) Unprotect(name string) {
	delete(pe.protected, name)
}

func (pe *ProtectionEngine) MatchesPattern(name string) bool {
	for _, pattern := range pe.patterns {
		if matchGlob(pattern, name) {
			return true
		}
	}
	return false
}

func matchGlob(pattern, name string) bool {
	if strings.HasPrefix(pattern, "*") && strings.HasSuffix(pattern, "*") && !strings.Contains(pattern[1:len(pattern)-1], "*") {
		inner := pattern[1 : len(pattern)-1]
		return strings.Contains(strings.ToLower(name), strings.ToLower(inner))
	}

	matched, err := filepath.Match(strings.ToLower(pattern), strings.ToLower(name))
	if err != nil {
		return false
	}
	return matched
}

```

---

## File Overview

# protection.go

## Purpose and Responsibility
This Go source file defines a `ProtectionEngine` struct responsible for managing protected filenames within Docker-related operations. It provides methods to check if a filename is protected, protect or unprotect files based on patterns, and match filenames against these patterns.

## Key Exports and Public Interface
- **NewProtectionEngine**: Initializes a new `ProtectionEngine` with specified patterns.
- **IsProtected(name string)**: Checks if a given file name is protected.
- **Protect(name string)**: Marks a file as protected.
- **Unprotect(name string)**: Removes protection from a file.
- **MatchesPattern(name string)**: Determines if a filename matches any of the defined patterns.

## How It Fits in the Project
This file is part of the `docker` package, which handles Docker-related functionalities within the larger `Yoshi-Audit` project. The `ProtectionEngine` ensures that certain files are protected during operations, enhancing security and compliance by restricting access to specific filenames based on predefined patterns.

## Notable Design Decisions
- **Error Handling**: While not explicitly shown in this file, error handling is a key consideration for the underlying functions like `filepath.Match`, which should be robustly managed.
- **Glob Matching**: The `matchGlob` function uses glob matching to determine if a filename matches a pattern. This approach allows flexible and dynamic protection rules.
- **Case Insensitivity**: Both patterns and filenames are converted to lowercase before comparison, ensuring case-insensitive matching.
```

This documentation provides an overview of the file's purpose, key functionalities, integration within the project, and design choices made in its implementation.

---

*Generated by CodeWorm on 2026-03-01 12:48*
