# index

**Type:** File Overview
**Repository:** oneIsNun_
**File:** react-scss/src/pages/slow-queries/index.tsx
**Language:** tsx
**Lines:** 1-167
**Complexity:** 0.0

---

## Source Code

```tsx
// ===================
// AngelaMos | 2026
// slow-queries/index.tsx
// ===================

import { useState } from 'react'
import { LuClock, LuLightbulb, LuDatabase, LuCopy, LuCheck } from 'react-icons/lu'
import { useSlowQueries, useSlowQueryAnalysis, useProfilingStatus } from '@/api'
import styles from './slow-queries.module.scss'

function formatDate(date: string): string {
  return new Date(date).toLocaleString('en-US', {
    month: 'short',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit',
  })
}

function CopyButton({ text }: { text: string }): React.ReactElement {
  const [copied, setCopied] = useState(false)

  const handleCopy = () => {
    navigator.clipboard.writeText(text)
    setCopied(true)
    setTimeout(() => setCopied(false), 2000)
  }

  return (
    <button type="button" className={styles.copyBtn} onClick={handleCopy}>
      {copied ? <LuCheck /> : <LuCopy />}
    </button>
  )
}

export function Component(): React.ReactElement {
  const [minMillis] = useState(100)
  const { data: report, isLoading: queriesLoading } = useSlowQueries(minMillis, 50)
  const { data: analysis, isLoading: analysisLoading } = useSlowQueryAnalysis(minMillis, 100)
  const { data: profiling } = useProfilingStatus()

  if (queriesLoading || analysisLoading) {
    return (
      <div className={styles.page}>
        <div className={styles.loading}>Loading slow queries...</div>
      </div>
    )
  }

  const queries = report?.queries ?? []
  const suggestions = analysis?.suggestions ?? []
  const topCollections = analysis?.top_collections ?? []

  return (
    <div className={styles.page}>
      <div className={styles.header}>
        <div className={styles.headerInfo}>
          <h1 className={styles.title}>Slow Queries</h1>
          <p className={styles.subtitle}>
            {queries.length} queries over {report?.slow_ms_threshold ?? minMillis}ms
          </p>
        </div>
        {profiling && (
          <div className={styles.profilingBadge}>
            <span className={styles.profilingLabel}>Profiling Level</span>
            <span className={styles.profilingValue}>{profiling.level}</span>
          </div>
        )}
      </div>

      {suggestions.length > 0 && (
        <section className={styles.section}>
          <h2 className={styles.sectionTitle}>
            <LuLightbulb className={styles.sectionIcon} />
            Index Suggestions
          </h2>
          <div className={styles.suggestions}>
            {suggestions.map((suggestion, i) => (
              <div key={i} className={styles.suggestionCard}>
                <div className={styles.suggestionHeader}>
                  <span className={styles.suggestionCollection}>{suggestion.collection}</span>
                  <span className={styles.occurrences}>{suggestion.occurrences} occurrences</span>
                </div>
                <p className={styles.reason}>{suggestion.reason}</p>
                <div className={styles.indexCommand}>
```

---

## File Overview

# slow-queries/index.tsx Documentation

## Purpose and Responsibility
This file is responsible for rendering the Slow Queries page, which displays information about slow database queries, provides index suggestions, and highlights top slow collections.

## Key Exports and Public Interface
The primary export of this file is a React component named `Component`. This component fetches slow query data using custom hooks from the API module and renders it in a structured format. It also includes functionality for copying text to the clipboard.

## How It Fits into the Project
This page is part of the `/pages` directory, which contains various pages that users can navigate to within the application. The `Component` function acts as the main entry point for rendering slow query data and suggestions, integrating with other components like `CopyButton`.

## Notable Design Decisions
- **Custom Hooks**: Utilizes custom hooks (`useSlowQueries`, `useSlowQueryAnalysis`, `useProfilingStatus`) to fetch data from the API.
- **Conditional Rendering**: Uses state and loading indicators to manage the display of slow queries, suggestions, and collections based on their availability.
- **Copy Button**: Implements a copy functionality using the browser's clipboard API to facilitate easy sharing or use of generated index commands.
- **Styling**: Leverages SCSS for styling, ensuring consistent and responsive design across different sections.

---

*Generated by CodeWorm on 2026-02-19 23:57*
