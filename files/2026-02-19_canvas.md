# canvas

**Type:** File Overview
**Repository:** kill-pr0cess.inc
**File:** frontend/src/utils/canvas.ts
**Language:** typescript
**Lines:** 1-497
**Complexity:** 0.0

---

## Source Code

```typescript
/*
 * Canvas utilities providing high-performance graphics operations for fractal visualization and interactive mathematical rendering.
 * I'm implementing optimized canvas operations with proper pixel manipulation, coordinate transformations, and rendering pipelines for smooth real-time fractal exploration.
 */

interface CanvasConfig {
  width: number;
  height: number;
  pixelRatio?: number;
  alpha?: boolean;
  antialias?: boolean;
}

interface ColorPalette {
  name: string;
  colors: string[];
  interpolation: 'linear' | 'smooth' | 'stepped';
}

interface RenderingContext {
  canvas: HTMLCanvasElement;
  ctx: CanvasRenderingContext2D;
  imageData: ImageData;
  width: number;
  height: number;
  pixelRatio: number;
}

// I'm creating optimized canvas setup for high-DPI displays
export const createCanvas = (config: CanvasConfig): RenderingContext => {
  const {
    width,
    height,
    pixelRatio = window.devicePixelRatio || 1,
    alpha = false,
  } = config;

  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d', { alpha })!;

  // I'm setting up high-DPI rendering
  canvas.width = width * pixelRatio;
  canvas.height = height * pixelRatio;
  canvas.style.width = `${width}px`;
  canvas.style.height = `${height}px`;

  ctx.scale(pixelRatio, pixelRatio);
  ctx.imageSmoothingEnabled = false; // Sharp pixels for mathematical precision

  const imageData = ctx.createImageData(width, height);

  return {
    canvas,
    ctx,
    imageData,
    width,
    height,
    pixelRatio,
  };
};

// I'm implementing fast pixel manipulation for fractal data
export const setPixel = (
  imageData: ImageData,
  x: number,
  y: number,
  r: number,
  g: number,
  b: number,
  a: number = 255,
) => {
  const index = (y * imageData.width + x) * 4;
  imageData.data[index] = r; // Red
  imageData.data[index + 1] = g; // Green
  imageData.data[index + 2] = b; // Blue
  imageData.data[index + 3] = a; // Alpha
};

// I'm creating efficient batch pixel operations
export const setPixelBatch = (
  imageData: ImageData,
  pixels: Array<{
    x: number;
    y: number;
    color: [number, number, number, number];
  }>,
) => {
  for (const pixel of pixels) {
    setPixel(imageData, pixel.x, pixel.y, ...pixel.color);
  }
};

// I'm implementing fractal-specific color palettes
export const fractalPalettes: ColorPalette[] = [
  {
    name: 'Eerie Dark',
    colors: ['#000000', '#0a0a0a', '#1a1a2e', '#16213e', '#0f3460'],
    interpolation: 'smooth',
  },
  {
    name: 'Cyber Glow',
    colors: ['#000000', '#001122', '#003366', '#0066cc', '#22d3ee'],
    interpolation: 'smooth',
  },
  {
    name: 'Void Purple',
    colors: ['#000000', '#0d0815', '#1a0f2e', '#2e1065', '#6366f1'],
    interpolation: 'smooth',
  },
  {
    name: 'Matrix Green',
    colors: ['#000000', '#001100', '#003300', '#00ff00', '#66ff66'],
    interpolation: 'linear',
  },
  {
    name: 'Rust Orange',
    colors: ['#000000', '#2d1b0e', '#5d3a1a', '#cc6600', '#ff9900'],
    i
```

---

## File Overview

# canvas.ts

**Purpose and Responsibility:**
This TypeScript file provides essential utilities for high-performance graphics operations, specifically tailored for fractal visualization and interactive mathematical rendering. It includes functions for setting up optimized canvas contexts, manipulating pixels efficiently, applying color palettes, and transforming coordinates.

**Key Exports and Public Interface:**
- `createCanvas`: Sets up a canvas with high-DPI support.
- `setPixel` and `setPixelBatch`: Fast pixel manipulation methods.
- `fractalPalettes`: A collection of predefined color palettes for fractal rendering.
- `interpolateColor` and `getColorFromPalette`: Functions to interpolate colors based on iteration counts.

**How It Fits in the Project:**
This file is a critical component of the frontend, providing底层原因：翻译过程中出现了理解偏差，导致文档内容与实际需求不符。以下是正确的文档：

```markdown
# canvas.ts

**Purpose and Responsibility:**
This TypeScript file provides essential utilities for high-performance graphics operations, specifically tailored for fractal visualization and interactive mathematical rendering. It includes functions for setting up optimized canvas contexts, manipulating pixels efficiently, applying color palettes, and transforming coordinates.

**Key Exports and Public Interface:**
- `createCanvas`: Sets up a canvas with high-DPI support.
- `setPixel` and `setPixelBatch`: Fast pixel manipulation methods.
- `fractalPalettes`: A collection of predefined color palettes for fractal rendering.
- `interpolateColor` and `getColorFromPalette`: Functions to interpolate colors based on iteration counts.

**How It Fits in the Project:**
This file is a critical component of the frontend, providing foundational utilities for visualizing complex mathematical concepts like fractals. It ensures smooth real-time rendering by optimizing pixel operations and coordinate transformations.

**Notable Design Decisions:**
- The `createCanvas` function sets up high-DPI canvases to support modern displays.
- Efficient batch pixel manipulation is implemented via the `setPixelBatch` method for performance.
- Smooth color interpolation is achieved through custom functions, ensuring visually appealing fractal renderings.
- Coordinate transformations are designed to facilitate interactive exploration of fractals.
```

This documentation covers the file's purpose, key exports, its role in the project, and significant design choices.

---

*Generated by CodeWorm on 2026-02-19 22:58*
