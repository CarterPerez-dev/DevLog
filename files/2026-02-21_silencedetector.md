# SilenceDetector

**Type:** File Overview
**Repository:** angelamos-3d
**File:** frontend/src/lib/audio/SilenceDetector.ts
**Language:** typescript
**Lines:** 1-78
**Complexity:** 0.0

---

## Source Code

```typescript
/**
 * Â© AngelaMos | 2026
 * Monitors audio levels to detect when user stops speaking
 */

export interface SilenceDetectorOptions {
	silenceThreshold: number;
	silenceDuration: number;
	minSpeechDuration: number;
}

const DEFAULT_OPTIONS: SilenceDetectorOptions = {
	silenceThreshold: 0.08,
	silenceDuration: 850,
	minSpeechDuration: 500,
};

export class SilenceDetector {
	private options: SilenceDetectorOptions;
	private silenceStart: number | null = null;
	private speechStart: number | null = null;
	private hasSpeechStarted = false;

	public onSilenceDetected?: () => void;
	public onSpeechStarted?: () => void;

	constructor(options: Partial<SilenceDetectorOptions> = {}) {
		this.options = { ...DEFAULT_OPTIONS, ...options };
	}

	update(audioLevel: number): boolean {
		const now = Date.now();

		if (audioLevel >= this.options.silenceThreshold) {
			this.silenceStart = null;

			if (!this.hasSpeechStarted) {
				this.hasSpeechStarted = true;
				this.speechStart = now;
				this.onSpeechStarted?.();
			}
			return false;
		}

		if (!this.hasSpeechStarted) {
			return false;
		}

		if (
			this.speechStart &&
			now - this.speechStart < this.options.minSpeechDuration
		) {
			return false;
		}

		if (!this.silenceStart) {
			this.silenceStart = now;
		}

		if (now - this.silenceStart >= this.options.silenceDuration) {
			this.onSilenceDetected?.();
			return true;
		}

		return false;
	}

	reset(): void {
		this.silenceStart = null;
		this.speechStart = null;
		this.hasSpeechStarted = false;
	}

	updateOptions(options: Partial<SilenceDetectorOptions>): void {
		this.options = { ...this.options, ...options };
	}
}

```

---

## File Overview

### SilenceDetector.ts

**Purpose & Responsibility:**
This file implements a `SilenceDetector` class to monitor audio levels, detecting when user speech stops based on predefined thresholds and durations.

**Key Exports & Public Interface:**
- **Class:** `SilenceDetector`
  - **Properties:**
    - `options`: Configuration options for silence detection.
    - `onSilenceDetected`, `onSpeechStarted`: Event handlers for detected silence or speech start.
  - **Methods:**
    - `constructor(options?: Partial<SilenceDetectorOptions>)`: Initializes the detector with optional configuration.
    - `update(audioLevel: number): boolean`: Updates state based on audio level and returns if silence is detected.
    - `reset(): void`: Resets internal states to initial conditions.
    - `updateOptions(options: Partial<SilenceDetectorOptions>): void`: Updates configuration options.

**How it Fits in the Project:**
This class is part of a larger audio processing module, likely used for managing user interactions and enhancing user experience by detecting periods of silence. It integrates with other components that may require real-time audio analysis or response to speech patterns.

**Notable Design Decisions:**
- **Configuration Flexibility:** The `SilenceDetectorOptions` interface allows customization through constructor options.
- **State Management:** Internal states like `silenceStart`, `speechStart`, and `hasSpeechStarted` manage the detection logic efficiently.
- **Event Handling:** Using optional event handlers (`onSilenceDetected`, `onSpeechStarted`) to decouple the detector from specific use cases, promoting reusability across different parts of the application.
```

This documentation provides a high-level overview of the file's purpose, key components, integration within the project, and design choices.

---

*Generated by CodeWorm on 2026-02-21 00:33*
