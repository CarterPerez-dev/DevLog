# useWakeWord

**Type:** File Overview
**Repository:** angelamos-3d
**File:** frontend/src/hooks/useWakeWord.ts
**Language:** typescript
**Lines:** 1-73
**Complexity:** 0.0

---

## Source Code

```typescript
// ===================
// Â© AngelaMos | 2026
// useWakeWord.ts
// ===================

import { useCallback, useEffect, useRef } from "react";
import { AudioRecorder } from "../lib/audio";
import { logger } from "../lib/debug";
import { createWakeWordEngine } from "../lib/wakeword";

type WakeWordEngine = Awaited<ReturnType<typeof createWakeWordEngine>>;

interface UseWakeWordResult {
	wakeWordRef: React.MutableRefObject<WakeWordEngine | null>;
	recorderRef: React.MutableRefObject<AudioRecorder | null>;
	setWakeWordCallback: (callback: () => void) => void;
}

export function useWakeWord(
	onReady: () => void,
	onError: (error: Error) => void,
): UseWakeWordResult {
	const wakeWordRef = useRef<WakeWordEngine | null>(null);
	const recorderRef = useRef<AudioRecorder | null>(null);
	const callbackRef = useRef<(() => void) | null>(null);

	const setWakeWordCallback = useCallback((callback: () => void) => {
		callbackRef.current = callback;
		if (wakeWordRef.current) {
			wakeWordRef.current.onWakeWord = callback;
		}
	}, []);

	useEffect(() => {
		let mounted = true;

		const init = async () => {
			try {
				recorderRef.current = new AudioRecorder();
				await recorderRef.current.initialize();
				logger.page.log("AudioRecorder ready");

				const wakeWord = await createWakeWordEngine();
				wakeWordRef.current = wakeWord;

				if (callbackRef.current) {
					wakeWord.onWakeWord = callbackRef.current;
				}

				await wakeWord.start();
				logger.page.log("Wake word listening");

				if (mounted) onReady();
			} catch (err) {
				logger.page.error("Init error:", err);
				if (mounted) {
					onError(err instanceof Error ? err : new Error("Init failed"));
				}
			}
		};

		init();

		return () => {
			mounted = false;
			wakeWordRef.current?.dispose();
			recorderRef.current?.dispose();
		};
	}, [onReady, onError]);

	return { wakeWordRef, recorderRef, setWakeWordCallback };
}

```

---

## File Overview

# useWakeWord.ts

## Purpose and Responsibility
This file provides a React hook for initializing and managing a wake word engine, which listens for specific keywords to trigger actions within an application. It integrates with audio recording and logging functionalities.

## Key Exports or Public Interface
- `useWakeWord`: A React hook that returns:
  - `wakeWordRef`: A reference to the wake word engine.
  - `recorderRef`: A reference to the audio recorder.
  - `setWakeWordCallback`: A function to set a callback for when the wake word is detected.

## How it Fits in the Project
`useWakeWord` is part of the frontend hooks module, enabling voice-activated features. It interacts with lower-level modules like `audio` and `debug`, forming a cohesive component for speech recognition functionalities.

## Notable Design Decisions
1. **Ref Objects**: Uses `React.MutableRefObject` to manage state across function scopes.
2. **Error Handling**: Catches initialization errors and logs them, ensuring robustness.
3. **Lifecycle Management**: Ensures cleanup when the hook unmounts by disposing of resources.
4. **Asynchronous Initialization**: Waits for audio recorder and wake word engine initialization before starting listening.
```

This documentation provides a high-level overview of the file's purpose, key components, integration within the project, and significant design choices.

---

*Generated by CodeWorm on 2026-02-21 00:35*
