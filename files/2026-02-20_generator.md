# generator

**Type:** File Overview
**Repository:** pyproject-setup
**File:** src/pyproject_setup/generator.py
**Language:** python
**Lines:** 1-256
**Complexity:** 0.0

---

## Source Code

```python
"""
AngelaMos | 2025
generator.py
"""

from typing import Any
from pathlib import Path
from dataclasses import dataclass

import tomli_w

from .presets import (
    PRESETS,
    Preset,
    get_mypy_config,
    get_pylint_config,
    get_pytest_config,
    get_ruff_config,
    get_ty_config,
    get_coverage_config,
    get_pydantic_mypy_config,
)


@dataclass
class ProjectConfig:
    """
    User provided project configuration
    """
    name: str
    description: str
    version: str = "0.1.0"
    python_version: str = ">=3.12"
    package_path: str = "src"
    preset: str = "fastapi-backend"
    homepage: str | None = None
    repository: str | None = None
    author_name: str | None = None
    author_email: str | None = None


PUBLISH_WORKFLOW = '''name: Publish to PyPI

on:
  push:
    branches:
      - main

permissions:
  contents: read

jobs:
  pypi-publish:
    name: Upload release to PyPI
    runs-on: ubuntu-latest
    environment:
      name: pypi
      url: https://pypi.org/p/$PROJECT_NAME
    permissions:
      id-token: write
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install build dependencies
        run: |
          python -m pip install --upgrade pip
          pip install build

      - name: Build package
        run: python -m build

      - name: Publish to PyPI
        uses: pypa/gh-action-pypi-publish@release/v1
'''

STYLE_YAPF = '''[style]
based_on_style = pep8
column_limit = 75
indent_width = 4
continuation_indent_width = 4
indent_closing_brackets = false
dedent_closing_brackets = true
indent_blank_lines = false
spaces_before_comment = 2
spaces_around_power_operator = false
spaces_around_default_or_named_assign = true
space_between_ending_comma_and_closing_bracket = false
space_inside_brackets = false
spaces_around_subscript_colon = true
blank_line_before_nested_class_or_def = false
blank_line_before_class_docstring = false
blank_lines_around_top_level_definition = 2
blank_lines_between_top_level_imports_and_variables = 2
blank_line_before_module_docstring = false
split_before_logical_operator = true
split_before_first_argument = true
split_before_named_assigns = true
split_complex_comprehension = true
split_before_expression_after_opening_paren = false
split_before_closing_bracket = true
split_all_comma_separated_values = true
split_all_top_level_comma_separated_values = false
coalesce_brackets = false
each_dict_entry_on_separate_line = true
allow_multiline_lambdas = false
allow_multiline_dictionary_keys = false
split_penalty_import_names = 0
join_multiple_lines = false
align_closing_bracket_with_visual_indent = true
arithmetic_precedence_indication = false
split_penalty_for_added_line_split = 275
use_tabs = false
split_before_dot = false
split_arguments_when_comma_terminated = true
i18n_function_call = ['_', 'N_', 'gettext', 'ngettext']
i18n_comment = ['# Transla
```

---

## File Overview

# generator.py

## Purpose and Responsibility
This Python source file is responsible for generating `pyproject.toml` configurations based on user-provided settings, including project metadata, dependencies, and optional development tools configurations. It also includes a GitHub Actions workflow for publishing to PyPI.

## Key Exports and Public Interface
- **ProjectConfig**: A dataclass representing the user's project configuration.
- **build_pyproject(config: ProjectConfig) -> dict[str, Any]**: A function that constructs a complete `pyproject.toml` structure from the provided `ProjectConfig`.

## How It Fits in the Project
This file is part of the `pyproject_setup` package, which aims to automate the setup and configuration of Python projects. The `build_pyproject` function generates the necessary `pyproject.toml` content, ensuring that all required configurations are included based on user preferences.

## Notable Design Decisions
- **Dataclass for Configuration**: Utilizes `dataclass` for `ProjectConfig` to simplify handling project metadata.
- **Preset Management**: Uses a dictionary of presets (`PRESETS`) to provide default configurations, allowing users to select from predefined settings like "fastapi-backend".
- **GitHub Actions Workflow**: Includes a GitHub Actions workflow template for publishing to PyPI, which can be customized as needed.

This file plays a crucial role in streamlining the setup process by automating the creation of essential configuration files and workflows.

---

*Generated by CodeWorm on 2026-02-20 21:24*
