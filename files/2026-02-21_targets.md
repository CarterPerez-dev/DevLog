# targets

**Type:** File Overview
**Repository:** CodeWorm
**File:** codeworm/analysis/targets.py
**Language:** python
**Lines:** 1-705
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2026
analysis/targets.py
"""
from __future__ import annotations

import random
from dataclasses import dataclass, field
from pathlib import Path
from typing import TYPE_CHECKING

from git import InvalidGitRepositoryError, Repo

from codeworm.analysis.parser import CodeExtractor, ParserManager
from codeworm.analysis.scanner import RepoScanner
from codeworm.models import LANGUAGE_EXTENSIONS, CodeSnippet, DocType, Language

if TYPE_CHECKING:
    from codeworm.core.config import AnalyzerSettings, RepoEntry


@dataclass
class DocumentationTarget:
    """
    A generalized documentation target that supports any doc type
    """
    doc_type: DocType
    snippet: CodeSnippet
    source_context: str
    metadata: dict = field(default_factory = dict)

    @property
    def score(self) -> float:
        return self.snippet.interest_score

    @property
    def display_name(self) -> str:
        return self.snippet.display_name


class FileTargetFinder:
    """
    Finds files worth documenting at the file level
    """
    def __init__(self, scanner: RepoScanner) -> None:
        self.scanner = scanner

    def find(
        self,
        repo: RepoEntry,
        limit: int = 20,
    ) -> list[DocumentationTarget]:
        targets: list[DocumentationTarget] = []

        for scanned_file in self.scanner.scan_repo(repo.path, repo.name):
            try:
                source = scanned_file.path.read_text(encoding = "utf-8")
            except Exception:
                continue

            line_count = source.count("\n") + 1
            if line_count < 20:
                continue

            extractor = CodeExtractor(source, scanned_file.language)
            func_count = sum(1 for _ in extractor.extract_functions())

            score = min(
                100.0,
                (
                    min(line_count / 200,
                        1.0) * 30 + min(func_count / 8,
                                        1.0) * 30 +
                    min(scanned_file.size_bytes / 5000,
                        1.0) * 20 + min(source.count("import ") / 10,
                                        1.0) * 20
                )
            )

            if score < 20:
                continue

            snippet = CodeSnippet(
                repo = repo.name,
                file_path = scanned_file.path,
                function_name = None,
                class_name = None,
                language = scanned_file.language,
                source = source[: 4000],
                start_line = 1,
                end_line = line_count,
                interest_score = score,
                doc_type = DocType.FILE_DOC,
            )

            targets.append(
                DocumentationTarget(
                    doc_type = DocType.FILE_DOC,
                    snippet = snippet,
                    source_context = source[: 6000],
                    metadata = {
                        "line_count": line_count,
                        
```

---

## File Overview

### Purpose and Responsibility

This Python source file, `targets.py`, is part of the CodeWorm project, responsible for identifying and extracting documentation targets from code repositories. It defines classes to find files and classes worth documenting based on various criteria such as line count, function count, and presence of docstrings.

### Key Exports and Public Interface

- **`DocumentationTarget`**: A dataclass representing a generalized documentation target.
- **`FileTargetFinder`**: Finds files with potential for documentation.
- **`ClassTargetFinder`**: Identifies classes that could benefit from documentation.

These classes are exported as part of the `codeworm.analysis` module, providing functionality to analyze code repositories and generate documentation targets.

### Project Integration

This file integrates closely with other components in the CodeWorm project:
- It relies on `RepoScanner` for scanning repository files.
- Uses `CodeExtractor` from `codeworm.analysis.parser` to extract relevant snippets of code.
- Leverages `DocType`, `Language`, and `CodeSnippet` models defined in `codeworm.models`.

### Design Decisions

1. **Scoring Mechanism**: A scoring system is used to prioritize targets based on factors like line count, function count, and docstring presence, ensuring that only the most relevant code snippets are considered.
2. **Limiting Results**: Both `FileTargetFinder` and `ClassTargetFinder` limit the number of results returned, preventing overwhelming the user with too many potential documentation targets.
3. **Type Hints and Dataclasses**: The use of type hints and dataclasses (e.g., `DocumentationTarget`) enhances code readability and maintainability, making it easier to understand and extend the functionality.

This design ensures that CodeWorm can efficiently identify and document important parts of a codebase without overwhelming users with too many targets.

---

*Generated by CodeWorm on 2026-02-21 01:43*
