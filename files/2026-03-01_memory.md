# memory

**Type:** File Overview
**Repository:** Yoshi-Audit
**File:** internal/system/memory.go
**Language:** go
**Lines:** 1-100
**Complexity:** 0.0

---

## Source Code

```go
// Â©AngelaMos | 2026
// memory.go

package system

import (
	"bufio"
	"fmt"
	"os"
	"strconv"
	"strings"
)

type MemoryInfo struct {
	TotalRAM     uint64
	UsedRAM      uint64
	AvailableRAM uint64
	TotalSwap    uint64
	UsedSwap     uint64
}

func (m MemoryInfo) RAMPercent() float64 {
	if m.TotalRAM == 0 {
		return 0
	}
	return float64(m.UsedRAM) / float64(m.TotalRAM) * 100
}

func (m MemoryInfo) SwapPercent() float64 {
	if m.TotalSwap == 0 {
		return 0
	}
	return float64(m.UsedSwap) / float64(m.TotalSwap) * 100
}

func GetMemoryInfo() (MemoryInfo, error) {
	f, err := os.Open("/proc/meminfo")
	if err != nil {
		return MemoryInfo{}, err
	}
	defer f.Close()

	values := make(map[string]uint64)
	scanner := bufio.NewScanner(f)
	for scanner.Scan() {
		line := scanner.Text()
		parts := strings.SplitN(line, ":", 2)
		if len(parts) != 2 {
			continue
		}

		key := strings.TrimSpace(parts[0])
		valStr := strings.TrimSpace(parts[1])
		valStr = strings.TrimSuffix(valStr, " kB")
		valStr = strings.TrimSpace(valStr)

		val, parseErr := strconv.ParseUint(valStr, 10, 64)
		if parseErr != nil {
			continue
		}

		values[key] = val * 1024
	}

	if err := scanner.Err(); err != nil {
		return MemoryInfo{}, err
	}

	memTotal, ok := values["MemTotal"]
	if !ok {
		return MemoryInfo{}, fmt.Errorf("MemTotal not found in /proc/meminfo")
	}

	memAvailable, ok := values["MemAvailable"]
	if !ok {
		return MemoryInfo{}, fmt.Errorf("MemAvailable not found in /proc/meminfo")
	}

	swapTotal := values["SwapTotal"]
	swapFree := values["SwapFree"]

	return MemoryInfo{
		TotalRAM:     memTotal,
		UsedRAM:      memTotal - memAvailable,
		AvailableRAM: memAvailable,
		TotalSwap:    swapTotal,
		UsedSwap:     swapTotal - swapFree,
	}, nil
}

func FormatBytes(b uint64) string {
	const gib = 1024 * 1024 * 1024
	const mib = 1024 * 1024

	if b >= gib {
		return fmt.Sprintf("%.1f GiB", float64(b)/float64(gib))
	}
	return fmt.Sprintf("%.1f MiB", float64(b)/float64(mib))
}

```

---

## File Overview

# memory.go

## Purpose and Responsibility
This Go source file is responsible for fetching and processing system memory information from `/proc/meminfo`. It provides a structured representation of memory usage metrics, including total RAM, used RAM, available RAM, total swap space, and used swap space. The file also includes functions to calculate the percentage of used RAM and swap space.

## Key Exports and Public Interface
- `MemoryInfo`: A struct representing system memory information.
- `RAMPercent() float64`: Returns the percentage of used RAM.
- `SwapPercent() float64`: Returns the percentage of used swap space.
- `GetMemoryInfo() (MemoryInfo, error)`: Fetches and parses `/proc/meminfo` to populate a `MemoryInfo` struct.
- `FormatBytes(uint64) string`: Formats byte values into human-readable sizes (GiB or MiB).

## Fit in the Project
This file is part of the system monitoring module within the Yoshi-Audit project. It provides essential memory metrics that can be used for performance analysis and alerting.

## Notable Design Decisions
- The `GetMemoryInfo` function reads `/proc/meminfo`, a Linux-specific file, to gather memory statistics.
- Error handling is robust, ensuring that missing keys in `/proc/meminfo` result in clear error messages.
- Memory usage percentages are calculated using the total and used values.
- Byte formatting uses Go's `fmt.Sprintf` for readability and consistency.

---

*Generated by CodeWorm on 2026-03-01 12:03*
