# config

**Type:** File Overview
**Repository:** docksec
**File:** internal/config/config.go
**Language:** go
**Lines:** 1-91
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
config.go
*/

package config

import "github.com/CarterPerez-dev/docksec/internal/finding"

type Config struct {
	Targets           []string
	Files             []string
	Output            string
	OutputFile        string
	Severity          []string
	CISControls       []string
	ExcludeContainers []string
	IncludeContainers []string
	FailOn            string
	Quiet             bool
	Verbose           bool
	Workers           int
}

func New() *Config {
	return &Config{
		Targets: []string{"all"},
		Output:  "terminal",
		Workers: DefaultWorkerCount,
	}
}

func (c *Config) ShouldScanContainers() bool {
	return c.containsTarget("all") || c.containsTarget("containers")
}

func (c *Config) ShouldScanDaemon() bool {
	return c.containsTarget("all") || c.containsTarget("daemon")
}

func (c *Config) ShouldScanImages() bool {
	return c.containsTarget("all") || c.containsTarget("images")
}

func (c *Config) HasFileTargets() bool {
	return len(c.Files) > 0
}

func (c *Config) containsTarget(target string) bool {
	for _, t := range c.Targets {
		if t == target {
			return true
		}
	}
	return false
}

func (c *Config) GetFailOnSeverity() (finding.Severity, bool) {
	if c.FailOn == "" {
		return finding.SeverityInfo, false
	}
	sev, ok := finding.ParseSeverity(c.FailOn)
	return sev, ok
}

func (c *Config) GetSeverityFilters() []finding.Severity {
	if len(c.Severity) == 0 {
		return nil
	}
	var severities []finding.Severity
	for _, s := range c.Severity {
		if sev, ok := finding.ParseSeverity(s); ok {
			severities = append(severities, sev)
		}
	}
	return severities
}

func (c *Config) ShouldIncludeSeverity(sev finding.Severity) bool {
	filters := c.GetSeverityFilters()
	if len(filters) == 0 {
		return true
	}
	for _, f := range filters {
		if f == sev {
			return true
		}
	}
	return false
}

```

---

## File Overview

# config.go

## Purpose and Responsibility
This Go source file defines the `config` package, responsible for managing configuration settings for the docksec tool. It provides a structured way to handle various parameters such as targets, output formats, severity levels, and more.

## Key Exports and Public Interface
- **Config**: A struct representing the application's configuration.
- **New() *Config**: A factory function to create a new `Config` instance with default settings.
- **ShouldScanContainers(), ShouldScanDaemon(), ShouldScanImages()**: Methods to determine if specific parts of the system should be scanned based on configured targets.
- **HasFileTargets()**: Checks if file-based scanning is enabled.
- **containsTarget(target string) bool**: Helper method to check for a specific target in the `Config` instance.
- **GetFailOnSeverity() (finding.Severity, bool)**: Retrieves the severity level at which the scan should fail.
- **GetSeverityFilters() []finding.Severity**: Returns an array of severity filters based on user configuration.

## How It Fits into the Project
The `config` package is a crucial component that initializes and manages the application's settings. It interacts with other packages, such as `finding`, to determine how scans should be conducted and what criteria should trigger failures or outputs.

## Notable Design Decisions
- **Error Handling**: The `GetSeverityFilters()` method ensures robust error handling by returning both a slice of severities and a boolean indicating success.
- **Default Values**: The `New()` function sets default values for configuration parameters, ensuring that the application can run without explicit user input.
- **Worker Management**: The `Workers` field allows parallel execution through goroutines, optimizing performance based on user-defined worker counts.
```

This documentation provides an overview of the file's purpose, key functions, integration within the project, and design choices.

---

*Generated by CodeWorm on 2026-02-20 20:46*
