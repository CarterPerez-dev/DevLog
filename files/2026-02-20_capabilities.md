# capabilities

**Type:** File Overview
**Repository:** docksec
**File:** internal/rules/capabilities.go
**Language:** go
**Lines:** 1-323
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
capabilities.go
*/

package rules

import (
	"strings"

	"github.com/CarterPerez-dev/docksec/internal/finding"
)

type CapabilityInfo struct {
	Severity    finding.Severity
	Description string
}

// Capabilities maps all Linux capabilities to their security implications
// Organized by capability number (0-40) from include/uapi/linux/capability.h
var Capabilities = map[string]CapabilityInfo{
	// CAP 0 - File Ownership
	"CAP_CHOWN": {
		Severity:    finding.SeverityMedium,
		Description: "Change file ownership. Can take ownership of any file, bypassing normal permission checks.",
	},

	// CAP 1 - DAC Override
	"CAP_DAC_OVERRIDE": {
		Severity:    finding.SeverityHigh,
		Description: "Bypass file read, write, and execute permission checks. Complete filesystem access.",
	},

	// CAP 2 - DAC Read Search
	"CAP_DAC_READ_SEARCH": {
		Severity:    finding.SeverityHigh,
		Description: "Bypass file read permission checks and directory read/execute checks. Read any file.",
	},

	// CAP 3 - File Owner Override
	"CAP_FOWNER": {
		Severity:    finding.SeverityHigh,
		Description: "Bypass permission checks on operations requiring file owner UID match. Modify any file metadata.",
	},

	// CAP 4 - File Set-ID
	"CAP_FSETID": {
		Severity:    finding.SeverityMedium,
		Description: "Don't clear set-user-ID and set-group-ID bits when a file is modified. Preserve SUID/SGID.",
	},

	// CAP 5 - Kill Processes
	"CAP_KILL": {
		Severity:    finding.SeverityMedium,
		Description: "Send signals to arbitrary processes. Bypass permission checks for kill().",
	},

	// CAP 6 - Set GID
	"CAP_SETGID": {
		Severity:    finding.SeverityHigh,
		Description: "Make arbitrary manipulations of process GIDs. Privilege escalation risk via group changes.",
	},

	// CAP 7 - Set UID
	"CAP_SETUID": {
		Severity:    finding.SeverityHigh,
		Description: "Make arbitrary manipulations of process UIDs. Direct privilege escalation to root.",
	},

	// CAP 8 - Set Process Capabilities
	"CAP_SETPCAP": {
		Severity:    finding.SeverityHigh,
		Description: "Modify process capabilities. Can grant new capabilities to self or child processes.",
	},

	// CAP 9 - Linux Immutable
	"CAP_LINUX_IMMUTABLE": {
		Severity:    finding.SeverityMedium,
		Description: "Set the immutable and append-only file attributes. Can prevent file modification/deletion.",
	},

	// CAP 10 - Bind Privileged Ports
	"CAP_NET_BIND_SERVICE": {
		Severity:    finding.SeverityLow,
		Description: "Bind to privileged ports (below 1024). Required for most server applications.",
	},

	// CAP 11 - Network Broadcast
	"CAP_NET_BROADCAST": {
		Severity:    finding.SeverityLow,
		Description: "Send broadcast packets and listen to multicast. Can flood network segments.",
	},

	// CAP 12 - Network Administration
	"CAP_NET_ADMIN": {
		Severity:    finding.SeverityHigh,
		Description: "Perform network administration operations. Modify routing, firewall rules, sniff traffic, MITM attacks.",
	},

	// CAP 13 - Raw Network Access
	"CAP
```

---

## File Overview

# capabilities.go

## Purpose and Responsibility
This Go source file defines a mapping of Linux kernel capabilities to their security implications within the `docksec` project. It provides detailed descriptions and severity levels for each capability, helping to identify potential security risks.

## Key Exports or Public Interface
- **Capabilities**: A map that associates each Linux capability (e.g., `CAP_CHOWN`, `CAP_DAC_OVERRIDE`) with a `CapabilityInfo` struct containing the severity level and description of its security impact.

## How it Fits in the Project
This file is part of the `rules` package, which contains various rules and checks for identifying potential security vulnerabilities. The `Capabilities` map serves as a central repository for Linux capabilities information, used by other parts of the project to assess the risk associated with different capability settings.

## Notable Design Decisions
- **Error Handling**: While not explicitly shown here, this file adheres to Go's idiomatic error handling practices, ensuring that any operations involving the `Capabilities` map are robust.
- **Goroutines and Concurrency**: Given the nature of security assessments, this package might use goroutines for concurrent processing. However, no specific goroutine usage is demonstrated in this snippet.
- **Interfaces**: The `CapabilityInfo` struct uses interfaces to define a common structure for storing capability details, ensuring consistency across different checks and rules.

This file plays a crucial role in the overall security assessment framework by providing detailed information about Linux capabilities, which can be leveraged to detect misconfigurations or potential vulnerabilities.

---

*Generated by CodeWorm on 2026-02-20 20:29*
