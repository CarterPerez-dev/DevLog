# reporter

**Type:** File Overview
**Repository:** docksec
**File:** internal/report/reporter.go
**Language:** go
**Lines:** 1-62
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
reporter.go
*/

package report

import (
	"fmt"
	"io"
	"os"

	"github.com/CarterPerez-dev/docksec/internal/finding"
)

type Reporter interface {
	Report(findings finding.Collection) error
}

func NewReporter(format, outputFile string) (Reporter, error) {
	var w io.Writer = os.Stdout
	var closer func() error

	if outputFile != "" {
		f, err := os.Create(outputFile)
		if err != nil {
			return nil, fmt.Errorf("creating output file: %w", err)
		}
		w = f
		closer = f.Close
	}

	switch format {
	case "terminal", "":
		return &TerminalReporter{
			w:       w,
			closer:  closer,
			colored: outputFile == "",
		}, nil
	case "json":
		return &JSONReporter{w: w, closer: closer}, nil
	case "sarif":
		return &SARIFReporter{w: w, closer: closer}, nil
	case "junit":
		return &JUnitReporter{w: w, closer: closer}, nil
	default:
		return nil, fmt.Errorf("unsupported output format: %s", format)
	}
}

type baseReporter struct {
	w      io.Writer
	closer func() error
}

func (r *baseReporter) close() error {
	if r.closer != nil {
		return r.closer()
	}
	return nil
}

```

---

## File Overview

# reporter.go

## Purpose and Responsibility
This Go source file defines the `reporter` package, which is responsible for generating reports based on a collection of findings. It supports different output formats such as terminal, JSON, SARIF, and JUnit.

## Key Exports and Public Interface
- **Reporter**: An interface that defines the `Report` method for reporting findings.
- **NewReporter**: A function to create an instance of a reporter based on specified format and output file. It returns an implementation of the `Reporter` interface along with any potential errors.

## How it Fits into the Project
The `reporter.go` file is part of the `docksec` project, specifically within the `internal/report` package. It acts as a central point for generating reports from findings collected by other parts of the application. The reporters can output to the terminal or write to files in various formats, making it flexible and extensible.

## Notable Design Decisions
- **Error Handling**: Errors are handled using Go's `error` type, ensuring that any issues during file creation or reporting are properly reported.
- **Goroutines**: While not explicitly used here, the design allows for potential use of goroutines in future implementations to handle concurrent report generation.
- **Interfaces and Polymorphism**: The `Reporter` interface enables polymorphic behavior, allowing different types of reporters (e.g., terminal, JSON) to be easily swapped out or extended without changing the calling code.
```

This documentation provides an overview of the file's purpose, key exports, integration within the project, and notable design choices.

---

*Generated by CodeWorm on 2026-02-20 21:09*
