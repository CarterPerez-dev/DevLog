# fractals

**Type:** File Overview
**Repository:** kill-pr0cess.inc
**File:** frontend/src/services/fractals.ts
**Language:** typescript
**Lines:** 1-552
**Complexity:** 0.0

---

## Source Code

```typescript
/*
 * Â©AngelaMos | 2025
 */

import { apiClient } from './api';

interface FractalRequest {
  width: number;
  height: number;
  center_x: number;
  center_y: number;
  zoom: number;
  max_iterations: number;
  fractal_type: 'mandelbrot' | 'julia';
  c_real?: number;
  c_imag?: number;
}

interface FractalResponse {
  data: number[];
  width: number;
  height: number;
  computation_time_ms: number;
  zoom_level: number;
  parameters: {
    center_x: number;
    center_y: number;
    max_iterations: number;
    fractal_type: string;
    c_real?: number;
    c_imag?: number;
  };
  performance_metrics: {
    pixels_per_second: number;
    parallel_efficiency: number;
    memory_usage_mb: number;
    cpu_utilization: number;
  };
}

interface BenchmarkResult {
  benchmark_results: Array<{
    complexity: string;
    resolution: string;
    total_pixels: number;
    mandelbrot: {
      computation_time_ms: number;
      pixels_per_ms: number;
      performance_rating: string;
    };
    julia: {
      computation_time_ms: number;
      pixels_per_ms: number;
      performance_rating: string;
    };
  }>;
  system_context: {
    cpu_model: string;
    cpu_cores: number;
    memory_total_gb: number;
    rust_version: string;
    parallel_processing: boolean;
  };
  performance_analysis: {
    language: string;
    framework: string;
    optimization_level: string;
  };
}

interface FractalPreset {
  name: string;
  description: string;
  parameters: Partial<FractalRequest>;
  thumbnail?: string;
}

class FractalService {
  private cache: Map<string, { data: FractalResponse; timestamp: number }>;
  private readonly CACHE_TTL = 10 * 60 * 1000; // 10 minutes
  private activeRequests: Map<string, Promise<FractalResponse>>;

  constructor() {
    this.cache = new Map();
    this.activeRequests = new Map();

    // I'm setting up cache cleanup to prevent memory bloat
    setInterval(() => this.cleanupCache(), 2 * 60 * 1000); // Cleanup every 2 minutes
  }

  private cleanupCache() {
    const now = Date.now();
    for (const [key, entry] of this.cache.entries()) {
      if (now - entry.timestamp > this.CACHE_TTL) {
        this.cache.delete(key);
      }
    }
  }

  private getCacheKey(request: FractalRequest): string {
    // I'm creating a deterministic cache key from fractal parameters
    const params = {
      type: request.fractal_type,
      w: request.width,
      h: request.height,
      cx: Number(request.center_x.toFixed(10)),
      cy: Number(request.center_y.toFixed(10)),
      z: Number(request.zoom.toFixed(10)),
      i: request.max_iterations,
      ...(request.fractal_type === 'julia' && {
        cr: Number((request.c_real || 0).toFixed(10)),
        ci: Number((request.c_imag || 0).toFixed(10)),
      }),
    };

    return JSON.stringify(params);
  }

  private getFromCache(key: string): FractalResponse | null {
    const entry = this.cache.get(key);
    if (!entry) return null;

    const now = Date.now();
    if (now - entry.timestamp 
```

---

## File Overview

### FractalService Class Documentation

**Purpose:**
This file defines `FractalService`, a service responsible for generating Mandelbrot and Julia fractals, caching results, and benchmarking performance.

**Key Exports & Public API:**
- **`generateMandelbrot(params: { width?: number; height?: number; center_x: number; center_y: number; zoom: number; max_iterations?: number }): Promise<FractalResponse>`**: Generates a Mandelbrot fractal with the specified parameters.
- **`generateJulia(params: { width?: number; height?: number; center_x: number; center_y: number; zoom: number; c_real: number; c_imag: number; max_iterations?: number }): Promise<FractalResponse>`**: Generates a Julia fractal with the specified parameters.

**How it Fits into the Project:**
`FractalService` is part of the frontend services layer, handling all fractal generation logic. It interacts with `apiClient` for remote API calls and caches results to improve performance and reduce load on external services.

**Notable Design Decisions:**
- **Caching Mechanism**: Uses a cache to store recent fractal generation results based on parameters, reducing redundant computations.
- **Cache Cleanup**: Periodically cleans the cache to prevent memory bloat, ensuring efficient use of resources.
- **Parameter Normalization**: Ensures consistent parameter handling by normalizing floating-point values and providing default values where necessary.
- **Benchmarking**: Includes methods for generating benchmark results to analyze performance across different fractal types and parameters.
```

This documentation provides an overview of the file's purpose, key exports, integration within the project, and significant design choices.

---

*Generated by CodeWorm on 2026-02-19 20:49*
