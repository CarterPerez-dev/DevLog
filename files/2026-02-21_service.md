# service

**Type:** File Overview
**Repository:** angelamos-3d
**File:** backend/app/tts/service.py
**Language:** python
**Lines:** 1-46
**Complexity:** 0.0

---

## Source Code

```python
"""
Â©AngelaMos | 2026
service.py
"""

import io

import edge_tts

from app.config import settings
from app.core.exceptions import EmptyTextError
from app.tts.schemas import VoiceInfo


async def synthesize(text: str) -> bytes:
    """
    Synthesize text to speech audio.
    """
    if not text.strip():
        raise EmptyTextError()

    communicate = edge_tts.Communicate(text, settings.TTS_VOICE)

    buffer = io.BytesIO()
    async for chunk in communicate.stream():
        if chunk["type"] == "audio":
            buffer.write(chunk["data"])

    buffer.seek(0)
    return buffer.read()


async def list_voices() -> list[VoiceInfo]:
    """
    Get all available Edge TTS voices.
    """
    voices = await edge_tts.list_voices()
    return [
        VoiceInfo(
            voice_id = v["ShortName"],
            name = v["FriendlyName"],
            gender = v["Gender"],
            locale = v["Locale"],
        ) for v in voices
    ]

```

---

## File Overview

# service.py

**Purpose & Responsibility:**
This Python file is responsible for handling text-to-speech (TTS) synthesis using Microsoft Edge TTS API. It provides core functionality to synthesize text into speech audio and list available voices.

**Key Exports & Public Interface:**
- `synthesize(text: str) -> bytes`: Synthesizes the given text into an audio stream.
- `list_voices() -> list[VoiceInfo]`: Retrieves a list of available TTS voices with their details.

**How It Fits in the Project:**
This service module is part of the Text-to-Speech (TTS) component within the broader application. It interacts with external APIs to provide speech synthesis capabilities, which are essential for text-based voice outputs in various parts of the application.

**Notable Design Decisions:**
- **Error Handling:** The `synthesize` function raises an `EmptyTextError` if the input text is empty or contains only whitespace.
- **Asynchronous Operations:** Both functions are asynchronous to support non-blocking operations, suitable for I/O-bound tasks like TTS synthesis.
- **Dependency Injection:** Utilizes configuration settings from `app.config.settings` and schema definitions from `app.tts.schemas`.
```

This documentation provides a high-level overview of the file's purpose, key exports, integration within the project, and notable design decisions.

---

*Generated by CodeWorm on 2026-02-21 00:48*
