# secrets

**Type:** File Overview
**Repository:** docksec
**File:** internal/rules/secrets.go
**Language:** go
**Lines:** 1-1371
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
secrets.go
*/

package rules

import (
	"math"
	"regexp"
	"strings"
)

type SecretType string

const (
	SecretTypeGeneric          SecretType = "generic"
	SecretTypeAWSKey           SecretType = "aws_key"
	SecretTypeAWSSecret        SecretType = "aws_secret"
	SecretTypeGCPKey           SecretType = "gcp_key"
	SecretTypeAzureKey         SecretType = "azure_key"
	SecretTypeGitHub           SecretType = "github_token"
	SecretTypeGitLab           SecretType = "gitlab_token"
	SecretTypeSlack            SecretType = "slack_token"
	SecretTypeStripe           SecretType = "stripe_key"
	SecretTypeTwilio           SecretType = "twilio_key"
	SecretTypeSendGrid         SecretType = "sendgrid_key"
	SecretTypeMailgun          SecretType = "mailgun_key"
	SecretTypeNPM              SecretType = "npm_token"
	SecretTypePyPI             SecretType = "pypi_token"
	SecretTypeDockerHub        SecretType = "dockerhub_token"
	SecretTypeSSHKey           SecretType = "ssh_key"
	SecretTypePrivateKey       SecretType = "private_key"
	SecretTypeJWT              SecretType = "jwt"
	SecretTypeBasicAuth        SecretType = "basic_auth"
	SecretTypeBearer           SecretType = "bearer_token"
	SecretTypeAPIKey           SecretType = "api_key"
	SecretTypePassword         SecretType = "password"
	SecretTypeDatabase         SecretType = "database_url"
	SecretTypeConnectionString SecretType = "connection_string"
)

type SecretPattern struct {
	Type        SecretType
	Pattern     *regexp.Regexp
	Description string
}

var SecretPatterns = []SecretPattern{
	// ==================== AWS ====================
	{
		Type: SecretTypeAWSKey,
		Pattern: regexp.MustCompile(
			`(?i)(AKIA|ABIA|ACCA|ASIA)[0-9A-Z]{16}`,
		),
		Description: "AWS Access Key ID",
	},
	{
		Type: SecretTypeAWSSecret,
		Pattern: regexp.MustCompile(
			`(?i)aws_?secret_?access_?key\s*[=:]\s*['"]?([A-Za-z0-9/+=]{40})['"]?`,
		),
		Description: "AWS Secret Access Key",
	},
	{
		Type: SecretTypeAWSKey,
		Pattern: regexp.MustCompile(
			`(?i)aws_?session_?token\s*[=:]\s*['"]?([A-Za-z0-9/+=]{100,})['"]?`,
		),
		Description: "AWS Session Token",
	},

	// ==================== GCP ====================
	{
		Type:        SecretTypeGCPKey,
		Pattern:     regexp.MustCompile(`(?i)("type"\s*:\s*"service_account")`),
		Description: "GCP Service Account JSON",
	},
	{
		Type:        SecretTypeGCPKey,
		Pattern:     regexp.MustCompile(`(?i)AIza[0-9A-Za-z\-_]{35}`),
		Description: "Google API Key",
	},
	{
		Type: SecretTypeGCPKey,
		Pattern: regexp.MustCompile(
			`(?i)[0-9]+-[0-9A-Za-z_]{32}\.apps\.googleusercontent\.com`,
		),
		Description: "Google OAuth Client ID",
	},

	// ==================== Azure ====================
	{
		Type: SecretTypeAzureKey,
		Pattern: regexp.MustCompile(
			`(?i)DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/=]{88}`,
		),
		Description: "Azure Storage Account Key",
	},
	{
		Type: SecretTypeAzureKey,
		Pattern: regexp.MustCompile(
			`(?i)azure[_-]?(storage[_-]?)?ke
```

---

## File Overview

# secrets.go

## Purpose and Responsibility
This Go source file defines a set of regular expression patterns to identify various types of secrets within codebases. It is part of the `rules` package, which provides utilities for detecting potential security vulnerabilities related to secret management.

## Key Exports and Public Interface
The primary export is the `SecretPattern` struct, which contains metadata about different types of secrets (e.g., AWS keys, GCP keys, GitHub tokens) along with their corresponding regular expression patterns. This allows for systematic identification and handling of sensitive information during code reviews or security scans.

## Fit in the Project
This file fits into the larger `docksec` project by providing a comprehensive list of secret types and their detection mechanisms. It is used to automate the process of identifying secrets within source code, helping developers and security teams ensure that sensitive data is not exposed unintentionally.

## Notable Design Decisions
- **Regular Expressions**: The use of regular expressions for pattern matching ensures high accuracy in detecting specific types of secrets.
- **Enum-like Structs**: `SecretType` uses a struct with constants to represent different secret types, providing clear and maintainable code.
- **Comprehensive Coverage**: The file includes a wide range of common secret types from various services (AWS, GCP, Azure, GitHub, GitLab, Slack, Stripe, etc.), ensuring broad applicability across different projects.

This design ensures that the tool can effectively identify and categorize secrets, aiding in secure software development practices.

---

*Generated by CodeWorm on 2026-02-20 20:31*
