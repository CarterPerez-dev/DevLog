# sarif

**Type:** File Overview
**Repository:** docksec
**File:** internal/report/sarif.go
**Language:** go
**Lines:** 1-318
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
sarif.go
*/

package report

import (
	"crypto/sha256"
	"encoding/hex"
	"encoding/json"
	"fmt"
	"io"
	"time"

	"github.com/CarterPerez-dev/docksec/internal/config"
	"github.com/CarterPerez-dev/docksec/internal/finding"
)

type SARIFReporter struct {
	w      io.Writer
	closer func() error
}

type sarifReport struct {
	Schema  string     `json:"$schema"`
	Version string     `json:"version"`
	Runs    []sarifRun `json:"runs"`
}

type sarifRun struct {
	Tool        sarifTool         `json:"tool"`
	Results     []sarifResult     `json:"results"`
	Invocations []sarifInvocation `json:"invocations,omitempty"`
}

type sarifTool struct {
	Driver sarifDriver `json:"driver"`
}

type sarifDriver struct {
	Name           string      `json:"name"`
	Version        string      `json:"version"`
	InformationURI string      `json:"informationUri"`
	Rules          []sarifRule `json:"rules"`
}

type sarifRule struct {
	ID               string              `json:"id"`
	Name             string              `json:"name"`
	ShortDescription sarifMessage        `json:"shortDescription"`
	FullDescription  sarifMessage        `json:"fullDescription,omitempty"`
	Help             sarifMessage        `json:"help,omitempty"`
	HelpURI          string              `json:"helpUri,omitempty"`
	DefaultConfig    sarifDefaultConfig  `json:"defaultConfiguration"`
	Properties       sarifRuleProperties `json:"properties,omitempty"`
}

type sarifDefaultConfig struct {
	Level string `json:"level"`
}

type sarifRuleProperties struct {
	Tags             []string `json:"tags,omitempty"`
	SecuritySeverity string   `json:"security-severity,omitempty"`
}

type sarifMessage struct {
	Text string `json:"text"`
}

type sarifResult struct {
	RuleID              string                `json:"ruleId"`
	RuleIndex           int                   `json:"ruleIndex"`
	Level               string                `json:"level"`
	Message             sarifMessage          `json:"message"`
	Locations           []sarifLocation       `json:"locations,omitempty"`
	PartialFingerprints map[string]string     `json:"partialFingerprints,omitempty"`
	Properties          sarifResultProperties `json:"properties,omitempty"`
}

type sarifResultProperties struct {
	SecuritySeverity string `json:"security-severity,omitempty"`
}

type sarifLocation struct {
	PhysicalLocation sarifPhysicalLocation `json:"physicalLocation"`
}

type sarifPhysicalLocation struct {
	ArtifactLocation sarifArtifactLocation `json:"artifactLocation"`
	Region           *sarifRegion          `json:"region,omitempty"`
}

type sarifArtifactLocation struct {
	URI string `json:"uri"`
}

type sarifRegion struct {
	StartLine   int `json:"startLine,omitempty"`
	StartColumn int `json:"startColumn,omitempty"`
}

type sarifInvocation struct {
	ExecutionSuccessful bool   `json:"executionSuccessful"`
	EndTimeUTC          string `json:"endTimeUtc"`
}

func (r *SARIFReporter) Report(findings finding.Collection) error {
	defer func() {
		if r.closer != nil
```

---

## File Overview

### sarif.go

**Purpose and Responsibility:**
This file is responsible for generating SARIF (Static Analysis Results Interchange Format) reports, which are used to export security findings from the `docksec` tool into a standardized format. The generated report includes details such as rule IDs, descriptions, severities, and locations of vulnerabilities.

**Key Exports and Public API:**
- `SARIFReporter`: A struct responsible for creating SARIF reports.
- `Report(findings finding.Collection) error`: The public method that generates the SARIF report based on a collection of findings.

**How It Fits into the Project:**
`sarif.go` is part of the reporting module in `docksec`, which handles the export of security analysis results. It integrates with other modules like `finding` to gather and format findings, then outputs them as SARIF reports for integration with static analysis tools and platforms.

**Notable Design Decisions:**
- **Error Handling**: The `Report` method returns an error to handle any issues during report generation.
- **JSON Encoding**: Uses Go's standard JSON encoding library to serialize the SARIF report, ensuring structured and human-readable output.
- **Rule Aggregation**: Implements a mechanism to aggregate rules efficiently, limiting the number of rule entries in the report to avoid bloat.
- **Security Severity Mapping**: Maps severity levels from `finding` to appropriate SARIF security severities, providing consistent categorization.

This design ensures that the generated reports are both comprehensive and compliant with the SARIF specification, facilitating seamless integration into various static analysis workflows.

---

*Generated by CodeWorm on 2026-02-20 19:32*
