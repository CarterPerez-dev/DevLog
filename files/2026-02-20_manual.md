# manual

**Type:** File Overview
**Repository:** stripe-referral
**File:** src/stripe_referral/adapters/manual.py
**Language:** python
**Lines:** 1-91
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025 | CertGames.com
Manual payout adapter for bank transfers
"""

from typing import Any

from ..config.constants import (
    MANUAL_PAYOUT_ID_PREFIX,
)
from ..schemas.types import (
    PayoutResult,
    RecipientValidation,
)
from .base import PayoutAdapter


class ManualBankAdapter(PayoutAdapter):
    """
    Manual bank transfer adapter for admin processed payouts
    """
    def send_payout(
        self,
        user_id: str,
        amount: float,
        _currency: str,
        _recipient_data: dict[str,
                              Any],
    ) -> PayoutResult:
        """
        Mark payout as pending manual review and processing
        """
        transaction_id = f"{MANUAL_PAYOUT_ID_PREFIX}{user_id}_{int(amount * 100)}"

        return PayoutResult(
            success = True,
            transaction_id = transaction_id,
        )

    def validate_recipient(
        self,
        recipient_data: dict[str,
                             Any]
    ) -> RecipientValidation:
        """
        Validate bank account information is present
        """
        required_fields = [
            "bank_account_number",
            "routing_number",
            "account_holder_name",
        ]

        missing_fields = [
            field for field in required_fields
            if field not in recipient_data
        ]

        if missing_fields:
            return RecipientValidation(
                valid = False,
                error =
                f"Missing required fields: {', '.join(missing_fields)}",
            )

        account_number = recipient_data.get("bank_account_number", "")
        if not account_number or len(account_number) < 4:
            return RecipientValidation(
                valid = False,
                error = "Invalid bank account number",
            )

        routing_number = recipient_data.get("routing_number", "")
        if not routing_number or len(routing_number) != 9:
            return RecipientValidation(
                valid = False,
                error = "Invalid routing number (must be 9 digits)",
            )

        account_holder_name = recipient_data.get(
            "account_holder_name",
            ""
        )
        if not account_holder_name or len(account_holder_name) < 2:
            return RecipientValidation(
                valid = False,
                error = "Invalid account holder name",
            )

        return RecipientValidation(valid = True)

```

---

## File Overview

### ManualBankAdapter Documentation

**Purpose:**
The `ManualBankAdapter` class is responsible for handling manual bank transfer payouts, typically processed by an administrator. It ensures that all necessary information is validated before marking a payout as pending.

**Key Exports and Public API:**
- **send_payout(user_id: str, amount: float, _currency: str, _recipient_data: dict[str, Any]) -> PayoutResult:** Marks the payout as pending for manual review.
- **validate_recipient(recipient_data: dict[str, Any]) -> RecipientValidation:** Validates bank account information to ensure it meets required criteria.

**Project Integration:**
This adapter fits into the larger `stripe-referral` project by providing a specific implementation for manual payouts. It extends the base `PayoutAdapter` class and is used when payouts need to be manually reviewed or processed outside of automated systems.

**Design Decisions:**
- **Type Hints:** Utilizes Pythonic type hints (`typing.Any`) to ensure code clarity and maintainability.
- **Validation Logic:** Implements detailed validation logic for bank account information, ensuring that all required fields are present and correct. This helps prevent errors in manual payouts.
- **Transaction ID Generation:** Generates a unique transaction ID prefixed with `MANUAL_PAYOUT_ID_PREFIX` to track each payout accurately.
```

This documentation provides an overview of the file's purpose, key methods, integration within the project, and notable design choices.

---

*Generated by CodeWorm on 2026-02-20 11:00*
