# terminal

**Type:** File Overview
**Repository:** docksec
**File:** internal/report/terminal.go
**Language:** go
**Lines:** 1-264
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
terminal.go
*/

package report

import (
	"fmt"
	"io"
	"sort"
	"strings"

	"github.com/CarterPerez-dev/docksec/internal/finding"
)

const (
	colorReset   = "\033[0m"
	colorBold    = "\033[1m"
	colorRed     = "\033[31m"
	colorGreen   = "\033[32m"
	colorYellow  = "\033[33m"
	colorBlue    = "\033[34m"
	colorMagenta = "\033[35m"
	colorCyan    = "\033[36m"
	colorWhite   = "\033[37m"
	colorGray    = "\033[90m"
)

type TerminalReporter struct {
	w       io.Writer
	closer  func() error
	colored bool
}

func (r *TerminalReporter) Report(findings finding.Collection) error {
	defer func() {
		if r.closer != nil {
			_ = r.closer()
		}
	}()

	if len(findings) == 0 {
		r.printLine(colorGreen, "No security issues found.")
		return nil
	}

	r.printHeader(findings)
	r.printFindings(findings)
	r.printSummary(findings)

	return nil
}

func (r *TerminalReporter) printHeader(findings finding.Collection) {
	r.printLine(colorBold, "")
	r.printLine(colorBold, "Security Scan Results")
	r.printLine(colorBold, strings.Repeat("=", 60))
	_, _ = fmt.Fprintln(r.w)
}

func (r *TerminalReporter) printFindings(findings finding.Collection) {
	grouped := r.groupByCategory(findings)

	categories := make([]string, 0, len(grouped))
	for cat := range grouped {
		categories = append(categories, cat)
	}
	sort.Strings(categories)

	for _, category := range categories {
		catFindings := grouped[category]
		r.printCategory(category, catFindings)
	}
}

func (r *TerminalReporter) printCategory(
	category string,
	findings finding.Collection,
) {
	r.printLine(colorBold+colorCyan, "[ "+category+" ]")
	_, _ = fmt.Fprintln(r.w)

	sorted := r.sortBySeverity(findings)

	for _, f := range sorted {
		r.printFinding(f)
	}

	_, _ = fmt.Fprintln(r.w)
}

func (r *TerminalReporter) printFinding(f *finding.Finding) {
	sevColor := r.severityColor(f.Severity)
	sevLabel := fmt.Sprintf("[%-8s]", f.Severity.String())

	r.print(sevColor, sevLabel)
	r.print(colorWhite, " ")
	r.print(colorBold, f.Title)
	_, _ = fmt.Fprintln(r.w)

	r.print(colorGray, "           ")
	r.print(colorGray, "Target: ")
	r.printLine(colorWhite, f.Target.String())

	if f.Location != nil {
		r.print(colorGray, "           ")
		r.print(colorGray, "Location: ")
		r.printLine(colorWhite, f.Location.String())
	}

	if f.Description != "" {
		r.print(colorGray, "           ")
		wrapped := r.wrapText(f.Description, 60)
		for i, line := range wrapped {
			if i > 0 {
				r.print(colorGray, "           ")
			}
			r.printLine(colorGray, line)
		}
	}

	if f.Remediation != "" {
		r.print(colorGray, "           ")
		r.print(colorGreen, "Fix: ")
		wrapped := r.wrapText(f.Remediation, 55)
		for i, line := range wrapped {
			if i > 0 {
				r.print(colorGray, "                ")
			}
			r.printLine(colorWhite, line)
		}
	}

	if f.CISControl != nil {
		r.print(colorGray, "           ")
		r.print(colorBlue, "CIS: ")
		r.printLine(colorWhite, f.CISControl.ID+" - "+f.CISControl.Title)
	}

	_, _ = fmt.Fprintln(r.w)
}

func (r *TerminalReporte
```

---

## File Overview

# terminal.go

## Purpose and Responsibility
This Go source file implements a `TerminalReporter` struct responsible for generating human-readable security scan results directly to the terminal. It handles the formatting, categorization, and display of findings from a `finding.Collection`.

## Key Exports and Public Interface
- **`TerminalReporter`**: A reporter that writes findings to an `io.Writer`, supporting colored output.
  - Methods:
    - `Report(findings finding.Collection) error`: Reports security scan results.
    - `printHeader(findings finding.Collection)`: Prints the header of the report.
    - `printFindings(findings finding.Collection)`: Groups and prints findings by category.
    - `printCategory(category string, findings finding.Collection)`: Prints a single category's findings.
    - `printFinding(finding *finding.Finding)`: Prints details of an individual finding.
    - `printSummary(findings finding.Collection)`: Prints the summary section.

## How It Fits into the Project
This file is part of the `report` package, which provides various reporting mechanisms for security scan results. The `TerminalReporter` is one such mechanism that outputs findings directly to the terminal in a structured and readable format. It integrates with other components like `finding.Collection`, which stores and manages finding data.

## Notable Design Decisions
- **Colored Output**: Uses ANSI escape codes for colored text, enhancing readability.
- **Structured Grouping**: Finds are categorized by severity and displayed in a structured manner.
- **Error Handling**: Defers closing of resources to ensure proper cleanup.
- **Custom Sorting and Formatting**: Implements custom sorting and formatting functions to present findings logically and clearly.
```

This documentation provides an overview of the file's purpose, key components, integration within the project, and notable design choices.

---

*Generated by CodeWorm on 2026-02-20 19:32*
