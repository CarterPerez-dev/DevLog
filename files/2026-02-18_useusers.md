# useUsers

**Type:** File Overview
**Repository:** Cybersecurity-Projects
**File:** TEMPLATES/fullstack-template/frontend/src/api/hooks/useUsers.ts
**Language:** typescript
**Lines:** 1-139
**Complexity:** 0.0

---

## Source Code

```typescript
// ===================
// © AngelaMos | 2025
// useUsers.ts
// ===================

import {
  type UseMutationResult,
  type UseQueryResult,
  useMutation,
  useQuery,
  useQueryClient,
} from '@tanstack/react-query'
import { toast } from 'sonner'
import {
  isValidUserResponse,
  USER_ERROR_MESSAGES,
  USER_SUCCESS_MESSAGES,
  type UserCreateRequest,
  type UserResponse,
  UserResponseError,
  type UserUpdateRequest,
} from '@/api/types'
import { API_ENDPOINTS, QUERY_KEYS } from '@/config'
import { apiClient, QUERY_STRATEGIES } from '@/core/api'
import { useAuthStore } from '@/core/lib'
import { authQueries } from './useAuth'

export const userQueries = {
  all: () => QUERY_KEYS.USERS.ALL,
  byId: (id: string) => QUERY_KEYS.USERS.BY_ID(id),
  me: () => QUERY_KEYS.USERS.ME(),
} as const

const fetchUserById = async (id: string): Promise<UserResponse> => {
  const response = await apiClient.get<unknown>(API_ENDPOINTS.USERS.BY_ID(id))
  const data: unknown = response.data

  if (!isValidUserResponse(data)) {
    throw new UserResponseError(
      USER_ERROR_MESSAGES.INVALID_USER_RESPONSE,
      API_ENDPOINTS.USERS.BY_ID(id)
    )
  }

  return data
}

export const useUser = (id: string): UseQueryResult<UserResponse, Error> => {
  return useQuery({
    queryKey: userQueries.byId(id),
    queryFn: () => fetchUserById(id),
    enabled: id.length > 0,
    ...QUERY_STRATEGIES.standard,
  })
}

const performRegister = async (
  data: UserCreateRequest
): Promise<UserResponse> => {
  const response = await apiClient.post<unknown>(
    API_ENDPOINTS.USERS.REGISTER,
    data
  )
  const responseData: unknown = response.data

  if (!isValidUserResponse(responseData)) {
    throw new UserResponseError(
      USER_ERROR_MESSAGES.INVALID_USER_RESPONSE,
      API_ENDPOINTS.USERS.REGISTER
    )
  }

  return responseData
}

export const useRegister = (): UseMutationResult<
  UserResponse,
  Error,
  UserCreateRequest
> => {
  return useMutation({
    mutationFn: performRegister,
    onSuccess: (): void => {
      toast.success(USER_SUCCESS_MESSAGES.REGISTERED)
    },
    onError: (error: Error): void => {
      const message =
        error instanceof UserResponseError
          ? error.message
          : USER_ERROR_MESSAGES.FAILED_TO_CREATE
      toast.error(message)
    },
  })
}

const performUpdateProfile = async (
  data: UserUpdateRequest
): Promise<UserResponse> => {
  const response = await apiClient.patch<unknown>(API_ENDPOINTS.USERS.ME, data)
  const responseData: unknown = response.data

  if (!isValidUserResponse(responseData)) {
    throw new UserResponseError(
      USER_ERROR_MESSAGES.INVALID_USER_RESPONSE,
      API_ENDPOINTS.USERS.ME
    )
  }

  return responseData
}

export const useUpdateProfile = (): UseMutationResult<
  UserResponse,
  Error,
  UserUpdateRequest
> => {
  const queryClient = useQueryClient()
  const updateUser = useAuthStore((s) => s.updateUser)

  return useMutation({
    mutationFn: performUpdateProfile,
    onSuccess: (d
```

---

## File Overview

# useUsers.ts Documentation

**Purpose and Responsibility:**
This file provides hooks for managing user data within a React application, leveraging `@tanstack/react-query` for state management and `sonner` for notifications. It includes functionality to fetch users by ID, register new users, and update the current user's profile.

**Key Exports or Public Interface:**
- `useUser`: A hook to fetch a specific user by their ID.
- `useRegister`: A mutation hook to handle user registration.
- `useUpdateProfile`: A mutation hook to update the currently authenticated user’s profile.

**How it Fits in the Project:**
This file is part of the API hooks module, which provides reusable logic for interacting with the backend. It integrates closely with authentication and query management modules (`useAuthStore` and `authQueries`). The hooks are used throughout the application where user data needs to be fetched or modified.

**Notable Design Decisions:**
- **Error Handling:** Uses a custom error class `UserResponseError` for consistent error handling.
- **Query Keys:** Utilizes constants from `QUERY_KEYS` for query keys, ensuring consistency and reducing magic strings.
- **Toast Notifications:** Provides feedback to the user through `sonner`, enhancing the user experience by informing them of successful or failed operations.
- **API Client Integration:** Leverages an API client (`apiClient`) for making HTTP requests, promoting code reusability and maintainability.
```

This documentation provides a high-level overview of the file's purpose, its key exports, how it integrates with other parts of the project, and some notable design decisions.

---

*Generated by CodeWorm on 2026-02-18 13:31*
