# controls

**Type:** File Overview
**Repository:** docksec
**File:** internal/benchmark/controls.go
**Language:** go
**Lines:** 1-1694
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
controls.go
*/

package benchmark

import "github.com/CarterPerez-dev/docksec/internal/finding"

// Control represents a CIS Docker Benchmark control with its metadata,
// including severity level, remediation guidance, and references.
type Control struct {
	ID          string
	Section     string
	Title       string
	Description string
	Remediation string
	Severity    finding.Severity
	Scored      bool
	Level       int
	References  []string
}

// ToCISControl converts this Control to a finding.CISControl for embedding
// in security findings.
func (c Control) ToCISControl() *finding.CISControl {
	return &finding.CISControl{
		ID:          c.ID,
		Section:     c.Section,
		Title:       c.Title,
		Description: c.Description,
		Scored:      c.Scored,
		Level:       c.Level,
	}
}

var controlRegistry = make(map[string]Control)

// Register adds a CIS control to the global registry, keyed by control ID.
func Register(c Control) {
	controlRegistry[c.ID] = c
}

// Get retrieves a control from the registry by its ID.
// Returns the control and true if found, or zero value and false if not.
func Get(id string) (Control, bool) {
	c, ok := controlRegistry[id]
	return c, ok
}

// All returns a slice of all registered CIS controls.
func All() []Control {
	controls := make([]Control, 0, len(controlRegistry))
	for _, c := range controlRegistry {
		controls = append(controls, c)
	}
	return controls
}

// BySection returns all controls belonging to the specified CIS section.
func BySection(section string) []Control {
	var controls []Control
	for _, c := range controlRegistry {
		if c.Section == section {
			controls = append(controls, c)
		}
	}
	return controls
}

func init() {
	registerHostControls()
	registerDaemonControls()
	registerDaemonFilesControls()
	registerImageControls()
	registerContainerRuntimeControls()
	registerSecurityOperationsControls()
	registerSwarmControls()
}

func registerHostControls() {
	Register(Control{
		ID:          "1.1.1",
		Section:     "Host Configuration",
		Title:       "Ensure a separate partition for containers has been created",
		Severity:    finding.SeverityMedium,
		Description: "All Docker containers and their data and metadata are stored under /var/lib/docker directory. By default, this directory is stored on the same partition as the root filesystem. A separate partition provides isolation and prevents DoS attacks from filling up the host filesystem.",
		Remediation: "Create a separate partition for /var/lib/docker. Use LVM or partition management tools during system installation or configuration.",
		Scored:      true,
		Level:       1,
		References:  []string{"https://docs.docker.com/storage/"},
	})

	Register(Control{
		ID:          "1.1.2",
		Section:     "Host Configuration",
		Title:       "Ensure only trusted users are allowed to control Docker daemon",
		Severity:    finding.SeverityHigh,
		Description: "The Docker daemon runs as root and provides root-equivalent access to the host. Only trus
```

---

## File Overview

### controls.go

**Purpose and Responsibility:**
This Go source file is responsible for managing and registering CIS Docker Benchmark controls within the `benchmark` package of the `docksec` project. It defines a `Control` struct to represent individual benchmark controls, provides methods to register, retrieve, and list these controls, and categorizes them by sections.

**Key Exports and Public Interface:**
- **Structs:** `Control`
- **Functions:**
  - `Register(c Control)`: Registers a control in the global registry.
  - `Get(id string) (Control, bool)`: Retrieves a control by its ID.
  - `All() []Control`: Returns all registered controls.
  - `BySection(section string) []Control`: Filters controls by section.

**How it Fits into the Project:**
This file serves as a central registry for benchmark controls, facilitating their management and retrieval. It integrates with other components of the project, such as security findings, to ensure that relevant controls are embedded correctly in security assessments.

**Notable Design Decisions:**
- **Global Registry:** The `controlRegistry` map stores all registered controls globally, allowing easy access and updates.
- **Error Handling:** While not explicitly shown, error handling is expected for robustness, especially during registration and retrieval operations.
- **Initialization Functions:** `init()` functions are used to register predefined controls, ensuring they are available at the start of the application.
- **Categorization:** Controls are categorized by sections (e.g., "Host Configuration"), making it easier to organize and filter them based on specific criteria.

---

*Generated by CodeWorm on 2026-02-20 19:13*
