# scoring

**Type:** File Overview
**Repository:** CodeWorm
**File:** codeworm/analysis/scoring.py
**Language:** python
**Lines:** 1-310
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2026
analysis/scoring.py
"""
from __future__ import annotations

import contextlib
from dataclasses import dataclass
from datetime import datetime, timedelta
from pathlib import Path

from typing import TYPE_CHECKING, ClassVar

from codeworm.analysis.complexity import ComplexityMetrics

if TYPE_CHECKING:
    from git import Repo


@dataclass
class GitStats:
    """
    Git derived statistics for a file or function
    """
    commit_count_30d: int = 0
    commit_count_90d: int = 0
    last_modified: datetime | None = None
    unique_authors: int = 0
    is_new: bool = False

    @property
    def days_since_modified(self) -> int:
        """
        Days since last modification
        """
        if not self.last_modified:
            return 999
        delta = datetime.now() - self.last_modified
        return delta.days

    @property
    def is_hot(self) -> bool:
        """
        Check if this is a frequently modified hotspot
        """
        return self.commit_count_30d >= 3

    @property
    def is_recent(self) -> bool:
        """
        Check if modified in last 30 days
        """
        return self.days_since_modified <= 30


@dataclass
class InterestScore:
    """
    Computed interest score with breakdown
    """
    total: float
    complexity_score: float
    length_score: float
    nesting_score: float
    parameter_score: float
    churn_score: float
    novelty_score: float
    pattern_bonus: float = 0.0

    @property
    def rating(self) -> str:
        """
        Human readable interest rating
        """
        if self.total >= 70:
            return "highly_interesting"
        if self.total >= 50:
            return "interesting"
        if self.total >= 30:
            return "moderate"
        return "low"

    def to_dict(self) -> dict:
        """
        Convert to dictionary for logging
        """
        return {
            "total": round(self.total,
                           2),
            "complexity": round(self.complexity_score,
                                2),
            "length": round(self.length_score,
                            2),
            "nesting": round(self.nesting_score,
                             2),
            "parameters": round(self.parameter_score,
                                2),
            "churn": round(self.churn_score,
                           2),
            "novelty": round(self.novelty_score,
                             2),
            "pattern_bonus": round(self.pattern_bonus,
                                   2),
            "rating": self.rating,
        }


class InterestScorer:
    """
    Scores code snippets based on how interesting they are to document
    Uses weighted factors normalized to 0-100 scale
    """
    WEIGHTS: ClassVar[dict[str,
                           float]] = {
                               "complexity": 0.35,
                               "length": 0.15,
                               "nesting": 0.15,
       
```

---

## File Overview

### Purpose and Responsibility

This Python source file, `scoring.py`, is responsible for calculating an interest score for code snippets based on their complexity, length, nesting depth, parameter count, churn rate, and novelty. It integrates with Git statistics to assess the activity around a piece of code.

### Key Exports and Public Interface

- **Data Classes:**
  - `GitStats`: Represents derived Git statistics such as commit counts over different time periods, days since last modification, unique authors, and whether the file is new.
  - `InterestScore`: Computes an interest score with breakdowns for complexity, length, nesting, parameters, churn, novelty, and a pattern bonus.

- **Class:**
  - `InterestScorer`: A class that scores code snippets based on predefined weights. It takes into account Git statistics, decorators, async functions, context managers, and other patterns to provide an overall interest rating.

### How it Fits in the Project

This file is part of the `codeworm` project's analysis module, specifically for assessing the importance of different code segments during documentation. The `InterestScorer` class leverages Git statistics and complexity metrics to prioritize which parts of the codebase should be documented first.

### Notable Design Decisions

- **Weighted Scoring:** Uses a weighted scoring system where each factor (complexity, length, nesting, parameters, churn, novelty) is normalized to a 0-100 scale.
- **Pattern Bonuses:** Provides additional points for specific coding patterns like decorators, async functions, context managers, and more.
- **Context Manager Usage:** Utilizes `@dataclass` for concise data class definitions and `contextlib.contextmanager` for handling pattern bonuses.
- **Type Hints and Annotations:** Extensive use of type hints and annotations to ensure clarity and maintainability.

---

*Generated by CodeWorm on 2026-02-21 07:51*
