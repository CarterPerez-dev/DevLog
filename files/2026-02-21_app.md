# app

**Type:** File Overview
**Repository:** CodeWorm
**File:** dashboard/backend/app.py
**Language:** python
**Lines:** 1-57
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2026
dashboard/backend/app.py
"""
from __future__ import annotations

from collections.abc import AsyncIterator
from contextlib import asynccontextmanager
from pathlib import Path

from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse
from fastapi.staticfiles import StaticFiles

from dashboard.backend.api import router as api_router
from dashboard.backend.ws import (
    router as ws_router,
    start_redis_subscriber,
    stop_redis_subscriber,
)


@asynccontextmanager
async def lifespan(app: FastAPI) -> AsyncIterator[None]:
    await start_redis_subscriber()
    yield
    await stop_redis_subscriber()


app = FastAPI(
    title="CodeWorm Dashboard",
    version="1.0.2",
    lifespan=lifespan,
)

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

app.include_router(api_router, prefix="")
app.include_router(ws_router, prefix="")


@app.get("/health")
async def health() -> JSONResponse:
    return JSONResponse({"status": "healthy"})


static_dir = Path(__file__).parent.parent / "frontend" / "dist"
if static_dir.exists():
    app.mount("/", StaticFiles(directory=str(static_dir), html=True), name="static")

```

---

## File Overview

### Purpose and Responsibility

This file, `app.py`, serves as the entry point for the backend API of the CodeWorm Dashboard application. It initializes a FastAPI instance, sets up middleware, includes routers, and handles static files.

### Key Exports and Public Interface

- **FastAPI Application (`app`)**: The main FastAPI instance that manages routes and middlewares.
- **Lifespan Manager**: A context manager for starting and stopping the Redis subscriber during application startup and shutdown.
- **Routers**:
  - `api_router`: Handles API endpoints.
  - `ws_router`: Manages WebSocket connections.

### How It Fits into the Project

`app.py` acts as the central hub, integrating various components of the backend. It includes routers for handling HTTP requests and WebSockets, sets up CORS middleware to allow cross-origin access, and mounts a static file directory from the frontend build.

### Notable Design Decisions

- **Async Context Manager**: The `lifespan` context manager ensures that the Redis subscriber is properly started and stopped at application startup and shutdown.
- **Static File Mounting**: Dynamically checks for the existence of the frontend static files before mounting them, ensuring smooth development and deployment processes.
- **CORS Configuration**: Permissive CORS settings allow any origin to access the API, facilitating easier testing and development.
```

This documentation provides a high-level overview of the file's role within the project, its key components, and important design choices.

---

*Generated by CodeWorm on 2026-02-21 09:01*
