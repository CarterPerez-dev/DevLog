# email

**Type:** File Overview
**Repository:** CertGames-Core
**File:** backend/api/core/services/senders/email.py
**Language:** python
**Lines:** 1-305
**Complexity:** 0.0

---

## Source Code

```python
"""
Email Sender Service
/api/core/services/senders/email.py
"""

import resend
from flask import current_app
from settings import Email


class EmailSender:
    """
    A utility class for sending emails through Resend
    with different sender addresses and templates.
    """
    def __init__(
        self,
        resend_api_key: str,
        frontend_url: str,
        admin_url: str | None = None
    ) -> None:
        resend.api_key = resend_api_key

        self.default_addresses: dict[str,
                                     str] = {
                                         "password_reset":
                                         Email.PASSWORD_RESET_SENDER,
                                         "newsletter":
                                         Email.NEWSLETTER_SENDER,
                                         "support": Email.SUPPORT_SENDER,
                                         "admin_invite":
                                         Email.ADMIN_INVITE_SENDER,
                                     }
        self.frontend_url: str = frontend_url
        self.admin_url: str = admin_url or f"{frontend_url}:8080"

    def send_email(
        self,
        to_email: str,
        subject: str,
        html_content: str,
        *,
        email_type: str = "password_reset",
        from_email: str | None = None,
    ) -> bool:
        """
        Send an email using Resend.
        """
        sender: str | None = from_email or self.default_addresses.get(
            email_type
        )

        if not sender:
            sender = Email.DEFAULT_SENDER

        try:
            response = resend.Emails.send(
                {
                    "from":
                    f"CertGames Support <{sender or Email.DEFAULT_SENDER}>",
                    "to": to_email,
                    "subject": subject,
                    "html": html_content,
                    "reply_to": "support@certgames.com",
                    "headers": {
                        "X-Entity-Ref-ID":
                        f"{email_type}-{to_email}",
                        "List-Unsubscribe":
                        "<mailto:support@certgames.com?subject=Unsubscribe>"
                    }
                }
            )

            if response and response.get("id"):
                current_app.logger.info(
                    "Email sent to %s (type: %s, id: %s)",
                    to_email,
                    email_type,
                    response.get('id')
                )
                return True

            current_app.logger.error(
                "Failed to send email: No ID returned"
            )
            return False

        except Exception as e:
            current_app.logger.error(f"Error sending email: {str(e)}")
            return False

    def send_password_reset_email(
        self,
        to_email: str,
        reset_token: str,
        frontend_url: str | None = None
    ) -> bool:
        """
        Send a password r
```

---

## File Overview

Email Sender Service
/api/core/services/senders/email.py

This file implements an email sending service using Resend, a popular email delivery API. It provides utilities for sending emails with different sender addresses and templates.

### Key Exports and Public Interface
- **`EmailSender`**: A utility class for sending emails.
  - `__init__`: Initializes the `EmailSender` instance with necessary configurations.
  - `send_email`: Sends an email using Resend.
  - `send_password_reset_email`: Sends a password reset email.

### How It Fits into the Project
This service is part of the core backend module, responsible for handling email communications. It interacts with the frontend URLs and logging mechanisms to ensure emails are sent correctly and securely.

### Notable Design Decisions
- **Resend API Integration**: Utilizes Resend's API for sending emails, ensuring reliable delivery.
- **Default Senders**: Configures default sender addresses for different types of emails (password reset, newsletter, etc.).
- **Error Handling**: Logs errors and returns a boolean indicating success or failure.
- **Customizable Templates**: Supports custom HTML content for email bodies, allowing flexibility in message design.

This class is crucial for maintaining user communication channels within the CertGames application.

---

*Generated by CodeWorm on 2026-02-19 11:48*
