# fastapi

**Type:** File Overview
**Repository:** Telehook
**File:** src/telehook/adapters/fastapi.py
**Language:** python
**Lines:** 1-32
**Complexity:** 0.0

---

## Source Code

```python
"""
Â©AngelaMos | 2026
fastapi.py
"""

from __future__ import annotations

from typing import TYPE_CHECKING

from telehook.formatters.error import error_formatter
from telehook.notifier import Notifier

if TYPE_CHECKING:
    from fastapi import FastAPI


def telehook_exception_handler(app: FastAPI, notifier: Notifier) -> None:
    from fastapi import Request
    from fastapi.responses import JSONResponse

    @app.exception_handler(Exception)
    async def _handler(request: Request, exc: Exception) -> JSONResponse:
        text = error_formatter(
            exception = exc,
            component = f"{request.method} {request.url.path}",
        )
        await notifier.send(text)
        return JSONResponse(
            status_code = 500,
            content = {"detail": "Internal Server Error"},
        )

```

---

## File Overview

# fastapi.py Documentation

**Purpose and Responsibility:**
This file defines an exception handler for FastAPI applications, integrating error notifications using `telehook`. It ensures that any unhandled exceptions are caught and reported via Telegram.

**Key Exports or Public Interface:**
- `telehook_exception_handler`: A function that registers a global exception handler for FastAPI instances. It takes two parameters: the FastAPI application (`app`) and an instance of `Notifier` (`notifier`). This function is intended to be used as middleware in FastAPI applications.

**How it Fits into the Project:**
This file serves as part of the Telehook project's adapter layer, specifically for integrating with FastAPI. It enhances the application by providing robust error handling and notification capabilities, ensuring that any issues are promptly reported via Telegram notifications.

**Notable Design Decisions:**
- The use of `@app.exception_handler` decorator to register a global exception handler.
- Integration with `telehook.formatters.error.error_formatter` for structured error reporting.
- Dependency injection through the `Notifier` instance, allowing flexibility in how errors are notified (e.g., Telegram).
```

This documentation provides an overview of the file's role within the project and highlights its key components and design choices.

---

*Generated by CodeWorm on 2026-03-01 09:20*
