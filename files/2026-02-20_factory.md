# factory

**Type:** File Overview
**Repository:** my-portfolio
**File:** v1/backend/app/factory.py
**Language:** python
**Lines:** 1-167
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025
factory.py
"""

from collections.abc import AsyncIterator
from contextlib import asynccontextmanager

from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse
from slowapi import _rate_limit_exceeded_handler
from slowapi.errors import RateLimitExceeded
from fastapi_rc import cachemanager

import config
from config import settings
from core.database import sessionmanager
from core.exceptions import BaseAppException
from core.logging import configure_logging
from core.rate_limit import limiter
from middleware.correlation import CorrelationIdMiddleware
from core.common_schemas import AppInfoResponse
from core.health_routes import router as health_router
from user.routes import router as user_router
from auth.routes import router as auth_router
from admin.routes import router as admin_router
from project.routes import router as project_router
from experience.routes import router as experience_router
from certification.routes import router as certification_router
from blog.routes import router as blog_router
from search.routes import router as search_router
from it_was_never_real import register_psyop_handler


@asynccontextmanager
async def lifespan(app: FastAPI) -> AsyncIterator[None]:
    """
    Application lifespan handler for startup and shutdown
    """
    configure_logging()
    sessionmanager.init(str(settings.DATABASE_URL))
    if settings.REDIS_URL:
        cachemanager.init(str(settings.REDIS_URL))
    yield
    if cachemanager.is_available:
        await cachemanager.close()
    await sessionmanager.close()


OPENAPI_TAGS = [
    {
        "name": "root",
        "description": "API information"
    },
    {
        "name": "health",
        "description": "Health check endpoints"
    },
    {
        "name": "projects",
        "description": "Portfolio projects"
    },
    {
        "name": "experiences",
        "description": "Work experience history"
    },
    {
        "name": "certifications",
        "description": "Professional certifications"
    },
    {
        "name": "blogs",
        "description": "External blog posts"
    },
    {
        "name": "search",
        "description": "Full-text search across portfolio content"
    },
    {
        "name": "auth",
        "description": "Authentication and authorization"
    },
    {
        "name": "users",
        "description": "User registration and profile management"
    },
    {
        "name": "admin",
        "description": "Admin only operations"
    },
]


def create_app() -> FastAPI:
    """
    Application factory
    """
    app = FastAPI(
        title = settings.APP_NAME,
        summary = settings.APP_SUMMARY,
        description = settings.APP_DESCRIPTION,
        version = settings.APP_VERSION,
        contact = {
            "name": settings.APP_CONTACT_NAME,
            "email": settings.APP_CONTACT_EMAIL,
        },
        license_info = {
            "name": 
```

---

## File Overview

### factory.py

**Purpose:**
This file serves as the application factory for initializing and configuring a FastAPI instance, setting up middleware, rate limiting, exception handling, and including various API routers.

**Key Exports & Public Interface:**
- `create_app()`: The main function that returns an initialized FastAPI app.
- `lifespan`: An async context manager to handle application startup and shutdown lifecycle events.

**How it Fits into the Project:**
This file acts as a central point for bootstrapping the API. It initializes essential components like logging, database sessions, rate limiting, and middleware. The created FastAPI instance includes various routers for different functionalities such as health checks, user management, project details, etc., making this file crucial for integrating all parts of the application.

**Notable Design Decisions:**
- **FastAPI Initialization**: Configures the app with metadata like title, version, and tags.
- **Middleware & Exception Handling**: Sets up middleware for correlation IDs and CORS policies. Custom exception handlers manage different types of exceptions, ensuring consistent error responses.
- **Rate Limiting**: Utilizes `slowapi` to handle rate limiting across the application.
- **Router Inclusion**: Dynamically includes routers from various modules, allowing modular development and easy extension.
```

This documentation provides a concise overview of the file's role in the project, its key components, and important design choices.

---

*Generated by CodeWorm on 2026-02-20 07:51*
