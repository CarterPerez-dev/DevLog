# paths

**Type:** File Overview
**Repository:** docksec
**File:** internal/rules/paths.go
**Language:** go
**Lines:** 1-1162
**Complexity:** 0.0

---

## Source Code

```go
/*
AngelaMos | 2025
paths.go
*/

package rules

import (
	"strings"

	"github.com/CarterPerez-dev/docksec/internal/finding"
)

type PathInfo struct {
	Severity    finding.Severity
	Description string
}

var DockerSocketPaths = map[string]PathInfo{
	// Docker sockets
	"/var/run/docker.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Docker daemon socket. Full control over Docker, container escape possible.",
	},
	"/run/docker.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Docker daemon socket (alternate path). Full control over Docker.",
	},
	"/var/run/docker": {
		Severity:    finding.SeverityCritical,
		Description: "Docker runtime directory. May contain socket or sensitive data.",
	},
	"/run/docker": {
		Severity:    finding.SeverityCritical,
		Description: "Docker runtime directory (alternate path).",
	},

	// Containerd sockets
	"/var/run/containerd/containerd.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Containerd socket. Direct container runtime access.",
	},
	"/run/containerd/containerd.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Containerd socket (alternate path).",
	},

	// CRI-O sockets
	"/var/run/crio/crio.sock": {
		Severity:    finding.SeverityCritical,
		Description: "CRI-O socket. Direct container runtime access.",
	},
	"/run/crio/crio.sock": {
		Severity:    finding.SeverityCritical,
		Description: "CRI-O socket (alternate path).",
	},

	// Podman sockets
	"/var/run/podman/podman.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Podman socket. Container management access.",
	},
	"/run/podman/podman.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Podman socket (alternate path).",
	},
	"/var/run/user/1000/podman/podman.sock": {
		Severity:    finding.SeverityCritical,
		Description: "Rootless Podman socket. Container management access.",
	},

	// Additional container runtimes
	"/var/run/cri-dockerd.sock": {
		Severity:    finding.SeverityCritical,
		Description: "CRI-dockerd socket. Docker CRI implementation.",
	},
	"/run/cri-dockerd.sock": {
		Severity:    finding.SeverityCritical,
		Description: "CRI-dockerd socket (alternate path).",
	},
	"/var/run/rkt/api-service.sock": {
		Severity:    finding.SeverityCritical,
		Description: "rkt container runtime socket.",
	},
}

var SensitiveHostPaths = map[string]PathInfo{
	// Root and core system directories
	"/": {
		Severity:    finding.SeverityCritical,
		Description: "Host root filesystem. Complete host access.",
	},

	// System configuration
	"/etc": {
		Severity:    finding.SeverityCritical,
		Description: "Host configuration directory. Contains passwords, keys, configs.",
	},
	"/etc/passwd": {
		Severity:    finding.SeverityHigh,
		Description: "User account information.",
	},
	"/etc/shadow": {
		Severity:    finding.SeverityCritical,
		Description: "Password hashes. Direct credential access.",
	},
	"/etc/group": {
		Severity:    finding.SeverityHigh,
		Description: "Grou
```

---

## File Overview

### paths.go

**Purpose and Responsibility:**
This Go source file defines a set of critical paths that may pose security risks within Docker, containerd, CRI-O, Podman, and Kubernetes environments. It categorizes these paths based on their severity and provides detailed descriptions to help identify potential vulnerabilities.

**Key Exports or Public Interface:**
- `DockerSocketPaths` (map[string]PathInfo): A map containing critical Docker daemon socket paths.
- `SensitiveHostPaths` (map[string]PathInfo): A map containing sensitive host filesystem paths.

**How it Fits in the Project:**
This file is part of the `rules` package within the `docksec` project, which aims to identify and mitigate security risks in containerized environments. It serves as a core component by defining the critical paths that need to be monitored or protected against unauthorized access.

**Notable Design Decisions:**
- **Error Handling:** While not explicitly shown here, this file is designed to integrate with error handling mechanisms common in Go, ensuring robustness.
- **Goroutines and Concurrency:** Although not directly used in this file, the design allows for potential concurrency when scanning these paths using goroutines.
- **Interfaces:** The `PathInfo` struct follows Go idioms by providing a clear interface for describing path information.
- **Dependencies:** It leverages dependencies from the `finding` package to categorize and describe paths accurately.

This file is crucial for identifying and reporting security findings related to critical paths in containerized environments, contributing significantly to the overall security assessment process within the project.

---

*Generated by CodeWorm on 2026-02-20 20:20*
