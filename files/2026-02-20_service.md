# service

**Type:** File Overview
**Repository:** social-media-notes
**File:** backend/app/video/service.py
**Language:** python
**Lines:** 1-205
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025
service.py
"""

from uuid import UUID

from sqlalchemy.ext.asyncio import AsyncSession

from config import Platform
from core.exceptions import NotFoundError
from .VideoEntry import VideoEntry
from .repository import VideoEntryRepository
from .schemas import (
    VideoEntryCreate,
    VideoEntryUpdate,
    VideoEntryResponse,
    VideoEntryListResponse,
)


class VideoEntryService:
    """
    Business logic for video entry operations
    """
    def __init__(self, session: AsyncSession) -> None:
        self.session = session

    async def create_entry(
        self,
        user_id: UUID,
        data: VideoEntryCreate,
    ) -> VideoEntryResponse:
        """
        Create a new video entry
        """
        video_number = data.video_number
        if video_number == 0:
            video_number = await VideoEntryRepository.get_next_video_number(
                self.session,
                user_id,
                data.platform,
            )

        entry = await VideoEntryRepository.create(
            self.session,
            user_id=user_id,
            platform=data.platform,
            video_number=video_number,
            description=data.description,
            youtube_description=data.youtube_description,
            scheduled_time=data.scheduled_time,
        )
        return VideoEntryResponse.model_validate(entry)

    async def get_entry(
        self,
        entry_id: UUID,
        user_id: UUID,
    ) -> VideoEntryResponse:
        """
        Get a video entry by ID
        """
        entry = await VideoEntryRepository.get_by_id_and_user(
            self.session,
            entry_id,
            user_id,
        )
        if not entry:
            raise NotFoundError("Video entry not found")
        return VideoEntryResponse.model_validate(entry)

    async def update_entry(
        self,
        entry_id: UUID,
        user_id: UUID,
        data: VideoEntryUpdate,
    ) -> VideoEntryResponse:
        """
        Update a video entry
        """
        entry = await VideoEntryRepository.get_by_id_and_user(
            self.session,
            entry_id,
            user_id,
        )
        if not entry:
            raise NotFoundError("Video entry not found")

        update_dict = data.model_dump(exclude_unset=True)
        updated = await VideoEntryRepository.update(
            self.session,
            entry,
            **update_dict,
        )
        return VideoEntryResponse.model_validate(updated)

    async def delete_entry(
        self,
        entry_id: UUID,
        user_id: UUID,
    ) -> None:
        """
        Delete a video entry
        """
        entry = await VideoEntryRepository.get_by_id_and_user(
            self.session,
            entry_id,
            user_id,
        )
        if not entry:
            raise NotFoundError("Video entry not found")
        await VideoEntryRepository.delete(self.session, entry)

    async def list_entries(
        self,
     
```

---

## File Overview

### service.py

**Purpose and Responsibility:**
This file contains the business logic for managing video entries within the application. It handles operations such as creating, retrieving, updating, deleting, listing, and copying video entries across different platforms.

**Key Exports and Public Interface:**
- `VideoEntryService`: The primary class responsible for video entry management.
  - `create_entry`: Creates a new video entry.
  - `get_entry`: Retrieves a video entry by ID.
  - `update_entry`: Updates an existing video entry.
  - `delete_entry`: Deletes a video entry.
  - `list_entries`: Lists video entries with optional platform filtering.
  - `copy_to_platform`: Copies a video entry to another platform.

**How it Fits in the Project:**
This service layer sits between the database and the application logic, providing a clean interface for managing video entries. It interacts with the `VideoEntryRepository` to perform CRUD operations and ensures that business rules are enforced.

**Notable Design Decisions:**
- **Dependency Injection**: The `VideoEntryService` constructor accepts an `AsyncSession` object, allowing it to interact with the database.
- **Error Handling**: Uses custom exceptions like `NotFoundError` for clear error signaling.
- **Pagination and Filtering**: Implements pagination and optional platform filtering in the `list_entries` method.
- **Platform-Specific Logic**: Handles platform-specific operations such as YouTube description shortening in the `copy_to_platform` method.

This design ensures that the service layer is modular, testable, and easy to maintain.

---

*Generated by CodeWorm on 2026-02-20 21:34*
