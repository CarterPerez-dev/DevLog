# config

**Type:** File Overview
**Repository:** Yoshi-Audit
**File:** internal/config/config.go
**Language:** go
**Lines:** 1-79
**Complexity:** 0.0

---

## Source Code

```go
// Â©AngelaMos | 2026
// config.go

package config

import (
	"errors"
	"os"
	"path/filepath"

	"gopkg.in/yaml.v3"
)

type PrunePreset struct {
	Name     string   `yaml:"name"`
	Patterns []string `yaml:"patterns"`
}

type Config struct {
	RefreshInterval    int           `yaml:"refresh_interval"`
	ProtectionPatterns []string      `yaml:"protection_patterns"`
	PrunePresets       []PrunePreset `yaml:"prune_presets"`
	BaselinePath       string        `yaml:"baseline_path"`
}

func Default() Config {
	return Config{
		RefreshInterval:    2,
		ProtectionPatterns: []string{"*certgames*", "*argos*", "*mongo*"},
		PrunePresets: []PrunePreset{
			{Name: "Dangling Only", Patterns: []string{"dangling"}},
			{Name: "Build Cache", Patterns: []string{"buildcache"}},
		},
		BaselinePath: DefaultBaselinePath(),
	}
}

func configDir() string {
	home, _ := os.UserHomeDir()
	return filepath.Join(home, ".config", "yoshi-audit")
}

func DefaultPath() string {
	return filepath.Join(configDir(), "config.yaml")
}

func DefaultBaselinePath() string {
	return filepath.Join(configDir(), "baseline.json")
}

func Load(path string) (Config, error) {
	data, err := os.ReadFile(path)
	if err != nil {
		if errors.Is(err, os.ErrNotExist) {
			return Default(), nil
		}
		return Config{}, err
	}

	var cfg Config
	if err := yaml.Unmarshal(data, &cfg); err != nil {
		return Config{}, err
	}
	return cfg, nil
}

func (c Config) Save(path string) error {
	if err := os.MkdirAll(filepath.Dir(path), 0o755); err != nil {
		return err
	}

	data, err := yaml.Marshal(c)
	if err != nil {
		return err
	}

	return os.WriteFile(path, data, 0o644)
}

```

---

## File Overview

# config.go

## Purpose and Responsibility
This file defines the configuration management for Yoshi-Audit, handling default configurations, loading from files, and saving to disk. It ensures that the application can read and write its settings, including refresh intervals, protection patterns, pruning presets, and baseline paths.

## Key Exports and Public Interface
- `Default() Config`: Provides a default configuration instance.
- `configDir() string`: Returns the directory for storing configuration files.
- `DefaultPath() string`: Returns the path to the default configuration file.
- `DefaultBaselinePath() string`: Returns the path to the baseline JSON file.
- `Load(path string) (Config, error)`: Loads a configuration from a specified file path.
- `Save(c Config, path string) error`: Saves a configuration to a specified file path.

## How It Fits into the Project
This file is crucial for initializing and managing application settings. The configurations loaded here are used throughout the application to control its behavior, such as how often it refreshes data, which patterns to protect or prune, and where to store baseline data.

## Notable Design Decisions
- **Error Handling**: Uses `os.ErrNotExist` to handle missing configuration files gracefully by returning a default configuration.
- **YAML Parsing**: Utilizes the `yaml.v3` package for parsing and marshaling configurations, ensuring robust handling of complex structures.
- **Directory Management**: Ensures that directories are created with appropriate permissions before saving configurations.
```

This documentation provides an overview of the file's role within the project, its key functions, and important design choices.

---

*Generated by CodeWorm on 2026-03-01 11:40*
