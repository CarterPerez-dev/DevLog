# auth.store

**Type:** File Overview
**Repository:** ios-test
**File:** red-recon/src/core/lib/auth.store.ts
**Language:** typescript
**Lines:** 1-94
**Complexity:** 0.0

---

## Source Code

```typescript
/**
 * @AngelaMos | 2026
 * auth.store.ts
 */

import { type UserResponse, UserRole } from '@/api/types'
import { zustandStorage } from '@/core/storage'
import { create } from 'zustand'
import { createJSONStorage, persist } from 'zustand/middleware'

const YOUR_STORAGE_KEY = 'redrecon-auth'

interface AuthState {
  user: UserResponse | null
  isAuthenticated: boolean
  isLoading: boolean
  hasHydrated: boolean
}

interface AuthActions {
  login: (user: UserResponse) => void
  logout: () => void
  setLoading: (loading: boolean) => void
  updateUser: (updates: Partial<UserResponse>) => void
  setHasHydrated: (hydrated: boolean) => void
}

type AuthStore = AuthState & AuthActions

export const useAuthStore = create<AuthStore>()(
  persist(
    (set) => ({
      user: null,
      isAuthenticated: false,
      isLoading: true,
      hasHydrated: false,

      login: (user) =>
        set({
          user,
          isAuthenticated: true,
          isLoading: false,
        }),

      logout: () =>
        set({
          user: null,
          isAuthenticated: false,
          isLoading: false,
        }),

      setLoading: (loading) => set({ isLoading: loading }),

      updateUser: (updates) =>
        set((state) => ({
          user: state.user !== null ? { ...state.user, ...updates } : null,
        })),

      setHasHydrated: (hydrated) => set({ hasHydrated: hydrated }),
    }),
    {
      name: YOUR_STORAGE_KEY,
      storage: createJSONStorage(() => zustandStorage),
      partialize: (state) =>
        ({
          user: state.user,
          isAuthenticated: state.isAuthenticated,
        }) as AuthStore,
      onRehydrateStorage: () => (state) => {
        state?.setHasHydrated(true)
        state?.setLoading(false)
      },
    }
  )
)

export const useUser = (): UserResponse | null => useAuthStore((s) => s.user)
export const useIsAuthenticated = (): boolean =>
  useAuthStore((s) => s.isAuthenticated)
export const useIsAuthLoading = (): boolean => useAuthStore((s) => s.isLoading)
export const useHasHydrated = (): boolean => useAuthStore((s) => s.hasHydrated)

export const useHasRole = (role: UserRole): boolean => {
  const user = useAuthStore((s) => s.user)
  return user !== null && user.role === role
}

export const useIsAdmin = (): boolean => {
  const user = useAuthStore((s) => s.user)
  return user !== null && user.role === UserRole.ADMIN
}

export { UserRole }

```

---

## File Overview

### auth.store.ts

**Purpose and Responsibility:**
This file manages authentication state using Zustand, a state management library for React applications. It handles user login, logout, and role-based checks, ensuring consistent and persistent authentication across the application.

**Key Exports and Public API:**
- `useAuthStore`: The main store providing access to all auth-related states and actions.
- `useUser`, `useIsAuthenticated`, `useIsAuthLoading`, `useHasHydrated`: Convenience hooks for accessing specific pieces of state.
- `useHasRole` and `useIsAdmin`: Custom hooks for role-based checks.

**How it Fits in the Project:**
This store is a critical component that centralizes authentication logic. It integrates with Zustand's persistent storage to maintain user session data across page reloads, ensuring a seamless user experience.

**Notable Design Decisions:**
- **State Management**: Using `create` from Zustand for state management and `persist` middleware for storing the state in local storage.
- **Partial State Updates**: Implementing partial updates via `set` to avoid unnecessary re-renders.
- **Role-Based Access Control**: Providing specific hooks like `useHasRole` and `useIsAdmin` to enable fine-grained access control based on user roles.

This file ensures that authentication-related logic is encapsulated, making the application more maintainable and easier to extend with new features or changes in authentication requirements.

---

*Generated by CodeWorm on 2026-02-20 16:55*
