# referral

**Type:** File Overview
**Repository:** stripe-referral
**File:** src/stripe_referral/schemas/referral.py
**Language:** python
**Lines:** 1-120
**Complexity:** 0.0

---

## Source Code

```python
"""
ⒸAngelaMos | 2025 | CertGames.com
Pydantic schemas for referral operations
"""

from pydantic import (
    BaseModel,
    Field,
    field_validator,
)
from ..config.constants import (
    MAX_CODE_LENGTH,
    MAX_PROGRAM_KEY_LENGTH,
    MAX_TRANSACTION_ID_LENGTH,
    MAX_USER_ID_LENGTH,
    MIN_PAYOUT_AMOUNT,
)


class CreateCodeRequest(BaseModel):
    """
    Request schema for creating referral code
    """
    user_id: str = Field(
        ...,
        min_length = 1,
        max_length = MAX_USER_ID_LENGTH
    )
    program_key: str = Field(
        ...,
        min_length = 1,
        max_length = MAX_PROGRAM_KEY_LENGTH
    )

    @field_validator("user_id", "program_key")
    @classmethod
    def validate_no_whitespace(cls, v: str) -> str:
        """
        Ensure no leading/trailing whitespace
        """
        return v.strip()


class CreateCodeResponse(BaseModel):
    """
    Response schema for code creation
    """
    code: str
    program_id: int
    user_id: str
    created_at: str


class TrackReferralRequest(BaseModel):
    """
    Request schema for tracking referral conversion
    """
    code: str = Field(..., min_length = 1, max_length = MAX_CODE_LENGTH)
    referred_user_id: str = Field(
        ...,
        min_length = 1,
        max_length = MAX_USER_ID_LENGTH
    )
    transaction_id: str | None = Field(
        None,
        max_length = MAX_TRANSACTION_ID_LENGTH
    )
    transaction_amount: float | None = Field(None, ge = MIN_PAYOUT_AMOUNT)

    @field_validator("code", "referred_user_id")
    @classmethod
    def validate_no_whitespace(cls, v: str) -> str:
        """
        Ensure no leading/trailing whitespace
        """
        return v.strip()


class TrackReferralResponse(BaseModel):
    """
    Response schema for referral tracking
    """
    tracking_id: int
    referrer_user_id: str
    referred_user_id: str
    amount_earned: float
    currency: str
    converted_at: str


class UserEarningsResponse(BaseModel):
    """
    Response schema for user earnings
    """
    total: float
    pending: float
    paid: float


class CodeValidationResponse(BaseModel):
    """
    Response schema for code validation
    """
    valid: bool
    code_id: int | None = None
    program_id: int | None = None
    referrer_user_id: str | None = None
    reason: str | None = None


class ReferralHistoryResponse(BaseModel):
    """
    Response schema for referral history
    """
    referred_user_id: str
    amount_earned: float
    currency: str
    converted_at: str
    payout_status: str

```

---

## File Overview

### Purpose and Responsibility

This Python source file defines Pydantic schemas for handling referral operations within the `stripe-referral` project. It includes request and response models for creating referral codes, tracking referrals, validating codes, and retrieving user earnings and history.

### Key Exports and Public Interface

- **CreateCodeRequest**: Schema for creating a referral code.
- **CreateCodeResponse**: Response schema after successfully creating a referral code.
- **TrackReferralRequest**: Schema for tracking the conversion of a referral.
- **TrackReferralResponse**: Response schema for tracking referrals.
- **UserEarningsResponse**: Response schema for retrieving user earnings details.
- **CodeValidationResponse**: Response schema for validating referral codes.
- **ReferralHistoryResponse**: Response schema for fetching referral history.

### How It Fits in the Project

This file is a crucial component of the `stripe-referral` project, providing standardized data models for various referral-related operations. These schemas ensure data integrity and consistency across different parts of the application, such as API requests and responses.

### Notable Design Decisions

- **Pydantic Validation**: Utilizes Pydantic's validation features to enforce strict input constraints, ensuring that user inputs are validated before processing.
- **Field Validators**: Implements `field_validator` decorators to strip leading/trailing whitespace from certain fields, enhancing data cleanliness.
- **Type Hints and Constants**: Uses type hints and constants defined in the project’s configuration for consistent and maintainable code.

---

*Generated by CodeWorm on 2026-02-20 10:56*
