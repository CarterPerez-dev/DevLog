# calendar

**Type:** File Overview
**Repository:** ios-test
**File:** red-recon/app/(app)/(tabs)/calendar.tsx
**Language:** tsx
**Lines:** 1-378
**Complexity:** 0.0

---

## Source Code

```tsx
/**
 * @AngelaMos | 2026
 * calendar.tsx
 */

import { useCalendarMonth } from '@/api/hooks'
import { type CalendarDay, CyclePhase, PHASE_COLORS } from '@/api/types'
import { PeriodLogSheet } from '@/features/calendar'
import { DottedBackground } from '@/shared/components'
import { haptics } from '@/shared/utils'
import { colors } from '@/theme/tokens'
import { ChevronLeft, ChevronRight } from 'lucide-react-native'
import type React from 'react'
import { useCallback, useMemo, useState } from 'react'
import { ActivityIndicator, Dimensions, Pressable, ScrollView } from 'react-native'
import { SafeAreaView } from 'react-native-safe-area-context'
import { Stack, Text, XStack, YStack } from 'tamagui'

const WEEKDAYS = ['S', 'M', 'T', 'W', 'T', 'F', 'S'] as const
const MONTH_NAMES = [
  'January', 'February', 'March', 'April', 'May', 'June',
  'July', 'August', 'September', 'October', 'November', 'December'
] as const

const { width: SCREEN_WIDTH } = Dimensions.get('window')
const CALENDAR_PADDING = 16
const CELL_GAP = 6
const CELL_SIZE = (SCREEN_WIDTH - (CALENDAR_PADDING * 2) - (CELL_GAP * 6)) / 7

interface CalendarCellData {
  day: CalendarDay | null
  dayNumber: number | null
  isToday: boolean
  dateStr: string | null
}

function getPhaseBackgroundColor(phase: CyclePhase | undefined): string {
  if (!phase) return 'transparent'
  switch (phase) {
    case CyclePhase.MENSTRUAL:
      return 'rgba(220, 38, 38, 0.12)'
    case CyclePhase.FOLLICULAR:
      return 'rgba(236, 72, 153, 0.10)'
    case CyclePhase.OVULATION:
      return 'rgba(245, 158, 11, 0.12)'
    case CyclePhase.LUTEAL:
      return 'rgba(100, 116, 139, 0.10)'
    default:
      return 'transparent'
  }
}

function CalendarDayCell({
  data,
  onPress,
}: {
  data: CalendarCellData
  onPress?: () => void
}): React.ReactElement {
  const { day, dayNumber, isToday } = data

  if (dayNumber === null) {
    return <Stack width={CELL_SIZE} height={CELL_SIZE} />
  }

  const isPeriod = day?.is_period ?? false
  const isPredicted = (day?.is_predicted_period ?? false) && !isPeriod
  const phaseBg = getPhaseBackgroundColor(day?.phase)

  return (
    <Pressable onPress={onPress}>
      <Stack
        width={CELL_SIZE}
        height={CELL_SIZE}
        alignItems="center"
        justifyContent="center"
        borderRadius="$2"
        backgroundColor={isPeriod ? colors.phaseRed.val : phaseBg}
        borderWidth={isToday ? 2 : isPredicted ? 1 : 0}
        borderColor={isToday ? colors.accent.val : isPredicted ? colors.accentBorder.val : 'transparent'}
        borderStyle={isPredicted && !isToday ? 'dashed' : 'solid'}
      >
        <Text
          fontSize={15}
          fontWeight={isToday ? '600' : '400'}
          fontFamily="$body"
          color={isPeriod ? '$white' : isToday ? '$accent' : '$textDefault'}
        >
          {dayNumber}
        </Text>
      </Stack>
    </Pressable>
  )
}

function CalendarGrid({
  days,
  year,
  month,
  onDayPress,
}: {
  days: CalendarDay[]
  year
```

---

## File Overview

### calendar.tsx

**Purpose & Responsibility:**
This file is responsible for rendering a monthly calendar view, integrating with backend hooks to fetch data and displaying it in a user-friendly manner. It handles the layout, styling, and interaction of each day within the calendar grid.

**Key Exports & Public API:**
- `CalendarGrid`: The main component that renders the calendar grid.
  - Props:
    - `days`: Array of `CalendarDay` objects representing days in the month.
    - `year`: Year of the month to display.
    - `month`: Month number (1-based) to display.
    - `onDayPress`: Callback function triggered when a day is pressed.

**How It Fits into the Larger Project:**
This component is part of the calendar feature, which allows users to view and interact with their menstrual cycle data. It integrates with other components like `PeriodLogSheet` for detailed logs and `DottedBackground` for visual styling. The `useCalendarMonth` hook fetches necessary data from the backend.

**Notable Design Decisions:**
- **Layout & Styling**: Utilizes Tamagui for layout and styling, ensuring a consistent look across the application.
- **Date Handling**: Uses JavaScript Date objects to calculate the first day of the month and total days in the month.
- **Phase Coloring**: Dynamically colors cells based on cycle phase using `CyclePhase` enum and corresponding color mappings.
- **Haptics Feedback**: Provides haptic feedback when a day is pressed, enhancing user interaction.
```

This documentation provides an overview of the file's purpose, key components, integration within the project, and significant design choices.

---

*Generated by CodeWorm on 2026-02-20 14:51*
