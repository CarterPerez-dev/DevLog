# stats

**Type:** Performance Analysis
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/network-traffic-analyzer/python/src/netanal/main.py
**Language:** python
**Lines:** 263-315
**Complexity:** 7.0

---

## Source Code

```python
def stats(
    pcap_file: Annotated[
        Path,
        typer.Argument(help="PCAP file to analyze"),
    ],
    bandwidth: Annotated[
        bool,
        typer.Option(
            "--bandwidth",
            "-b",
            help="Show bandwidth statistics",
        ),
    ] = False,
    protocols: Annotated[
        bool,
        typer.Option(
            "--protocols",
            "-p",
            help="Show protocol distribution",
        ),
    ] = False,
    endpoints: Annotated[
        bool,
        typer.Option(
            "--endpoints",
            "-e",
            help="Show endpoint statistics",
        ),
    ] = False,
) -> None:
    """
    [bold green]Display statistics[/bold green] from a PCAP file

    Examples:
        netanal stats traffic.pcap --bandwidth
        netanal stats traffic.pcap --protocols --endpoints
    """
    if not pcap_file.exists():
        print_error(f"File not found: {pcap_file}")
        raise typer.Exit(1)

    stats_result, _ = _analyze_pcap_to_stats(pcap_file)

    print_capture_summary(stats_result)

    if protocols or (not bandwidth and not endpoints):
        print_protocol_table(stats_result)

    if endpoints:
        print_top_talkers(stats_result, limit=20)

    if bandwidth:
        print_bandwidth_stats(stats_result)
```

---

## Performance Analysis

### Performance Analysis

**Time Complexity:** The function has a time complexity of \(O(1)\) for the conditional checks, but the actual processing depends on `_analyze_pcap_to_stats`, which likely involves parsing and analyzing the entire PCAP file. This could be costly if the file is large.

**Space Complexity:** The primary space usage comes from storing `stats_result`. If this function processes a large dataset, it might consume significant memory. Ensure that `printStatsResult` does not hold unnecessary data.

**Bottlenecks:**
- **Redundant Checks:** The conditions for printing different statistics are redundant if only one is enabled.
- **Unclosed Resources:** Ensure `_analyze_pcap_to_stats` properly closes any file handles or resources it opens.

**Optimization Opportunities:**
1. **Conditional Logic Refinement:** Simplify the conditional logic by using a single `if` statement with multiple conditions to avoid redundant checks.
2. **Resource Management:** Use context managers for any file-like objects in `_analyze_pcap_to_stats`.
3. **Caching:** If this function is called frequently, consider caching results if the input PCAP files do not change.

**Resource Usage Concerns:**
- Ensure that all resources are properly closed using `with` statements or context managers.
- Consider implementing a progress bar for long-running operations to provide feedback to the user.

---

*Generated by CodeWorm on 2026-02-28 01:26*
