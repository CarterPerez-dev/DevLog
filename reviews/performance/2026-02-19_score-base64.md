# _score_base64

**Type:** Performance Analysis
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 32-68
**Complexity:** 18.0

---

## Source Code

```python
def _score_base64(data: str) -> float:
    stripped = "".join(data.split())
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0
    if not all(c in BASE64_CHARSET for c in stripped):
        return 0.0
    if len(stripped) % 4 != 0:
        return 0.0

    score = W.B64_BASE
    content = stripped.rstrip("=")

    padding = len(stripped) - len(content)
    if padding <= 2:
        score += W.B64_VALID_PADDING

    if any(c in stripped for c in "+/"):
        score += W.B64_SPECIAL_CHARS

    has_upper = any(c.isupper() for c in content)
    has_lower = any(c.islower() for c in content)
    if has_upper and has_lower:
        score += W.B64_MIXED_CASE
    elif not has_upper and not any(c in stripped for c in "+/="):
        score -= W.B64_NO_SIGNAL_PENALTY

    if len(stripped) >= 8:
        score += W.LONGER_INPUT

    decoded = try_decode(stripped, EncodingFormat.BASE64)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Performance Analysis

### Performance Analysis

**Time Complexity:** O(n), where n is the length of `data`. The function iterates over the string multiple times, but each operation (split, join, in operations) is linear with respect to the input size.

**Space Complexity:** O(1). The space used does not grow with the input size; only a few variables are used regardless of the input length.

**Bottlenecks and Inefficiencies:**
- **Redundant Operations:** The `rstrip("=")` operation is called after checking for padding, which can be moved to before the padding check.
- **Multiple Iterations:** The function performs multiple checks on the same string (e.g., `isupper`, `islower`), which could be optimized by precomputing flags.

**Optimization Opportunities:**
1. **Combine Padding Check and Rstrip:** Move `content = stripped.rstrip("=")` before checking padding.
2. **Precompute Flags:** Compute `has_upper` and `has_lower` once, then use them in the subsequent checks.

```python
def _score_base64(data: str) -> float:
    stripped = "".join(data.split())
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0

    has_upper = any(c.isupper() for c in stripped)
    has_lower = any(c.islower() for c in stripped)

    if not all(c in BASE64_CHARSET for c in stripped):
        return 0.0
    if len(stripped) % 4 != 0:
        return 0.0

    content = stripped.rstrip("=")

    padding = len(stripped) - len(content)
    if padding <= 2:
        score += W.B64_VALID_PADDING

    if any(c in stripped for c in "+/"):
        score += W.B64_SPECIAL_CHARS

    if has_upper and has_lower:
        score += W.B64_MIXED_CASE
    elif not has_upper and not any(c in stripped for c in "+/="):
        score -= W.B64_NO_SIGNAL_PENALTY

    if len(stripped) >= 8:
        score += W.LONGER_INPUT

    decoded = try_decode(content, EncodingFormat.BASE64)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

**Resource Usage Concerns:**
- Ensure `try_decode` and `is_printable_text` are efficient.
- Consider caching results of repeated calls with the same input to avoid redundant computations.

This refactoring reduces redundancy and improves readability while maintaining performance.

---

*Generated by CodeWorm on 2026-02-19 09:41*
