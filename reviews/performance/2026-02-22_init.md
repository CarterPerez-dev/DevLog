# init

**Type:** Performance Analysis
**Repository:** pyproject-setup
**File:** src/pyproject_setup/cli.py
**Language:** python
**Lines:** 62-265
**Complexity:** 21.0

---

## Source Code

```python
def init(
    name: str | None = typer.Option(
        None,
        "--name",
        "-n",
        help = "Project name"
    ),
    description: str | None = typer.Option(
        None,
        "--description",
        "-d",
        help = "Project description"
    ),
    preset: str | None = typer.Option(
        None,
        "--preset",
        "-p",
        help = "Project preset (fastapi-backend, library, cli-tool)",
    ),
    python: str = typer.Option(
        ">=3.12",
        "--python",
        help = "Python version requirement"
    ),
    package_path: str = typer.Option(
        "src",
        "--package-path",
        help = "Package source path"
    ),
    repository: str | None = typer.Option(
        None,
        "--repository",
        "-r",
        help = "Repository URL"
    ),
    homepage: str | None = typer.Option(
        None,
        "--homepage",
        help = "Homepage URL"
    ),
    workflow: bool = typer.Option(
        True,
        "--workflow/--no-workflow",
        help = "Add PyPI workflow"
    ),
    output: Path = typer.Option(
        Path(),
        "--output",
        "-o",
        help = "Output directory"
    ),
    force: bool = typer.Option(
        False,
        "--force",
        "-f",
        help = "Overwrite existing files"
    ),
    yapf: bool = typer.Option(
        False,
        "--yapf/--no-yapf",
        help = "Add .style.yapf config file"
    ),
) -> None:
    """
    [bold green]Initialize[/bold green] a new pyproject.toml with pre-configured tooling.

    Run interactively or pass flags for automation.
    """
    console.print()
    console.print(
        Panel(
            "[bold cyan]pyproject-setup[/bold cyan] - Project Scaffolder",
            border_style = "cyan",
        )
    )
    console.print()

    pyproject_path = output / "pyproject.toml"
    if (
        pyproject_path.exists()
        and not force
        and not Confirm.ask(
            f"[yellow]pyproject.toml already exists at {output}. Overwrite?[/yellow]"
        )
    ):
        console.print("[red]Aborted.[/red]")
        raise typer.Exit(1)

    if name is None:
        name = Prompt.ask(
            "[bold]Project name[/bold]",
            default = output.resolve().name
        )

    if description is None:
        description = Prompt.ask("[bold]Description[/bold]", default = "")

    if preset is None:
        preset_choices = list(PRESETS.keys())
        console.print("\n[bold]Available presets:[/bold]")
        for i, p in enumerate(preset_choices, 1):
            preset_obj = PRESETS[p]
            console.print(
                f"  [cyan]{i}[/cyan]. {p} - {preset_obj.description}"
            )

        while True:
            choice = Prompt.ask(
                "\n[bold]Select preset[/bold]",
                default = "1",
            )
            try:
                idx = int(choice) - 1
                if 0 <= idx < len(preset_choices):
                    preset = preset_choices[idx]
     
```

---

## Performance Analysis

### Performance Analysis

**Time Complexity:** The function `init` has a time complexity of \(O(n)\), where \(n\) is the number of user inputs required. The primary bottleneck lies in the repeated use of `Prompt.ask`, which can be costly due to its interactive nature, especially if multiple prompts are required.

**Space Complexity:** The space complexity is \(O(1)\) for variables used within the function, but the memory allocation for `console.print` and file operations could grow with the size of the output directory. The use of `Panel` from rich can be resource-intensive due to its rendering overhead.

**Bottlenecks or Inefficiencies:**
- **Repeated Prompts:** Using `Prompt.ask` multiple times can lead to inefficient user interaction, especially if default values are not utilized effectively.
- **Redundant Operations:** The function checks for the existence of `pyproject.toml` and prompts for confirmation each time, which is redundant if the file does not exist.

**Optimization Opportunities:**
- **Use Default Values:** Set default values in `typer.Option` to reduce repeated prompts. For example, set a reasonable default for `preset`.
- **Consolidate Prompts:** Combine similar prompts into fewer, more efficient interactions.
- **Lazy Evaluation:** Use lazy evaluation for file operations and only perform them when necessary.

**Resource Usage Concerns:**
- Ensure that all file handles are properly closed using context managers or `with` statements to avoid resource leaks.
- Optimize the use of `console.print` by batching similar outputs together to reduce rendering overhead.

By addressing these points, you can improve both the performance and user experience of your function.

---

*Generated by CodeWorm on 2026-02-22 00:10*
