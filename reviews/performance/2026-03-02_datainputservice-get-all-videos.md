# DataInputService.get_all_videos

**Type:** Performance Analysis
**Repository:** angelamos-operations
**File:** CarterOS-Server/src/aspects/analytics/facets/data_input/service.py
**Language:** python
**Lines:** 86-109
**Complexity:** 2.0

---

## Source Code

```python
async def get_all_videos(
        session: AsyncSession,
        page: int = 1,
        page_size: int = 50,
    ) -> TikTokVideoListResponse:
        """
        Get all videos with pagination
        """
        skip = (page - 1) * page_size
        videos = await TikTokVideoRepository.get_multi(
            session,
            skip = skip,
            limit = page_size
        )
        total = await TikTokVideoRepository.count(session)

        return TikTokVideoListResponse(
            items = [
                TikTokVideoResponse.model_validate(v) for v in videos
            ],
            total = total,
            page = page,
            page_size = page_size,
        )
```

---

## Performance Analysis

### Performance Analysis

#### Time Complexity
The time complexity of `get_all_videos` is O(n + 1), where n is the number of videos returned by the repository's `get_multi` method. This is because there are two database queries: one for fetching the videos and another for counting the total number of videos.

#### Space Complexity
The space complexity is O(m), where m is the number of videos fetched in a single page (50 in this case). The primary memory usage comes from storing the list of `TikTokVideoResponse` objects, which are created by validating each video object.

#### Bottlenecks and Inefficiencies
1. **Redundant Database Queries**: Fetching the total count separately can be inefficient if the same data is used multiple times.
2. **Unnecessary Iteration**: The list comprehension to validate videos could be optimized.

#### Optimization Opportunities
1. **Combine Queries**: Use a single query to fetch both the paginated results and the total count using SQL's `COUNT` with `LIMIT`.
2. **Use Generators**: Instead of fetching all videos at once, use generators to process them one by one if possible.
3. **Caching**: Cache the video list or the total count for repeated requests.

#### Resource Usage Concerns
- Ensure that the `AsyncSession` is properly managed and closed after use, especially in async contexts.
- Use context managers (`async with`) to manage database sessions automatically.

By combining queries and optimizing data processing, you can reduce the number of database round trips and improve overall performance.

---

*Generated by CodeWorm on 2026-03-02 00:45*
