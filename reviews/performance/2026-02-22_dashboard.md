# dashboard

**Type:** Performance Analysis
**Repository:** CodeWorm
**File:** codeworm/cli.py
**Language:** python
**Lines:** 347-371
**Complexity:** 3.0

---

## Source Code

```python
def dashboard(ctx: click.Context, host: str | None, port: int | None) -> None:
    """
    Start the web dashboard server
    """
    import uvicorn

    settings = load_settings(config_dir = ctx.obj["config_dir"])

    bind_host = host or settings.dashboard.host
    bind_port = port or settings.dashboard.port

    console.print("[bold green]Starting CodeWorm Dashboard[/bold green]")
    console.print(f"  URL: http://{bind_host}:{bind_port}")
    console.print(f"  Redis: {settings.dashboard.redis.connection_url}")

    os.environ["CODEWORM_DB_PATH"] = str(settings.db_path)
    os.environ["CODEWORM_REDIS_URL"] = settings.dashboard.redis.connection_url
    os.environ["CODEWORM_CONFIG_DIR"] = str(settings.config_dir)

    uvicorn.run(
        "dashboard.backend.app:app",
        host = bind_host,
        port = bind_port,
        log_level = "info",
    )
```

---

## Performance Analysis

### Performance Analysis of `dashboard` Function

#### Time Complexity (Big O Notation)
The time complexity is \(O(1)\), as the function performs a fixed number of operations regardless of input size.

#### Space Complexity and Memory Allocation
- The space complexity is also \(O(1)\) since no additional data structures are created that scale with input size. However, environment variables set using `os.environ` will persist for the duration of the process.
  
#### Bottlenecks or Inefficiencies
- **Redundant Operations**: The code checks `host` and `port` against default settings if they are `None`. This is redundant since these values are already set in `settings`.
- **Environment Variable Assignment**: Setting environment variables using `os.environ` could be optimized by ensuring only necessary variables are set.

#### Optimization Opportunities
1. **Remove Redundant Checks**:
   ```python
   bind_host = settings.dashboard.host
   bind_port = settings.dashboard.port
   ```
2. **Conditional Environment Variables**:
   Only set environment variables if they differ from defaults or user-provided values.
   
3. **Logging**: Use structured logging to capture more detailed information.

#### Resource Usage Concerns
- Ensure that `console.print` is efficient, especially in async contexts where it might block the event loop.
  
### Suggested Optimizations

```python
def dashboard(ctx: click.Context, host: str | None, port: int | None) -> None:
    settings = load_settings(config_dir=ctx.obj["config_dir"])
    
    bind_host = host or settings.dashboard.host
    bind_port = port or settings.dashboard.port
    
    console.print("[bold green]Starting CodeWorm Dashboard[/bold green]")
    console.print(f"  URL: http://{bind_host}:{bind_port}")
    console.print(f"  Redis: {settings.dashboard.redis.connection_url}")

    if host and host != settings.dashboard.host:
        os.environ["CODEWORM_DB_PATH"] = str(settings.db_path)
    elif port and port != settings.dashboard.port:
        os.environ["CODEWORM_REDIS_URL"] = settings.dashboard.redis.connection_url
    else:
        # No changes, skip setting environment variables

    uvicorn.run(
        "dashboard.backend.app:app",
        host=bind_host,
        port=bind_port,
        log_level="info",
    )
```

This refines the code to avoid unnecessary operations and ensures efficient resource usage.

---

*Generated by CodeWorm on 2026-02-22 08:27*
