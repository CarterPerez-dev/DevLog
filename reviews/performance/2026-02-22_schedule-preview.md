# schedule_preview

**Type:** Performance Analysis
**Repository:** CodeWorm
**File:** codeworm/cli.py
**Language:** python
**Lines:** 230-261
**Complexity:** 4.0

---

## Source Code

```python
def schedule_preview(ctx: click.Context, days: int, timezone: str | None) -> None:
    """
    Preview upcoming scheduled commit times
    """
    from codeworm.scheduler import CodeWormScheduler

    settings = load_settings(config_dir = ctx.obj["config_dir"])
    configure_logging(debug = ctx.obj["debug"])

    if timezone:
        settings.schedule.timezone = timezone

    scheduler = CodeWormScheduler(settings.schedule)
    preview = scheduler.get_schedule_preview(days = days)

    console.print(f"[bold]Schedule Preview ({days} day(s))[/bold]\n")

    table = Table()
    table.add_column("Time", style = "cyan")
    table.add_column("Hour", justify = "right")
    table.add_column("Day", style = "dim")

    for entry in preview:
        day_type = "[yellow]Weekend[/yellow]" if entry["is_weekend"] else "Weekday"
        table.add_row(
            entry["time"],
            str(entry["hour"]),
            day_type,
        )

    console.print(table)
    console.print(f"\n[dim]Total commits scheduled: {len(preview)}[/dim]")
```

---

## Performance Analysis

### Performance Analysis

#### Time Complexity
The time complexity of `schedule_preview` is \(O(n)\), where \(n\) is the number of scheduled entries in the preview. The primary bottleneck is the iteration over the `preview` list to construct the table.

#### Space Complexity and Memory Allocation
- **Space Complexity**: \(O(n + m)\) where \(n\) is the length of the `preview` list, and \(m\) is the overhead for creating the console table.
- **Memory Usage**: The function creates a new `Table` object, which can be costly if the preview list is large.

#### Bottlenecks or Inefficiencies
1. **Redundant Operations**: The timezone setting check is redundant as it only updates the settings and doesn't affect the iteration over `preview`.
2. **Blocking Calls**: There are no blocking calls in this context, but ensure that `load_settings` and `configure_logging` do not block.

#### Optimization Opportunities
1. **Reduce Redundant Operations**: Remove the timezone check if it is unnecessary.
2. **Optimize Table Construction**: Use a more efficient method to construct the table or use a generator expression to avoid storing all entries in memory at once.

```python
def schedule_preview(ctx: click.Context, days: int, timezone: str | None) -> None:
    from codeworm.scheduler import CodeWormScheduler

    settings = load_settings(config_dir=ctx.obj["config_dir"])
    configure_logging(debug=ctx.obj["debug"])

    scheduler = CodeWormScheduler(settings.schedule)
    preview = scheduler.get_schedule_preview(days=days)

    console.print(f"[bold]Schedule Preview ({days} day(s))[/bold]\n")

    table = Table()
    table.add_column("Time", style="cyan")
    table.add_column("Hour", justify="right")
    table.add_column("Day", style="dim")

    for entry in preview:
        is_weekend = "Weekend" if entry["is_weekend"] else "Weekday"
        table.add_row(entry["time"], str(entry["hour"]), f"[yellow]{is_weekend}[/yellow]")

    console.print(table)
    console.print(f"\n[dim]Total commits scheduled: {len(preview)}[/dim]")
```

#### Resource Usage Concerns
- Ensure that `load_settings` and `configure_logging` are efficient.
- Use context managers to ensure resources like file handles or database connections are properly closed.

By optimizing the table construction and removing redundant checks, you can improve both time and space efficiency.

---

*Generated by CodeWorm on 2026-02-22 00:57*
