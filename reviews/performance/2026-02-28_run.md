# run

**Type:** Performance Analysis
**Repository:** CertGames-Core
**File:** frontend/user-app/scripts/verify-guards.ts
**Language:** typescript
**Lines:** 150-201
**Complexity:** 12.0

---

## Source Code

```typescript
async function run(): Promise<void> {
  const active = tests.filter(t => !t.skip).length;
  const skipped = tests.filter(t => t.skip).length;
  console.log(`\nðŸ”  Guard Verification  ${BASE}`);
  console.log(`    ${active} active  |  ${skipped} skipped\n`);

  const results: Result[] = [];

  for (const t of tests) {
    if (t.skip) {
      results.push({ name: t.name, status: 'skip', detail: t.skip });
      process.stdout.write(`  â­  ${t.name}  (${t.skip})\n`);
      continue;
    }

    try {
      const { status: http, data } = await client.request({
        method: t.method ?? 'GET',
        url: t.url,
        data: t.body,
      });

      if (http >= 400) {
        const detail = `HTTP ${http} â€” ${JSON.stringify(data).slice(0, 140)}`;
        results.push({ name: t.name, status: 'http_err', detail });
        process.stdout.write(`  ðŸ”´  ${t.name}  â†’  ${detail}\n`);
        continue;
      }

      const ok = t.guard(data);
      results.push({ name: t.name, status: ok ? 'pass' : 'fail', detail: ok ? undefined : JSON.stringify(data).slice(0, 240) });
      process.stdout.write(ok ? `  âœ…  ${t.name}\n` : `  âŒ  ${t.name}\n`);
      if (!ok) process.stdout.write(`       ${JSON.stringify(data).slice(0, 240)}\n`);

    } catch (err) {
      const msg = err instanceof Error ? err.message : String(err);
      results.push({ name: t.name, status: 'throw', detail: msg });
      process.stdout.write(`  ðŸ’¥  ${t.name}  â†’  ${msg}\n`);
    }
  }

  const pass  = results.filter(r => r.status === 'pass').length;
  const fail  = results.filter(r => r.status === 'fail').length;
  const err   = results.filter(r => r.status === 'http_err' || r.status === 'throw').length;
  const skip  = results.filter(r => r.status === 'skip').length;

  console.log('\n' + 'â”€'.repeat(56));
  console.log(`  âœ… ${pass} passed  âŒ ${fail} guard-fail  ðŸ”´ ${err} http/throw  â­ ${skip} skipped`);
  console.log('â”€'.repeat(56) + '\n');

  if (fail > 0 || err > 0) process.exit(1);
}
```

---

## Performance Analysis

### Performance Analysis

#### Time Complexity
The time complexity of the `run` function is \(O(n)\), where \(n\) is the number of tests. This is because each test is processed once in a single loop.

#### Space Complexity and Memory Allocation
- **Space Complexity**: The space complexity is also \(O(n)\) due to the storage of results for each test.
- **Memory Allocation**: The `results` array grows linearly with the number of tests, which can be costly if there are many tests. Consider using a more efficient data structure like a Map or Set if you need faster lookups.

#### Bottlenecks and Inefficiencies
1. **Redundant Operations**: The `length` property is called twice for both active and skipped tests, which is unnecessary.
2. **Blocking Calls in Async Contexts**: The HTTP request inside the loop can be a bottleneck, especially if there are many tests or slow network responses.

#### Optimization Opportunities
1. **Reduce Redundant Length Calculations**: Store `tests.filter(t => !t.skip).length` and `tests.filter(t => t.skip).length` in variables before logging.
2. **Batch HTTP Requests**: Use a library like Axios with batch requests to reduce the number of network calls, especially if tests are dependent on each other.

#### Resource Usage Concerns
- Ensure that connections to `client.request` are properly managed and closed if necessary.
- Consider using a connection pool for the client to avoid excessive resource usage.

By addressing these points, you can improve both the performance and efficiency of your code.

---

*Generated by CodeWorm on 2026-02-28 23:04*
