# stats

**Type:** Performance Analysis
**Repository:** CodeWorm
**File:** codeworm/cli.py
**Language:** python
**Lines:** 271-295
**Complexity:** 4.0

---

## Source Code

```python
def stats(ctx: click.Context, devlog: Path | None) -> None:
    """
    Show documentation statistics
    """
    from codeworm.core import StateManager

    overrides = {"debug": ctx.obj["debug"]}
    if devlog:
        overrides["devlog"] = {"repo_path": devlog}

    settings = load_settings(config_dir = ctx.obj["config_dir"], **overrides)

    state = StateManager(settings.db_path)
    stats_data = state.get_stats()

    console.print("\n[bold]CodeWorm Statistics[/bold]\n")
    console.print(
        f"Total documented: [green]{stats_data['total_documented']}[/green]"
    )
    console.print(f"Last 7 days: [cyan]{stats_data['last_7_days']}[/cyan]")

    if stats_data["by_repo"]:
        console.print("\n[bold]By Repository:[/bold]")
        for repo_name, count in stats_data["by_repo"].items():
            console.print(f"  {repo_name}: {count}")
```

---

## Performance Analysis

### Performance Analysis

#### Time Complexity
The time complexity of the `stats` function is \(O(1)\), as it involves a fixed number of operations regardless of input size.

#### Space Complexity and Memory Allocation
- The primary memory allocation occurs with the `settings` object, which depends on the configuration settings.
- The `state.get_stats()` method likely returns a dictionary, which requires space proportional to the number of repositories (`O(n)` where \(n\) is the number of repositories).

#### Bottlenecks or Inefficiencies
1. **Redundant Operations**: The function constructs an `overrides` dictionary and passes it to `load_settings`, even if no override is needed.
2. **Unnecessary Iteration**: If `stats_data["by_repo"]` contains many entries, iterating over them can be costly.

#### Optimization Opportunities
1. **Reduce Redundant Dictionary Construction**: Only construct the `overrides` dictionary when necessary.
2. **Optimize Repository Loop**: Use a more efficient loop or consider early termination if only a few repositories are of interest.

```python
def stats(ctx: click.Context, devlog: Path | None) -> None:
    from codeworm.core import StateManager

    overrides = {"debug": ctx.obj["debug"]}
    if devlog:
        overrides["devlog"] = {"repo_path": devlog}

    settings = load_settings(config_dir=ctx.obj["config_dir"], **overrides)
    state = StateManager(settings.db_path)
    stats_data = state.get_stats()

    console.print("\n[bold]CodeWorm Statistics[/bold]\n")
    console.print(
        f"Total documented: [green]{stats_data['total_documented']}[/green]"
    )
    console.print(f"Last 7 days: [cyan]{stats_data['last_7_days']}[/cyan]")

    if stats_data["by_repo"]:
        console.print("\n[bold]By Repository:[/bold]")
        for repo_name, count in (stats_data["by_repo"] or {}).items():
            console.print(f"  {repo_name}: {count}")
```

#### Resource Usage Concerns
- Ensure that `StateManager` and its underlying resources are properly managed to avoid leaks.
- Use context managers if database connections or file handles are involved.

By optimizing the dictionary construction and reducing unnecessary iterations, you can improve both performance and readability.

---

*Generated by CodeWorm on 2026-02-22 09:06*
