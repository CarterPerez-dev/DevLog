# Repository.calculate_activity_score

**Type:** Performance Analysis
**Repository:** kill-pr0cess.inc
**File:** backend/src/models/github.rs
**Language:** rust
**Lines:** 213-264
**Complexity:** 12.0

---

## Source Code

```rust
pub fn calculate_activity_score(&self) -> f64 {
        let mut score = 0.0;

        // Stars contribute to score (logarithmic scale to prevent skewing)
        if self.stargazers_count > 0 {
            score += (self.stargazers_count as f64).ln() * 10.0;
        }

        // Recent activity bonus
        if let Some(pushed_at) = self.pushed_at {
            let days_since_push = (Utc::now() - pushed_at).num_days();
            if days_since_push < 30 {
                score += 20.0;
            } else if days_since_push < 90 {
                score += 10.0;
            }
        }

        // Fork ratio (indicates usefulness)
        if self.stargazers_count > 0 {
            let fork_ratio = self.forks_count as f64 / self.stargazers_count as f64;
            score += fork_ratio * 15.0;
        }

        // Issue management (lower open issues ratio is better)
        if self.open_issues_count > 0 {
            score -= (self.open_issues_count as f64).ln() * 2.0;
        }

        // Documentation (has description and topics)
        if self.description.is_some() {
            score += 5.0;
        }
        if let Some(topics) = &self.topics {
            if !topics.is_empty() {
                score += topics.len() as f64 * 2.0;
            }
        }

        // License indicates maturity
        if self.license_name.is_some() {
            score += 5.0;
        }

        // Penalize archived repositories
        if self.is_archived {
            score *= 0.5;
        }

        // Normalize to 0-100 scale
        score.max(0.0).min(100.0)
    }
```

---

## Performance Analysis

### Performance Analysis

**Time Complexity**: The function has a time complexity of \(O(1)\), as it performs a fixed number of operations regardless of the input size.

**Space Complexity**: The space complexity is also \(O(1)\) since no additional data structures are used, and only a few variables (`score`, `fork_ratio`) are allocated.

**Bottlenecks or Inefficiencies**:
- **Redundant Checks**: Checking if `stargazers_count > 0` twice (once for the logarithmic calculation and once for fork ratio) is redundant.
- **Multiple Conditionals**: The function contains multiple conditionals, which can be simplified to reduce redundancy.

**Optimization Opportunities**:
1. **Combine Redundant Checks**: Combine the checks for `stargazers_count > 0` into a single conditional block.
2. **Simplify Conditionals**: Simplify nested conditionals by using early returns or logical grouping.

```rust
pub fn calculate_activity_score(&self) -> f64 {
    let mut score = 0.0;

    if self.stargazers_count > 0 {
        score += (self.stargazers_count as f64).ln() * 10.0;
        let fork_ratio = self.forks_count as f64 / self.stargazers_count as f64;
        score += fork_ratio * 15.0;

        if self.open_issues_count > 0 {
            score -= (self.open_issues_count as f64).ln() * 2.0;
        }
    }

    // Recent activity bonus
    if let Some(pushed_at) = self.pushed_at {
        let days_since_push = (Utc::now() - pushed_at).num_days();
        if days_since_push < 30 {
            score += 20.0;
        } else if days_since_push < 90 {
            score += 10.0;
        }
    }

    // Documentation and License
    if self.description.is_some() || !self.topics.is_empty() {
        score += (5.0 + self.topics.as_ref().map_or(0.0, |t| t.len() as f64 * 2.0));
    }

    // Penalize archived repositories
    if self.is_archived {
        score *= 0.5;
    }

    score.max(0.0).min(100.0)
}
```

**Resource Usage Concerns**: The function does not have any resource usage concerns such as unclosed connections or file handles, but ensure that `Utc::now()` is efficient and consider caching the current time if this operation is called frequently.

By simplifying conditionals and combining redundant checks, you can improve code readability and maintainability without affecting performance.

---

*Generated by CodeWorm on 2026-02-21 19:11*
