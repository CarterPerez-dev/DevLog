# _score_base64url

**Type:** Performance Analysis
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 95-119
**Complexity:** 11.0

---

## Source Code

```python
def _score_base64url(data: str) -> float:
    stripped = "".join(data.split())
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0
    if not all(c in BASE64URL_CHARSET for c in stripped):
        return 0.0

    score = W.B64URL_BASE

    has_url_chars = any(c in stripped for c in "-_")
    has_std_chars = any(c in stripped for c in "+/")

    if has_url_chars and not has_std_chars:
        score += W.B64URL_SAFE_CHARS
    elif not has_url_chars:
        return 0.0

    decoded = try_decode(stripped, EncodingFormat.BASE64URL)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Performance Analysis

### Performance Analysis

**Time Complexity:** The function has a time complexity of \(O(n)\), where \(n\) is the length of `data`. This is due to the operations involving string manipulations and checks.

**Space Complexity:** The space complexity is \(O(1)\) as no additional data structures depend on input size. However, the `try_decode` function could introduce a small overhead if it uses significant memory.

**Bottlenecks or Inefficiencies:**
- **Redundant Operations:** The `split()` and `join()` operations are unnecessary since `strip()` can be used directly.
- **Multiple Checks for Same Condition:** The checks for characters in `BASE64URL_CHARSET` and the subsequent conditions could be optimized.

**Optimization Opportunities:**
1. Replace `"".join(data.split())` with `data.strip()`.
2. Combine character checks into a single pass using a set intersection.
3. Use early returns to reduce nesting.

```python
def _score_base64url(data: str) -> float:
    stripped = data.strip()
    if len(stripped) < MIN_INPUT_LENGTH or not all(c in BASE64URL_CHARSET for c in stripped):
        return 0.0

    has_url_chars = any(c in "-_" for c in stripped)
    has_std_chars = any(c in "+/" for c in stripped)

    score = W.B64URL_BASE
    if (has_url_chars and not has_std_chars) or not has_url_chars:
        score += W.B64URL_SAFE_CHARS

    decoded = try_decode(stripped, EncodingFormat.BASE64URL)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

**Resource Usage Concerns:**
- Ensure `try_decode` and `is_printable_text` are efficient.
- Consider caching results of repeated calls with the same input using a decorator or dictionary.

This refactoring reduces redundancy and improves readability while maintaining performance.

---

*Generated by CodeWorm on 2026-03-01 12:20*
