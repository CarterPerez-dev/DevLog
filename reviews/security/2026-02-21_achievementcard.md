# AchievementCard

**Type:** Security Review
**Repository:** ios-test
**File:** red-recon/app/(app)/achievements.tsx
**Language:** tsx
**Lines:** 60-140
**Complexity:** 13.0

---

## Source Code

```tsx
function AchievementCard({
  id,
  isUnlocked,
}: {
  id: AchievementId
  isUnlocked: boolean
}): React.ReactElement {
  const achievement = ACHIEVEMENTS[id]
  const rarityColor = RARITY_COLORS[achievement.rarity]
  const rarityBg = RARITY_BG_COLORS[achievement.rarity]
  const rarityLabel = RARITY_LABELS[achievement.rarity]

  return (
    <Stack
      backgroundColor={isUnlocked ? '$bgSurface100' : '$bgSurface100'}
      borderWidth={1}
      borderColor={isUnlocked ? rarityColor : '$borderDefault'}
      borderRadius="$3"
      padding="$4"
      opacity={isUnlocked ? 1 : 0.5}
    >
      <XStack gap="$4" alignItems="flex-start">
        <Stack
          width={52}
          height={52}
          borderRadius="$2"
          backgroundColor={isUnlocked ? rarityBg : '$bgSurface200'}
          alignItems="center"
          justifyContent="center"
        >
          {isUnlocked ? (
            ICON_MAP[achievement.icon] ?? <Award size={24} color={colors.textDefault.val} />
          ) : (
            <Lock size={24} color={colors.textMuted.val} />
          )}
        </Stack>

        <YStack flex={1}>
          <XStack alignItems="center" gap="$2" marginBottom="$1">
            <Text
              fontSize={15}
              fontWeight="600"
              color={isUnlocked ? '$textDefault' : '$textMuted'}
              fontFamily="$heading"
            >
              {achievement.title}
            </Text>
          </XStack>

          <Text
            fontSize={12}
            color={isUnlocked ? '$textLight' : '$textMuted'}
            fontFamily="$body"
            lineHeight={17}
            marginBottom="$2"
          >
            {isUnlocked ? achievement.description : '???'}
          </Text>

          <Stack
            backgroundColor={isUnlocked ? `${rarityColor}20` : '$bgSurface200'}
            paddingVertical="$1"
            paddingHorizontal="$2"
            borderRadius="$1"
            alignSelf="flex-start"
          >
            <Text
              fontSize={10}
              fontWeight="700"
              color={isUnlocked ? rarityColor : '$textMuted'}
              fontFamily="$body"
              letterSpacing={0.5}
            >
              {rarityLabel}
            </Text>
          </Stack>
        </YStack>
      </XStack>
    </Stack>
  )
}
```

---

## Security Review

### Security Review for `AchievementCard` Component

#### Vulnerabilities Found:

1. **Info - Hardcoded Secrets or Credentials:**
   - No hardcoded secrets or credentials are present in the code.

2. **Info - Input Validation Gaps:**
   - The `id` prop is directly used to index into `ACHIEVEMENTS`, which could potentially lead to out-of-bounds array access if `id` is not properly validated.
   - **Severity:** Info
   - **Attack Vector:** An attacker could provide an invalid or large `id` value, leading to unexpected behavior.

3. **Info - Error Handling:**
   - The code handles the case where `ICON_MAP[achievement.icon]` might be undefined by providing a default icon.
   - **Severity:** Info
   - **Attack Vector:** This is handled gracefully and does not pose a security risk.

#### Recommended Fixes:

1. **Input Validation:**
   - Validate the `id` prop to ensure it falls within expected bounds before using it to index into `ACHIEVEMENTS`.
     ```tsx
     const achievement = ACHIEVEMENTS[id] ?? null;
     if (!achievement) {
       console.warn(`Invalid Achievement ID: ${id}`);
       return <></>;
     }
     ```

2. **Overall Security Posture:**
   - The component is relatively secure, but input validation and error handling can be improved to prevent unexpected behavior.

By addressing the potential out-of-bounds access issue, you can ensure that the component behaves predictably and securely.

---

*Generated by CodeWorm on 2026-02-21 14:42*
