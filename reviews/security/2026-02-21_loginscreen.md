# LoginScreen

**Type:** Security Review
**Repository:** social-media-notes
**File:** frontend/app/login.tsx
**Language:** tsx
**Lines:** 14-105
**Complexity:** 14.0

---

## Source Code

```tsx
function LoginScreen() {
  const [isRegister, setIsRegister] = useState(false)
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [fullName, setFullName] = useState('')

  const login = useLogin()
  const register = useRegister()

  const handleSubmit = async () => {
    if (!email || !password) return

    try {
      if (isRegister) {
        await register.mutateAsync({
          email,
          password,
          full_name: fullName || undefined,
        })
        await login.mutateAsync({ username: email, password })
      } else {
        await login.mutateAsync({ username: email, password })
      }
      router.replace('/(tabs)')
    } catch {}
  }

  const isLoading = login.isPending || register.isPending

  return (
    <KeyboardAvoidingView
      style={styles.container}
      behavior={Platform.OS === 'ios' ? 'padding' : 'height'}
    >
      <View style={styles.form}>
        <Text style={styles.title}>
          {isRegister ? 'Create Account' : 'Sign In'}
        </Text>

        {isRegister && (
          <TextInput
            style={styles.input}
            placeholder="Name"
            placeholderTextColor="#444"
            value={fullName}
            onChangeText={setFullName}
            autoCapitalize="words"
          />
        )}

        <TextInput
          style={styles.input}
          placeholder="Email"
          placeholderTextColor="#444"
          value={email}
          onChangeText={setEmail}
          keyboardType="email-address"
          autoCapitalize="none"
          autoCorrect={false}
        />

        <TextInput
          style={styles.input}
          placeholder="Password"
          placeholderTextColor="#444"
          value={password}
          onChangeText={setPassword}
          secureTextEntry
        />

        <TouchableOpacity
          style={[styles.button, isLoading && styles.buttonDisabled]}
          onPress={handleSubmit}
          disabled={isLoading}
        >
          <Text style={styles.buttonText}>
            {isLoading ? '...' : isRegister ? 'Register' : 'Login'}
          </Text>
        </TouchableOpacity>

        <TouchableOpacity
          style={styles.switchButton}
          onPress={() => setIsRegister(!isRegister)}
        >
          <Text style={styles.switchText}>
            {isRegister ? 'Have an account? Sign in' : 'Need an account? Register'}
          </Text>
        </TouchableOpacity>
      </View>
    </KeyboardAvoidingView>
  )
}
```

---

## Security Review

### Security Review for `LoginScreen` Component

#### Vulnerabilities Found:

1. **Input Validation Gaps** - Lines 15-20: The code does not validate the input values before sending them to the backend, which could lead to potential injection vulnerabilities if the backend is not properly sanitized.

   **Severity**: Medium
   **Attack Vector**: An attacker could inject malicious data into the `email`, `password`, or `fullName` fields.
   
2. **Hardcoded Secrets** - Not applicable in this code snippet.

3. **Error Handling that Leaks Information** - Line 19: The catch block does not handle errors, which can leak information about the application's internal state to attackers.

   **Severity**: Low
   **Attack Vector**: Potential for exposing error messages or stack traces if an error occurs during authentication.

#### Recommended Fixes:

1. Validate input values before sending them to the backend (e.g., check email format, password strength).
2. Implement proper error handling in the catch block to avoid information leakage.
3. Ensure that any sensitive data is securely handled and not exposed in logs or error messages.

#### Overall Security Posture:

The current implementation has some gaps in input validation and error handling, which could be exploited by attackers. Improving these areas will enhance the security posture of the application. Regular code reviews and security testing should be part of the development process to maintain a robust security stance.

---

*Generated by CodeWorm on 2026-02-21 15:25*
