# print_batch_results

**Type:** Security Review
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/dns-lookup/dnslookup/output.py
**Language:** python
**Lines:** 269-328
**Complexity:** 13.0

---

## Source Code

```python
def print_batch_results(results: list[DNSResult]) -> None:
    """
    Display batch lookup results in a summary table
    """
    table = Table(
        title = "[bold]Batch Results[/bold]",
        box = box.ROUNDED,
        border_style = "blue",
        row_styles = ["",
                      "dim"],
    )

    table.add_column("Domain", style = "cyan", min_width = 25)
    table.add_column("A", justify = "center", width = 15)
    table.add_column("MX", justify = "center", width = 5)
    table.add_column("NS", justify = "center", width = 5)
    table.add_column(
        "Time",
        justify = "right",
        style = "dim",
        width = 8
    )

    for result in results:
        a_records = [
            r for r in result.records if r.record_type == RecordType.A
        ]
        mx_count = len(
            [
                r for r in result.records
                if r.record_type == RecordType.MX
            ]
        )
        ns_count = len(
            [
                r for r in result.records
                if r.record_type == RecordType.NS
            ]
        )

        a_value = a_records[0].value if a_records else "[dim]-[/dim]"
        mx_value = str(mx_count) if mx_count else "[dim]-[/dim]"
        ns_value = str(ns_count) if ns_count else "[dim]-[/dim]"

        table.add_row(
            result.domain,
            a_value,
            mx_value,
            ns_value,
            f"{result.query_time_ms:.0f}ms",
        )

    console.print(table)

    total_records = sum(len(r.records) for r in results)
    total_time = sum(r.query_time_ms for r in results)
    console.print(
        f"\n[green]:heavy_check_mark:[/green] {len(results)} domains, {total_records} total records in {total_time:.0f}ms"
    )
    console.print()
```

---

## Security Review

### Security Review for `print_batch_results` Function

#### Vulnerabilities and Severity:

1. **Info:**
   - No injection vulnerabilities, authentication issues, hardcoded secrets, race conditions, or insecure deserialization found.
   
2. **Input Validation Gap (Low):**
   - The function does not validate the input `results`. Ensure that each element in `results` is a valid `DNSResult` object to prevent potential errors.

3. **Error Handling (Info):**
   - No explicit error handling for exceptions like `IndexError` or `TypeError` when accessing list elements. Consider adding try-except blocks to handle such cases gracefully.

#### Attack Vectors:

- **Low:** If an attacker can manipulate the input `results`, they might cause errors or unexpected behavior, but this is mitigated by ensuring proper validation of inputs.
  
#### Recommended Fixes:

1. **Input Validation:**
   ```python
   for result in results:
       if not isinstance(result, DNSResult):
           raise ValueError("Invalid DNSResult object")
   ```

2. **Error Handling:**
   ```python
   try:
       a_value = a_records[0].value if a_records else "[dim]-[/dim]"
       mx_value = str(mx_count) if mx_count else "[dim]-[/dim]"
       ns_value = str(ns_count) if ns_count else "[dim]-[/dim]"
   except (IndexError, TypeError):
       # Handle specific exceptions
       pass
   ```

3. **Overall Security Posture:**
   - The function is secure from common vulnerabilities but could benefit from proper input validation and error handling to ensure robustness.

By addressing these points, the overall security posture of the code can be improved without introducing significant complexity.

---

*Generated by CodeWorm on 2026-02-18 23:14*
