# stats

**Type:** Security Review
**Repository:** CodeWorm
**File:** codeworm/cli.py
**Language:** python
**Lines:** 271-295
**Complexity:** 4.0

---

## Source Code

```python
def stats(ctx: click.Context, devlog: Path | None) -> None:
    """
    Show documentation statistics
    """
    from codeworm.core import StateManager

    overrides = {"debug": ctx.obj["debug"]}
    if devlog:
        overrides["devlog"] = {"repo_path": devlog}

    settings = load_settings(config_dir = ctx.obj["config_dir"], **overrides)

    state = StateManager(settings.db_path)
    stats_data = state.get_stats()

    console.print("\n[bold]CodeWorm Statistics[/bold]\n")
    console.print(
        f"Total documented: [green]{stats_data['total_documented']}[/green]"
    )
    console.print(f"Last 7 days: [cyan]{stats_data['last_7_days']}[/cyan]")

    if stats_data["by_repo"]:
        console.print("\n[bold]By Repository:[/bold]")
        for repo_name, count in stats_data["by_repo"].items():
            console.print(f"  {repo_name}: {count}")
```

---

## Security Review

### Security Review for `stats` Function in `/home/yoshi/dev/github/CodeWorm/codeworm/cli.py`

#### Vulnerabilities Found:

- **Info: Hardcoded Secrets or Credentials**
  - Line: N/A (No hardcoded secrets found)
  
- **Low: Input Validation Gaps**
  - Lines: 8, 9
    ```python
    if devlog:
        overrides["devlog"] = {"repo_path": devlog}
    ```
  - Potential for injection or path traversal attacks. Ensure `devlog` is properly validated.

#### Attack Vectors:

- An attacker could provide a malicious file path to `devlog`, potentially leading to unauthorized access or execution of arbitrary code.
  
#### Recommended Fixes:

1. **Input Validation:**
   ```python
   if devlog and devlog.exists() and devlog.is_dir():
       overrides["devlog"] = {"repo_path": str(devlog.resolve())}
   ```

2. **Error Handling:**
   Add error handling to manage potential issues with file paths.
   ```python
   try:
       if devlog and devlog.exists() and devlog.is_dir():
           overrides["devlog"] = {"repo_path": str(devlog.resolve())}
   except Exception as e:
       console.print(f"Error: {e}")
   ```

#### Overall Security Posture:

The code is generally secure but lacks proper input validation for the `devlog` parameter. Addressing this will significantly improve the security posture of the function.

**Severity Ratings:**
- Hardcoded Secrets or Credentials: Info
- Input Validation Gaps: Low

---

*Generated by CodeWorm on 2026-02-21 16:28*
