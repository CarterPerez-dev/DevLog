# CodeWormDaemon._find_documentable_candidate

**Type:** Security Review
**Repository:** CodeWorm
**File:** codeworm/daemon.py
**Language:** python
**Lines:** 522-544
**Complexity:** 7.0

---

## Source Code

```python
async def _find_documentable_candidate(self) -> AnalysisCandidate | None:
        """
        Legacy method - find a function candidate to document
        """
        enabled_repos = [r for r in self.settings.repos if r.enabled]

        for repo in enabled_repos:
            if repo.name in self.stats.repos_exhausted:
                continue

            candidates = self.analyzer.find_candidates(repo = repo, limit = 50)
            for candidate in candidates:
                if self.state.should_document(candidate.snippet):
                    return candidate

            self.stats.record_repo_exhausted(repo.name)
            self.logger.debug(
                "repo_exhausted",
                repo = repo.name,
                checked = len(candidates),
            )

        return None
```

---

## Security Review

### Security Review for `CodeWormDaemon._find_documentable_candidate`

#### Vulnerabilities and Severity

1. **Info - No obvious injection or deserialization issues**: The method does not involve user input directly in SQL, command execution, or deserialization.
2. **Low - Logging Information Exposure**: The debug log reveals the name of the exhausted repository and the number of checked candidates.

```python
self.logger.debug(
    "repo_exhausted",
    repo = repo.name,
    checked = len(candidates),
)
```

This could potentially leak information about the system state, which might be useful for an attacker to understand the structure or limits of the application.

#### Attack Vectors

- **Information Disclosure**: An attacker could exploit this logging mechanism to infer details about the repositories and candidate checks being performed.

#### Recommended Fixes

1. **Mask Sensitive Information in Logs**:
   ```python
   self.logger.debug(
       "repo_exhausted",
       repo = "[REDACTED]",
       checked = len(candidates),
   )
   ```

2. **Use Context Managers for Resources**: Ensure that resources like `candidates` are properly managed, though this snippet does not directly interact with external resources.

#### Overall Security Posture

The current code is relatively secure but could benefit from better logging practices to prevent information leakage. Implementing the suggested fix will enhance the security posture by reducing potential attack vectors related to log exposure.

---

*Generated by CodeWorm on 2026-03-01 19:39*
