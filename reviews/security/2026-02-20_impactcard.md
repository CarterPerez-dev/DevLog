# ImpactCard

**Type:** Security Review
**Repository:** CertGames-Core
**File:** frontend/admin-app/src/modules/analytics/components/errors/ErrorImpactMetrics.tsx
**Language:** tsx
**Lines:** 43-75
**Complexity:** 14.0

---

## Source Code

```tsx
function ImpactCard({
  title,
  value,
  subValue,
  icon: Icon,
  trend,
  colorClass = 'default',
}: ImpactCardProps): React.JSX.Element {
  return (
    <div className={`${styles.impactCard} ${styles[`card--${colorClass}`]}`}>
      <div className={styles.cardIcon}>
        <Icon />
      </div>
      <div className={styles.cardContent}>
        <h4 className={styles.cardTitle}>{title}</h4>
        <div className={styles.cardValue}>
          {String(value)}
          {subValue !== null && subValue !== undefined && (
            <span className={styles.cardSubValue}>{subValue}</span>
          )}
        </div>
        {trend !== null && trend !== undefined && (
          <div
            className={`${styles.cardTrend} ${trend >= 0 ? styles.trendUp : styles.trendDown}`}
          >
            <FiTrendingUp className={styles.trendIcon} />
            {Math.abs(trend)}%
          </div>
        )}
      </div>
    </div>
  );
}
```

---

## Security Review

### Security Review for `ImpactCard` Component

#### Vulnerabilities Found:

1. **Input Validation Gaps** - Line 9: The `value` and `subValue` props are directly rendered as strings without validation or sanitization, which could lead to XSS if user input is not properly sanitized.
   - **Severity**: Medium
   - **Attack Vector**: An attacker could inject malicious scripts via the `value` prop.

2. **Overall Security Posture**:
   - The component does not contain critical vulnerabilities like SQL injection or command injection.
   - There are no hardcoded secrets or credentials visible in this snippet.
   - No race conditions, TOCTOU bugs, or insecure deserialization issues are present.

#### Recommended Fixes:

1. Sanitize User Input: Ensure that any user-provided input is properly sanitized and validated before rendering it to the DOM. Use libraries like `DOMPurify` for XSS protection.
   ```tsx
   import { sanitize } from 'dompurify';

   // ...

   <div className={styles.cardValue}>
     {sanitize(String(value))}
     {subValue !== null && subValue !== undefined && (
       <span className={styles.cardSubValue}>{sanitize(subValue)}</span>
     )}
   </div>
   ```

2. **Error Handling**: Implement robust error handling to avoid leaking information through exceptions or logs.

By addressing these issues, the security posture of the `ImpactCard` component can be significantly improved.

---

*Generated by CodeWorm on 2026-02-20 09:14*
