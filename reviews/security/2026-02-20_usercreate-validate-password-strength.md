# UserCreate.validate_password_strength

**Type:** Security Review
**Repository:** fullstack-template
**File:** stacks/fastapi-react/backend/app/user/schemas.py
**Language:** python
**Lines:** 40-50
**Complexity:** 5.0

---

## Source Code

```python
def validate_password_strength(cls, v: str) -> str:
        """
        Ensure password has minimum complexity
        """
        if not any(c.isupper() for c in v):
            raise ValueError(
                "Password must contain at least one uppercase letter"
            )
        if not any(c.isdigit() for c in v):
            raise ValueError("Password must contain at least one digit")
        return v
```

---

## Security Review

### Security Review for `validate_password_strength` Function

#### Vulnerabilities Found:

1. **Info: Input Validation Gaps**
   - The function does not check for special characters or minimum length, which could lead to weaker passwords.
   
2. **Info: Error Handling that Leaks Information**
   - The error messages provide minimal information and do not disclose the exact nature of the issue, but they are still informative enough.

#### Attack Vectors:

- An attacker could exploit these gaps by creating a password with no uppercase letters or digits, potentially bypassing this validation.
  
#### Recommended Fixes:

1. **Add Special Character Check:**
   ```python
   if not any(c in "!@#$%^&*()_+={}[]|\\;:'\",.<>?-~" for c in v):
       raise ValueError("Password must contain at least one special character")
   ```

2. **Add Minimum Length Check:**
   ```python
   if len(v) < 8:
       raise ValueError("Password must be at least 8 characters long")
   ```

3. **Improve Error Messages (Optional):**
   - While not critical, consider providing more generic error messages to avoid leaking information.

#### Overall Security Posture:

The current implementation is basic and could be improved by adding more comprehensive validation rules. The function currently does not handle other common password weaknesses such as length or special characters. Improving these checks will enhance the overall security posture of your application.

---

*Generated by CodeWorm on 2026-02-20 11:41*
