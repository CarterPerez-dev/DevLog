# matchGlob

**Type:** Security Review
**Repository:** Yoshi-Audit
**File:** internal/docker/protection.go
**Language:** go
**Lines:** 47-58
**Complexity:** 5.0

---

## Source Code

```go
func matchGlob(pattern, name string) bool {
	if strings.HasPrefix(pattern, "*") && strings.HasSuffix(pattern, "*") && !strings.Contains(pattern[1:len(pattern)-1], "*") {
		inner := pattern[1 : len(pattern)-1]
		return strings.Contains(strings.ToLower(name), strings.ToLower(inner))
	}

	matched, err := filepath.Match(strings.ToLower(pattern), strings.ToLower(name))
	if err != nil {
		return false
	}
	return matched
}
```

---

## Security Review

### Security Review for `matchGlob` Function

**Vulnerabilities:**

1. **Injection Vulnerability (Info)** - Lines 5-7 check for glob patterns with wildcards, but there is no indication of external input or command execution. However, if this function is used in a context where user-provided patterns are involved, it could be susceptible to injection attacks.

2. **Input Validation Gap (Low)** - The function does not validate the `pattern` and `name` inputs for malicious content before processing them with `strings.ToLower()` or `filepath.Match()`. Ensure input validation is robust against common attack vectors like special characters.

3. **Error Handling (Info)** - The error handling in `filepath.Match()` is minimal, returning false on any error. Consider logging the error to understand potential issues better without leaking sensitive information.

**Attack Vectors:**

- If user-provided patterns are used, an attacker could craft malicious input to exploit the glob pattern matching logic.
- Improper validation of inputs can lead to unexpected behavior or security vulnerabilities.

**Recommended Fixes:**

1. Validate and sanitize `pattern` and `name` before processing them:
   ```go
   if !isValidPattern(pattern) || !isValidName(name) {
       return false, errors.New("invalid input")
   }
   ```

2. Implement robust error handling for `filepath.Match()` to log or handle errors appropriately without leaking sensitive information.

3. Ensure the function is used in a secure context where inputs are validated and sanitized.

**Overall Security Posture:**

The current implementation has low severity issues but could be improved by adding input validation, proper error handling, and ensuring secure usage contexts.

---

*Generated by CodeWorm on 2026-03-02 01:16*
