# formatAge

**Type:** Security Review
**Repository:** Yoshi-Audit
**File:** internal/ui/dockertab/dockertab.go
**Language:** go
**Lines:** 635-661
**Complexity:** 7.0

---

## Source Code

```go
func formatAge(created time.Time) string {
	if created.IsZero() {
		return "unknown"
	}
	dur := time.Since(created)
	days := int(dur.Hours() / 24)
	if days < 1 {
		hours := int(dur.Hours())
		if hours < 1 {
			return "just now"
		}
		return fmt.Sprintf("%dh ago", hours)
	}
	if days < 7 {
		return fmt.Sprintf("%dd ago", days)
	}
	weeks := days / 7
	if weeks < 5 {
		return fmt.Sprintf("%dw ago", weeks)
	}
	months := days / 30
	if months < 12 {
		return fmt.Sprintf("%dmo ago", months)
	}
	years := days / 365
	return fmt.Sprintf("%dy ago", years)
}
```

---

## Security Review

### Security Review for `formatAge` Function

#### Vulnerabilities and Severity:

1. **No Injection Vulnerabilities**: The function does not involve any input that could be used in a SQL, command, or XSS context.
2. **No Authentication and Authorization Issues**: The function processes internal data without external inputs requiring authentication.
3. **No Hardcoded Secrets or Credentials**: No secrets are present in the code snippet.
4. **No Race Conditions or TOCTOU Bugs**: The function is deterministic and does not involve concurrent operations that could lead to race conditions.
5. **Input Validation Gaps**: None, as the function processes internal data.
6. **No Insecure Deserialization**: Not applicable here.
7. **Error Handling**: The function uses `time.Since` which inherently handles errors by returning a `time.Duration`. No explicit error handling is needed.

#### Attack Vectors:
- Since the function does not process external inputs, there are no direct attack vectors related to injection or input validation gaps.

#### Recommended Fixes:
- Ensure that any future modifications handle potential edge cases (e.g., very large durations) by adding appropriate checks.
- Consider logging errors if you plan to integrate this function with other parts of your application where error handling might be necessary.

#### Overall Security Posture:
The `formatAge` function is secure and does not introduce significant vulnerabilities. However, maintaining a consistent approach to error handling and edge case management across the codebase will further enhance security posture.

---

*Generated by CodeWorm on 2026-03-01 23:06*
