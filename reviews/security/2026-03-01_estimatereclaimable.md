# EstimateReclaimable

**Type:** Security Review
**Repository:** Yoshi-Audit
**File:** internal/docker/presets.go
**Language:** go
**Lines:** 51-74
**Complexity:** 7.0

---

## Source Code

```go
func EstimateReclaimable(images []ImageInfo, selectedImageIDs []string, volumes []VolumeInfo, selectedVolumeNames []string) int64 {
	imageSet := make(map[string]bool, len(selectedImageIDs))
	for _, id := range selectedImageIDs {
		imageSet[id] = true
	}

	volumeSet := make(map[string]bool, len(selectedVolumeNames))
	for _, name := range selectedVolumeNames {
		volumeSet[name] = true
	}

	var total int64
	for _, img := range images {
		if imageSet[img.ID] {
			total += img.Size
		}
	}
	for _, vol := range volumes {
		if volumeSet[vol.Name] {
			total += vol.Size
		}
	}
	return total
}
```

---

## Security Review

### Security Review for `EstimateReclaimable` Function

#### Vulnerabilities Found:

1. **Info - Input Validation Gaps**: The function does not validate the input data types or values, which could lead to unexpected behavior.
2. **Info - Error Handling**: No error handling is present for potential issues in the input slices.

#### Attack Vectors:
- Maliciously crafted `selectedImageIDs` and `selectedVolumeNames` could cause incorrect calculations if not properly validated.

#### Recommended Fixes:

1. **Input Validation** (Severity: Info):
   ```go
   func EstimateReclaimable(images []ImageInfo, selectedImageIDs []string, volumes []VolumeInfo, selectedVolumeNames []string) int64 {
       for _, id := range selectedImageIDs {
           if !isValidID(id) { // Define isValidID function to validate IDs
               return 0
           }
       }

       for _, name := range selectedVolumeNames {
           if !isValidName(name) { // Define isValidName function to validate names
               return 0
           }
       }
   }
   ```

2. **Error Handling** (Severity: Info):
   ```go
   func EstimateReclaimable(images []ImageInfo, selectedImageIDs []string, volumes []VolumeNames, selectedVolumeNames []string) int64 {
       for _, id := range selectedImageIDs {
           if !isValidID(id) { // Define isValidID function to validate IDs
               return 0
           }
       }

       for _, name := range selectedVolumeNames {
           if !isValidName(name) { // Define isValidName function to validate names
               return 0
           }
       }

       var total int64
       for _, img := range images {
           if imageSet[img.ID] {
               total += img.Size
           }
       }
       for _, vol := range volumes {
           if volumeSet[vol.Name] {
               total += vol.Size
           }
       }
       return total
   }
   ```

#### Overall Security Posture:
The current implementation is secure but could benefit from input validation and error handling to prevent unexpected behavior. Implementing these fixes will enhance the robustness of the function.

--- 

This review focuses on improving input validation and adding basic error handling, which are critical for maintaining a high security posture in Go applications.

---

*Generated by CodeWorm on 2026-03-01 21:34*
