# PrevNextNav

**Type:** Security Review
**Repository:** my-portfolio
**File:** v1/frontend/src/components/layout/PrevNextNav.tsx
**Language:** tsx
**Lines:** 39-107
**Complexity:** 15.0

---

## Source Code

```tsx
function PrevNextNav({
  currentPath,
}: PrevNextNavProps): React.ReactElement | null {
  const { t } = useTranslation()
  const location = useLocation()
  const { data: projectsNav } = useProjectsNav()

  const path = currentPath ?? location.pathname

  const projectNavItems: NavItem[] = (projectsNav?.items ?? []).map((p) => ({
    path: ROUTES.PROJECTS.DETAIL(p.slug),
    label: p.title,
  }))

  const fullNavOrder: NavItem[] = [
    ...STATIC_NAV_ORDER,
    ...projectNavItems,
    ...BACKGROUND_NAV,
  ]

  const currentIndex = fullNavOrder.findIndex((item) => item.path === path)

  if (currentIndex === -1) {
    return null
  }

  const prevItem = currentIndex > 0 ? fullNavOrder[currentIndex - 1] : null
  const nextItem =
    currentIndex < fullNavOrder.length - 1 ? fullNavOrder[currentIndex + 1] : null

  if (!prevItem && !nextItem) {
    return null
  }

  return (
    <nav className={styles.nav} aria-label="Page navigation">
      <div className={styles.prev}>
        {prevItem && (
          <Link to={prevItem.path} className={styles.link}>
            <span className={styles.direction}>
              <ChevronLeftIcon />
              {t('common.previous')}
            </span>
            <span className={styles.title}>
              {prevItem.translationKey
                ? t(prevItem.translationKey)
                : prevItem.label}
            </span>
          </Link>
        )}
      </div>
      <div className={styles.next}>
        {nextItem && (
          <Link to={nextItem.path} className={styles.link}>
            <span className={styles.direction}>
              {t('common.next')}
              <ChevronRightIcon />
            </span>
            <span className={styles.title}>
              {nextItem.translationKey
                ? t(nextItem.translationKey)
                : nextItem.label}
            </span>
          </Link>
        )}
      </div>
    </nav>
  )
}
```

---

## Security Review

### Security Review for `PrevNextNav` Component

#### Vulnerabilities Found:

1. **Info - Input Validation Gaps:**
   - Line 20-25: The `currentPath` and `path` variables are derived from `location.pathname`, which could be manipulated by an attacker to navigate to potentially unauthorized paths.

2. **Info - Error Handling:**
   - Lines 14-16: If `projectsNav` or `fullNavOrder` is not properly defined, it might lead to errors that could leak information about the application's structure.

#### Attack Vectors:

- An attacker could manipulate the URL to navigate to paths that should be restricted.
- Potential issues with undefined variables could expose sensitive information through error messages.

#### Recommended Fixes:

1. **Input Validation:**
   - Validate `currentPath` and ensure it matches expected patterns or paths before processing.
     ```tsx
     const path = currentPath ?? location.pathname;
     if (!isValidPath(path)) {
       return null; // Or handle appropriately
     }
     ```

2. **Error Handling:**
   - Implement robust error handling to prevent information leakage.
     ```tsx
     try {
       const { data: projectsNav } = useProjectsNav();
       const projectNavItems = (projectsNav?.items ?? []).map((p) => ({
         path: ROUTES.PROJECTS.DETAIL(p.slug),
         label: p.title,
       }));
     } catch (error) {
       console.error('Error fetching navigation data:', error);
       return null; // Or handle appropriately
     }
     ```

#### Overall Security Posture:

The component is relatively secure but could benefit from input validation and robust error handling. Ensuring that paths are validated and errors are handled gracefully will help maintain a strong security posture.

---

*Generated by CodeWorm on 2026-02-21 11:23*
