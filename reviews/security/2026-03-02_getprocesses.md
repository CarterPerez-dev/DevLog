# GetProcesses

**Type:** Security Review
**Repository:** Yoshi-Audit
**File:** internal/system/process.go
**Language:** go
**Lines:** 24-50
**Complexity:** 6.0

---

## Source Code

```go
func GetProcesses() ([]ProcessInfo, error) {
	entries, err := os.ReadDir("/proc")
	if err != nil {
		return nil, err
	}

	var procs []ProcessInfo
	for _, entry := range entries {
		if !entry.IsDir() {
			continue
		}

		pid, err := strconv.Atoi(entry.Name())
		if err != nil {
			continue
		}

		info, err := readProcessInfo(pid)
		if err != nil {
			continue
		}

		procs = append(procs, info)
	}

	return procs, nil
}
```

---

## Security Review

### Security Review for `GetProcesses` Function

**Vulnerabilities and Severity:**

1. **Input Validation Gap - Medium**
   - Line 7: The function reads all entries in `/proc`, which is not inherently dangerous, but could be improved to validate or filter out certain processes.

2. **Error Handling - Info**
   - Lines 4-6: Error handling is minimal and could return more specific errors for better debugging and security.

**Attack Vectors:**

- An attacker could exploit the lack of filtering by renaming or creating files in `/proc` that might cause unintended behavior, though this is unlikely given the nature of the directory.

**Recommended Fixes:**

1. **Add Process Filtering:**
   ```go
   for _, entry := range entries {
       if !entry.IsDir() || entry.Name() < "0" || entry.Name() > "99999" { // Adjust range as necessary
           continue
       }
       pid, err := strconv.Atoi(entry.Name())
       if err != nil {
           continue
       }

       info, err := readProcessInfo(pid)
       if err != nil {
           log.Printf("Failed to get process info for PID %d: %v", pid, err)
           continue
       }

       procs = append(procs, info)
   }
   ```

2. **Enhance Error Handling:**
   ```go
   return procs, fmt.Errorf("failed to read directory: %w", err)
   ```

**Overall Security Posture:**

The current implementation is relatively secure but could benefit from better input validation and more robust error handling. Adding these improvements will enhance the security posture of the function by preventing potential misuse and improving debuggability.

---

*Generated by CodeWorm on 2026-03-02 01:11*
