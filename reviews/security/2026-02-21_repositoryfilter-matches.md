# RepositoryFilter.matches

**Type:** Security Review
**Repository:** kill-pr0cess.inc
**File:** backend/src/models/github.rs
**Language:** rust
**Lines:** 347-444
**Complexity:** 29.0

---

## Source Code

```rust
fn matches(&self, repo: &Repository) -> bool {
        if let Some(ref lang) = self.language {
            if repo.language.as_ref() != Some(lang) {
                return false;
            }
        }

        if let Some(min_stars) = self.min_stars {
            if repo.stargazers_count < min_stars {
                return false;
            }
        }

        if let Some(max_stars) = self.max_stars {
            if repo.stargazers_count > max_stars {
                return false;
            }
        }

        if let Some(min_size) = self.min_size_kb {
            if repo.size_kb < min_size {
                return false;
            }
        }

        if let Some(max_size) = self.max_size_kb {
            if repo.size_kb > max_size {
                return false;
            }
        }

        if let Some(is_fork) = self.is_fork {
            if repo.is_fork != is_fork {
                return false;
            }
        }

        if let Some(is_archived) = self.is_archived {
            if repo.is_archived != is_archived {
                return false;
            }
        }

        if let Some(has_topics) = self.has_topics {
            let empty = repo.topics.as_ref().map(|t| t.is_empty()).unwrap_or(true);
            if empty == has_topics {
                return false;
            }
        }

        if let Some(has_license) = self.has_license {
            if repo.license_name.is_some() != has_license {
                return false;
            }
        }

        if let Some(created_after) = self.created_after {
            if repo.created_at < created_after {
                return false;
            }
        }

        if let Some(created_before) = self.created_before {
            if repo.created_at > created_before {
                return false;
            }
        }

        if let Some(updated_after) = self.updated_after {
            if repo.updated_at < updated_after {
                return false;
            }
        }

        if let Some(updated_before) = self.updated_before {
            if repo.updated_at > updated_before {
                return false;
            }
        }

        if let Some(ref query) = self.search_query {
            let search_text = format!(
                "{} {} {}",
                repo.name,
                repo.description.as_deref().unwrap_or(""),
                                      repo.topics
                                          .as_ref()
                                          .map(|v| v.join(" "))
                                          .unwrap_or_default()
            ).to_lowercase();

            if !search_text.contains(&query.to_lowercase()) {
                return false;
            }
        }

        true
    }
```

---

## Security Review

### Security Review

#### Vulnerabilities Found:

**Info: Input Validation Gaps**
- **Line 56**: The `search_query` validation is case-insensitive but does not handle special characters or SQL injection attacks, which could be exploited if the query is constructed from untrusted input.

**Recommendation:**
- Use a library like `regex` to safely validate and sanitize the search query. For example:
  ```rust
  use regex::Regex;

  let re = Regex::new(&query).unwrap();
  if !re.is_match(&search_text) {
      return false;
  }
  ```

#### Attack Vectors:

- An attacker could inject malicious characters into `self.search_query`, potentially leading to unexpected behavior or security issues.

#### Overall Security Posture:

The code is robust in filtering repositories based on various criteria but lacks protection against potential injection attacks. By implementing proper input validation, the overall security posture can be significantly improved.

### Severity Ratings:
- **Info**: Input validation gaps - Low

By addressing these issues, you enhance the security of your application and protect it from potential vulnerabilities.

---

*Generated by CodeWorm on 2026-02-21 09:47*
