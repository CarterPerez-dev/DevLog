# validate

**Type:** Security Review
**Repository:** fullstack-template
**File:** stacks/go-react/go-backend/internal/config/config.go
**Language:** go
**Lines:** 248-290
**Complexity:** 13.0

---

## Source Code

```go
func validate(c *Config) error {
	if c.Database.URL == "" {
		return fmt.Errorf("DATABASE_URL is required")
	}

	if c.Redis.URL == "" {
		return fmt.Errorf("REDIS_URL is required")
	}

	if c.JWT.PrivateKeyPath == "" {
		return fmt.Errorf("JWT_PRIVATE_KEY_PATH is required")
	}

	if c.JWT.PublicKeyPath == "" {
		return fmt.Errorf("JWT_PUBLIC_KEY_PATH is required")
	}

	if c.CORS.AllowCredentials {
		for _, origin := range c.CORS.AllowedOrigins {
			if origin == "*" {
				return fmt.Errorf(
					"CORS wildcard '*' cannot be used with AllowCredentials",
				)
			}
		}
	}

	if c.App.Environment == "production" {
		if c.Otel.Enabled && c.Otel.Insecure {
			return fmt.Errorf("OTEL_INSECURE must be false in production")
		}
	}

	if c.Server.ReadTimeout <= 0 {
		return fmt.Errorf("server.read_timeout must be positive")
	}

	if c.Server.WriteTimeout <= 0 {
		return fmt.Errorf("server.write_timeout must be positive")
	}

	return nil
}
```

---

## Security Review

### Security Review for `validate` Function

**Vulnerabilities Found:**

1. **Hardcoded Secrets or Credentials**: None directly visible, but ensure environment variables are used instead of hardcoded paths.
   - **Severity**: Low
   - **Fix**: Use environment variables for keys and URLs.

2. **Input Validation Gaps**: The function does not validate the contents of `c.CORS.AllowedOrigins` or other fields that could be misused.
   - **Severity**: Medium
   - **Fix**: Validate each element in `c.CORS.AllowedOrigins` to ensure they are valid URLs.

3. **Error Handling**: Error messages provide minimal information, which might leak sensitive details.
   - **Severity**: Info
   - **Fix**: Use generic error messages like "Invalid configuration" instead of specific error messages.

**Attack Vectors:**

- Misconfigured CORS policies could allow unauthorized access if `AllowCredentials` is set and origins are improperly validated.
- Production environment misconfigurations, such as insecure OpenTelemetry settings, can expose the application to security risks.

**Recommended Fixes:**

1. Validate each element in `c.CORS.AllowedOrigins`:
   ```go
   for _, origin := range c.CORS.AllowedOrigins {
       if !isValidURL(origin) {
           return fmt.Errorf("invalid allowed origin: %s", origin)
       }
   }
   ```

2. Use environment variables instead of hardcoded paths:
   ```go
   if c.JWT.PrivateKeyPath == "" {
       return fmt.Errorf("JWT_PRIVATE_KEY_PATH is required")
   }
   ```

3. Improve error messages to be more generic.

**Overall Security Posture:**

The function addresses basic validation but lacks comprehensive input validation and secure error handling. Improving these areas will enhance the security posture of the application.

---

*Generated by CodeWorm on 2026-02-20 11:17*
