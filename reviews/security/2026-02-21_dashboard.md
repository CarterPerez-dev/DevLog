# dashboard

**Type:** Security Review
**Repository:** CodeWorm
**File:** codeworm/cli.py
**Language:** python
**Lines:** 347-371
**Complexity:** 3.0

---

## Source Code

```python
def dashboard(ctx: click.Context, host: str | None, port: int | None) -> None:
    """
    Start the web dashboard server
    """
    import uvicorn

    settings = load_settings(config_dir = ctx.obj["config_dir"])

    bind_host = host or settings.dashboard.host
    bind_port = port or settings.dashboard.port

    console.print("[bold green]Starting CodeWorm Dashboard[/bold green]")
    console.print(f"  URL: http://{bind_host}:{bind_port}")
    console.print(f"  Redis: {settings.dashboard.redis.connection_url}")

    os.environ["CODEWORM_DB_PATH"] = str(settings.db_path)
    os.environ["CODEWORM_REDIS_URL"] = settings.dashboard.redis.connection_url
    os.environ["CODEWORM_CONFIG_DIR"] = str(settings.config_dir)

    uvicorn.run(
        "dashboard.backend.app:app",
        host = bind_host,
        port = bind_port,
        log_level = "info",
    )
```

---

## Security Review

### Security Review for `dashboard` Function

#### Vulnerabilities Found:

1. **Hardcoded Secrets or Credentials:**
   - **Severity:** High
   - **Line:** N/A
   - **Issue:** The environment variables `os.environ["CODEWORM_DB_PATH"]`, `os.environ["CODEWORM_REDIS_URL"]`, and `os.environ["CODEWORM_CONFIG_DIR"]` are set to hardcoded values from the settings object. This can expose sensitive information if the codebase is compromised.

2. **Input Validation Gaps:**
   - **Severity:** Medium
   - **Line:** 7-10
   - **Issue:** The `host` and `port` parameters are directly used without validation or sanitization, which could lead to injection attacks (e.g., command injection if `bind_host` is user-controlled).

3. **Insecure Deserialization:**
   - **Severity:** Info
   - **Line:** N/A
   - **Issue:** No deserialization operations are present in the code snippet.

4. **Error Handling:**
   - **Severity:** Low
   - **Line:** 15-20
   - **Issue:** The error handling for `uvicorn.run` is not shown, which could leak information about the server setup if an exception occurs.

#### Attack Vectors:

- An attacker could exploit the lack of input validation to inject malicious commands or URLs.
- Hardcoded secrets can be extracted from environment variables if the codebase is leaked.

#### Recommended Fixes:

1. **Hardcoded Secrets:**
   - Use environment variables or a secure vault for sensitive information.
   - Example:
     ```python
     os.environ["CODEWORM_DB_PATH"] = settings.db_path
     ```

2. **Input Validation:**
   - Validate and sanitize `host` and `port` inputs to prevent injection attacks.

3. **Error Handling:**
   - Implement proper error handling for `uvicorn.run`.

4. **Overall Security Posture:**
   - Ensure all user inputs are validated.
   - Use environment variables or secure vaults for sensitive information.
   - Regularly review and update security practices.

By addressing these issues, the overall security posture of the application can be significantly improved.

---

*Generated by CodeWorm on 2026-02-21 16:14*
