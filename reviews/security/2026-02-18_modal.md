# Modal

**Type:** Security Review
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/encrypted-p2p-chat/frontend/src/components/UI/Modal.tsx
**Language:** tsx
**Lines:** 18-117
**Complexity:** 16.0

---

## Source Code

```tsx
function Modal(props: ModalProps): JSX.Element {
  const size = (): Size => props.size ?? "md"
  const closeOnOverlayClick = (): boolean => props.closeOnOverlayClick ?? true
  const showCloseButton = (): boolean => props.showCloseButton ?? true

  const handleOverlayClick = (e: MouseEvent): void => {
    if (e.target === e.currentTarget && closeOnOverlayClick()) {
      props.onClose()
    }
  }

  const handleKeyDown = (e: KeyboardEvent): void => {
    if (e.key === "Escape") {
      props.onClose()
    }
  }

  createEffect(() => {
    if (props.isOpen) {
      document.addEventListener("keydown", handleKeyDown)
      document.body.style.overflow = "hidden"
    }

    onCleanup(() => {
      document.removeEventListener("keydown", handleKeyDown)
      document.body.style.overflow = ""
    })
  })

  const handleOverlayKeyDown = (e: KeyboardEvent): void => {
    if (e.key === "Enter" || e.key === " ") {
      e.preventDefault()
      if (closeOnOverlayClick()) {
        props.onClose()
      }
    }
  }

  return (
    <Show when={props.isOpen}>
      <div
        class="fixed inset-0 z-50 flex items-center justify-center p-4"
        role="button"
        tabIndex={0}
        onClick={handleOverlayClick}
        onKeyDown={handleOverlayKeyDown}
        aria-label="Close modal overlay"
      >
        <div class="absolute inset-0 bg-black/80 animate-fade-in" />

        <div
          class={`
            relative z-10 w-full
            bg-black border-4 border-orange
            shadow-[8px_8px_0_var(--color-orange)]
            animate-scale-in
            ${SIZE_CLASSES[size()]}
          `}
          role="dialog"
          aria-modal="true"
          aria-labelledby={props.title ? "modal-title" : undefined}
        >
          <Show when={(props.title !== undefined && props.title !== "") || showCloseButton()}>
            <div class="flex items-start justify-between p-4 border-b-2 border-orange">
              <div class="flex-1">
                <Show when={props.title}>
                  <h2
                    id="modal-title"
                    class="font-pixel text-sm text-orange uppercase"
                  >
                    {props.title}
                  </h2>
                </Show>
                <Show when={props.description}>
                  <p class="font-pixel text-[10px] text-gray mt-1">
                    {props.description}
                  </p>
                </Show>
              </div>

              <Show when={showCloseButton()}>
                <IconButton
                  icon={<CloseIcon />}
                  ariaLabel="Close modal"
                  onClick={props.onClose}
                  size="sm"
                  variant="ghost"
                />
              </Show>
            </div>
          </Show>

          <div class="p-4">
            {props.children}
          </div>
        </div>
      </div>
    </Show>
  )
}
```

---

## Security Review

### Security Review for `Modal` Component

#### Vulnerabilities Found:

1. **Info - Input Validation Gaps:**
   - Line 16-17, 25-26, and 38-39: The `size`, `closeOnOverlayClick`, and `showCloseButton` functions use optional chaining (`??`) to provide default values but do not validate the input. Ensure that these props are properly validated.

2. **Info - Error Handling:**
   - Lines 14, 20, and 35: The event handlers handle specific key events without comprehensive error handling. Consider adding try-catch blocks or logging errors to prevent information leakage.

#### Attack Vectors:

- An attacker could manipulate the `size`, `closeOnOverlayClick`, or `showCloseButton` props to potentially alter the component's behavior in unintended ways.
- Improper error handling might leak stack traces or other sensitive information through console logs.

#### Recommended Fixes:

1. **Input Validation:**
   - Ensure that `props.size` is one of the expected values (e.g., "sm", "md", "lg").
   - Validate `closeOnOverlayClick` and `showCloseButton` to be boolean values.
   
2. **Error Handling:**
   - Add try-catch blocks around event handlers to catch and handle any potential errors gracefully.

#### Overall Security Posture:

The component is relatively secure but could benefit from proper input validation and error handling. Improving these areas will enhance the overall security posture of the application.

---

*Generated by CodeWorm on 2026-02-18 09:19*
