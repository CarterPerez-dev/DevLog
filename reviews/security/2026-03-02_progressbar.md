# ProgressBar

**Type:** Security Review
**Repository:** Yoshi-Audit
**File:** internal/ui/theme/theme.go
**Language:** go
**Lines:** 91-116
**Complexity:** 5.0

---

## Source Code

```go
func ProgressBar(percent float64, width int) string {
	if percent < 0 {
		percent = 0
	}
	if percent > 100 {
		percent = 100
	}

	filled := int(percent / 100 * float64(width))
	empty := width - filled

	filledStr := repeatChar('▓', filled)
	emptyStr := repeatChar('░', empty)

	var style lipgloss.Style
	switch {
	case percent > 85:
		style = BarCrit
	case percent >= 65:
		style = BarWarn
	default:
		style = BarOK
	}

	return style.Render(filledStr) + HelpStyle.Render(emptyStr)
}
```

---

## Security Review

### Security Review for `ProgressBar` Function

#### Vulnerabilities Found:

1. **Input Validation Gaps** (Line 5-7, Severity: Low):
   - The function does not validate the input types of `percent` and `width`. While the logic handles out-of-bound values, it could be improved to ensure only valid integers are passed.

2. **Error Handling** (Severity: Info):
   - No explicit error handling is present for potential errors in `repeatChar` or style rendering functions.

#### Attack Vectors:

- An attacker could pass invalid types or extreme values that might cause unexpected behavior, though this is mitigated by the current validation logic.

#### Recommended Fixes:

1. **Input Validation**:
   ```go
   if width <= 0 {
       return "Invalid width"
   }
   ```

2. **Error Handling**:
   Add error handling for potential failures in `repeatChar` and style rendering functions.
   ```go
   filledStr, err := repeatChar('▓', filled)
   if err != nil {
       return fmt.Sprintf("Error: %v", err)
   }

   emptyStr, err := repeatChar('░', empty)
   if err != nil {
       return fmt.Sprintf("Error: %v", err)
   }
   ```

#### Overall Security Posture:

The current implementation is secure but could benefit from more robust input validation and error handling. Ensuring that the function handles edge cases gracefully will further enhance its security posture.

Fixing these issues will make the code more resilient to unexpected inputs and improve its overall reliability.

---

*Generated by CodeWorm on 2026-03-02 00:46*
