# CertificationFactory.create

**Type:** Security Review
**Repository:** my-portfolio
**File:** v1/backend/conftest.py
**Language:** python
**Lines:** 373-403
**Complexity:** 4.0

---

## Source Code

```python
async def create(
        cls,
        session: AsyncSession,
        *,
        language: Language = Language.ENGLISH,
        name: str | None = None,
        issuer: str | None = None,
        date_obtained: date | None = None,
        expiry_date: date | None = None,
        is_expired: bool = False,
        category: CertificationCategory = CertificationCategory.CLOUD,
        is_visible: bool = True,
    ) -> Certification:
        cls._counter += 1

        certification = Certification(
            language = language,
            name = name or f"Test Certification {cls._counter}",
            issuer = issuer or f"Test Issuer {cls._counter}",
            date_obtained = date_obtained or date(2024,
                                                  1,
                                                  1),
            expiry_date = expiry_date,
            is_expired = is_expired,
            category = category,
            is_visible = is_visible,
        )
        session.add(certification)
        await session.flush()
        await session.refresh(certification)
        return certification
```

---

## Security Review

### Security Review

**Vulnerabilities Found:**

1. **Input Validation Gaps (Medium):**
   - The `name` and `issuer` parameters are optional but not validated for length or content, which could allow injection attacks.
   - **Severity:** Medium
   - **Attack Vector:** Malicious input could be injected into the database.

2. **Hardcoded Secrets or Credentials (Info):**
   - No hardcoded secrets or credentials found in this snippet.

3. **Insecure Deserialization (Low):**
   - No deserialization operations are present, so this is not applicable here.
   - **Severity:** Low

4. **Error Handling that Leaks Information (Info):**
   - The function does not handle errors explicitly, but the context of `AsyncSession` suggests it might be handled elsewhere.

5. **Overall Security Posture:**
   - The code is generally secure with no critical or high-severity issues. However, input validation needs improvement to prevent potential injection attacks.

### Recommended Fixes:

1. **Input Validation (Medium):**
   - Add validation for `name` and `issuer` parameters:
     ```python
     from typing import Optional

     def validate_name(name: str) -> bool:
         return len(name.strip()) > 0 and name.isalnum()

     def validate_issuer(issuer: str) -> bool:
         return len(issuer.strip()) > 0 and issuer.isalnum()

     if not validate_name(name):
         raise ValueError("Name must be alphanumeric and non-empty")

     if not validate_issuer(issuer):
         raise ValueError("Issuer must be alphanumeric and non-empty")
     ```

2. **Error Handling (Info):**
   - Ensure proper error handling in the surrounding code to avoid information leakage.

By addressing these points, you can significantly enhance the security posture of your application.

---

*Generated by CodeWorm on 2026-02-21 12:05*
