# BlogPage

**Type:** Security Review
**Repository:** CertGames-Core
**File:** frontend/user-app/src/domains/public/landing/ui/blog.page.tsx
**Language:** tsx
**Lines:** 26-396
**Complexity:** 50.0

---

## Source Code

```tsx
function BlogPage(): React.ReactElement {
  const { slug } = useParams<{ slug: string }>();
  const {
    data: blog,
    isLoading,
    error,
  } = useGetBlogDetail(slug ?? '', {
    enabled: slug !== undefined && slug.length > 0,
  });

  const { mutate: likeBlog } = useIncrementBlogLike();
  const { mutate: shareBlog } = useIncrementBlogShare();

  useEffect(() => {
    window.scrollTo(0, 0);
  }, [slug]);

  useSeoMeta({
    title: blog?.metaTitle ?? blog?.title ?? 'Blog Article | CertGames',
    description:
      blog?.metaDescription ??
      blog?.excerpt ??
      'Read our latest cybersecurity insights and certification guides.',
    canonicalUrl: blog?.canonicalUrl ?? `/blog/${slug ?? ''}`,
    keywords:
      blog?.metaKeywords?.join(', ') ??
      blog?.tags?.join(', ') ??
      'cybersecurity, certification, blog',
    ogImage:
      blog?.ogImage ??
      blog?.featuredImage ??
      '/blogImages/certgames-vs-trash.webp',
    ogType: 'article',
    ...(blog?.author !== undefined && blog?.author !== null
      ? { author: blog.author }
      : {}),
    jsonLd:
      blog !== null && blog !== undefined
        ? [
            createBreadcrumbSchema([
              { position: 1, name: 'Home', item: '/' },
              { position: 2, name: 'Blog', item: '/blogs' },
              { position: 3, name: blog.title, item: `/blog/${slug ?? ''}` },
            ]),
            {
              '@context': 'https://schema.org',
              '@type': 'BlogPosting',
              'headline': blog.title,
              'description': blog.excerpt,
              'author': {
                '@type': 'Person',
                'name': blog.author,
                ...(blog.authorTitle !== null && blog.authorTitle !== ''
                  ? { jobTitle: blog.authorTitle }
                  : {}),
                ...(blog.authorBio !== null && blog.authorBio !== ''
                  ? { description: blog.authorBio }
                  : {}),
                ...(blog.authorImage !== null && blog.authorImage !== ''
                  ? { image: blog.authorImage }
                  : {}),
              },
              'datePublished': blog.publishedAt,
              'dateModified': blog.lastUpdated ?? blog.publishedAt,
              'image': blog.featuredImage ?? undefined,
              'publisher': {
                '@type': 'Organization',
                'name': 'CertGames',
                'logo': {
                  '@type': 'ImageObject',
                  'url':
                    'https://certgames.com/assets/certgames-social.webp',
                },
              },
              'mainEntityOfPage': {
                '@type': 'WebPage',
                '@id': `https://certgames.com/blog/${slug ?? ''}`,
              },
              'keywords': blog.tags.join(', '),
              'articleSection': blog.category,
              'wordCount': blog.content.split(' ').length,
              'commentCount': blog.commentCount,
            },
            .
```

---

## Security Review

### Security Review for `BlogPage` Component

#### Vulnerabilities Found:

1. **XSS (Cross-Site Scripting)**: 
   - **Severity**: Medium
   - **Line 57, 62, 80**: The `blog.excerpt`, `blog.title`, and other dynamic content are directly used in the SEO metadata without proper sanitization or escaping. This can lead to XSS attacks if user-generated content contains malicious scripts.
   
2. **Hardcoded Secrets**:
   - **Severity**: Info
   - **Line 80**: The hard-coded URL for social sharing (`window.location.href`) is not a security issue but could be considered best practice to avoid exposing internal URLs.

3. **Input Validation Gaps**:
   - **Severity**: Low
   - **Lines 21, 54**: While `slug` validation is present, more thorough input sanitization and validation should be applied to prevent unexpected behavior or injection attacks.

#### Attack Vectors:

- An attacker could inject malicious scripts into the blog content, which would then be reflected in the SEO metadata and potentially executed by users.
- Improper handling of dynamic URLs might expose sensitive information.

#### Recommended Fixes:

1. **Sanitize User Input**:
   - Use libraries like `DOMPurify` to sanitize user-generated content before using it in the SEO metadata.
   ```tsx
   const sanitizedExcerpt = DOMPurify.sanitize(blog.excerpt);
   ```

2. **Enhance Input Validation**:
   - Implement more robust validation for `slug` and other dynamic inputs to ensure they only contain allowed characters.

3. **Secure URLs**:
   - Use relative URLs or environment variables for URLs to avoid exposing internal paths.
   ```tsx
   const shareUrl = `${window.location.origin}/blog/${slug}`;
   ```

#### Overall Security Posture:

The current code has some security gaps, particularly in handling user-generated content and input validation. Addressing these issues will significantly improve the overall security posture of the `BlogPage` component.

**Severity Ratings:**
- XSS (Cross-Site Scripting): Medium
- Hardcoded Secrets: Info
- Input Validation Gaps: Low

---

*Generated by CodeWorm on 2026-02-19 12:31*
