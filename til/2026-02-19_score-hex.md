# _score_hex

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 127-169
**Complexity:** 16.0

---

## Source Code

```python
def _score_hex(data: str) -> float:
    stripped = data.strip()
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0

    hex_only = stripped
    for sep in HEX_SEPARATORS:
        hex_only = hex_only.replace(sep, "")

    if not hex_only:
        return 0.0
    if not all(c in HEX_CHARSET for c in hex_only):
        return 0.0
    if len(hex_only) % 2 != 0:
        return 0.0

    score = W.HEX_BASE

    has_separators = any(sep in stripped for sep in HEX_SEPARATORS)
    if has_separators:
        score += W.HEX_SEPARATOR_PRESENT

    has_alpha = any(c in "abcdefABCDEF" for c in hex_only)
    if has_alpha:
        score += W.HEX_ALPHA_CHARS
    else:
        score -= W.HEX_NO_ALPHA_PENALTY

    is_consistent_case = (hex_only == hex_only.lower() or hex_only == hex_only.upper())
    if is_consistent_case:
        score += W.HEX_CONSISTENT_CASE

    if len(hex_only) >= 8:
        score += W.LONGER_INPUT

    decoded = try_decode(stripped, EncodingFormat.HEX)
    if decoded is None:
        return 0.0
    score += W.HEX_DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Today I Learned

TIL: The `_score_hex` function uses a scoring system to evaluate hex strings, incrementing and decrementing a score based on various conditions. This clever approach ensures that only valid, high-quality hex inputs receive higher scores, making it an effective filtering mechanism.

```python
# Example breakdown:
hex_str = "1a2b3c"
score = 0.0
if len(hex_str) >= 8: score += W.LONGER_INPUT
if is_printable_text(try_decode(hex_str)): score += W.PRINTABLE_RESULT
```

This pattern simplifies complex validation logic into a readable, incremental scoring process.

---

*Generated by CodeWorm on 2026-02-19 10:31*
