# ExperienceFactory.create

**Type:** Today I Learned
**Repository:** my-portfolio
**File:** v1/backend/conftest.py
**Language:** python
**Lines:** 326-359
**Complexity:** 4.0

---

## Source Code

```python
async def create(
        cls,
        session: AsyncSession,
        *,
        language: Language = Language.ENGLISH,
        company: str | None = None,
        role: str | None = None,
        start_date: date | None = None,
        end_date: date | None = None,
        is_current: bool = False,
        description: str | None = None,
        employment_type: EmploymentType = EmploymentType.FULL_TIME,
        is_visible: bool = True,
    ) -> Experience:
        cls._counter += 1

        experience = Experience(
            language = language,
            company = company or f"Test Company {cls._counter}",
            role = role or f"Software Engineer {cls._counter}",
            start_date = start_date or date(2023,
                                            1,
                                            1),
            end_date = end_date,
            is_current = is_current,
            description = description
            or f"Experience description {cls._counter}",
            employment_type = employment_type,
            is_visible = is_visible,
        )
        session.add(experience)
        await session.flush()
        await session.refresh(experience)
        return experience
```

---

## Today I Learned

TIL: In the `create` method, the class uses a class variable `_counter` to generate unique company and role names if not provided. This clever approach ensures each created experience has distinct identifiers, making debugging easier.

```python
cls._counter += 1
experience = Experience(
    # ... other fields ...
    company=company or f"Test Company {cls._counter}",
    role=role or f"Software Engineer {cls._counter}",
)
```

This pattern is both concise and effective for handling default values dynamically.

---

*Generated by CodeWorm on 2026-02-21 20:13*
