# PdfFormatter.format

**Type:** Today I Learned
**Repository:** CertGames-Core
**File:** frontend/admin-app/src/lib/export/formatters/pdfFormatter.ts
**Language:** typescript
**Lines:** 20-126
**Complexity:** 19.0

---

## Source Code

```typescript
format(data: T[], config: ExportConfig<T>, options: ExportOptions): void {
    try {
      if (data === null || data === undefined) {
        throw new Error('Data is required for export');
      }

      if (!Array.isArray(data)) {
        throw new Error('Data must be an array');
      }

      const orientation = config.pdfOrientation ?? 'landscape';
      const pageSize = config.pdfPageSize ?? 'a4';
      const pdf = new jsPDF(orientation, 'mm', pageSize);

      const primaryColor: [number, number, number] = [99, 102, 241]; // $primary-500
      const textColor: [number, number, number] = [31, 41, 55]; // $gray-800
      const headerBg: [number, number, number] = [243, 244, 246]; // $gray-100

      const title = options.title ?? 'Data Export';
      pdf.setFontSize(18);
      pdf.setTextColor(...primaryColor);
      pdf.text(title, 14, 20);

      let yPosition = 25;
      if (
        options.description !== null &&
        options.description !== undefined &&
        options.description.length > 0
      ) {
        pdf.setFontSize(10);
        pdf.setTextColor(...textColor);
        pdf.text(options.description, 14, yPosition);
        yPosition += 5;
      }

      if (options.includeMetadata === true) {
        pdf.setFontSize(9);
        pdf.setTextColor(100, 100, 100);
        pdf.text(
          `Exported: ${format(new Date(), 'MMM dd, yyyy HH:mm')}`,
          14,
          yPosition,
        );
        pdf.text(`Records: ${String(data.length)}`, 14, yPosition + 4);
        yPosition += 10;
      }

      const tableData = this.prepareTableData(data, config);

      const headers = config.columns.map((col) => col.label);

      const columnWidths = this.calculateColumnWidths(config, orientation);

      autoTable(pdf, {
        head: [headers],
        body: tableData,
        startY: yPosition,
        theme: 'grid',
        headStyles: {
          fillColor: headerBg,
          textColor,
          fontSize: 10,
          fontStyle: 'bold',
        },
        bodyStyles: {
          fontSize: 9,
          cellPadding: 3,
        },
        alternateRowStyles: {
          fillColor: [249, 250, 251], // $gray-50
        },
        columnStyles: this.getColumnStyles(config, columnWidths),
        margin: { top: yPosition, left: 14, right: 14 },
        didDrawPage: (_hookData): void => {
          const pageCount = pdf.getNumberOfPages();
          pdf.setFontSize(8);
          pdf.setTextColor(150, 150, 150);

          for (let i = 1; i <= pageCount; i++) {
            pdf.setPage(i);
            const pageText = `Page ${String(i)} of ${String(pageCount)}`;
            const pageWidth = pdf.internal.pageSize.getWidth();
            pdf.text(
              pageText,
              pageWidth - 30,
              pdf.internal.pageSize.getHeight() - 10,
            );
          }
        },
      });

      const timestamp = format(new Date(), 'yyyy-MM-dd-HHmmss');
      const filename =
        options.filename ?? config.defaultFilename
```

---

## Today I Learned

TIL: In TypeScript, you can use optional chaining and nullish coalescing to handle potential `null` or `undefined` values elegantly. For example:

```typescript
const orientation = config.pdfOrientation ?? 'landscape';
```

This line sets `orientation` to the value of `config.pdfOrientation` if it exists; otherwise, it defaults to `'landscape'`. Clever and concise!

---

*Generated by CodeWorm on 2026-02-19 17:12*
