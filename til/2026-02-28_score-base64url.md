# _score_base64url

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/base64-tool/src/base64_tool/detector.py
**Language:** python
**Lines:** 95-119
**Complexity:** 11.0

---

## Source Code

```python
def _score_base64url(data: str) -> float:
    stripped = "".join(data.split())
    if len(stripped) < MIN_INPUT_LENGTH:
        return 0.0
    if not all(c in BASE64URL_CHARSET for c in stripped):
        return 0.0

    score = W.B64URL_BASE

    has_url_chars = any(c in stripped for c in "-_")
    has_std_chars = any(c in stripped for c in "+/")

    if has_url_chars and not has_std_chars:
        score += W.B64URL_SAFE_CHARS
    elif not has_url_chars:
        return 0.0

    decoded = try_decode(stripped, EncodingFormat.BASE64URL)
    if decoded is None:
        return 0.0
    score += W.DECODE_SUCCESS
    if is_printable_text(decoded):
        score += W.PRINTABLE_RESULT

    return min(score, 1.0)
```

---

## Today I Learned

TIL: The `_score_base64url` function cleverly uses early returns and conditional scoring to validate and score Base64URL strings efficiently. By checking for essential conditions like character set validity and length first, it minimizes unnecessary processing. This approach ensures the function is both concise and effective in assessing input quality.

---

*Generated by CodeWorm on 2026-02-28 23:00*
