# email_validator

**Type:** Today I Learned
**Repository:** CertGames-Core
**File:** backend/api/domains/account/middleware/schemas.py
**Language:** python
**Lines:** 197-240
**Complexity:** 13.0

---

## Source Code

```python
def email_validator(email: str) -> str:
    """
    Validates an email with strict rules:
    """
    errors = []
    if not email:
        raise ValueError("Email is required.")

    email_nfc = trim_and_normalize(email).lower()

    if not AuthConfig.Email.MIN_LENGTH <= len(
            email_nfc) <= AuthConfig.Email.MAX_LENGTH:
        errors.append(
            f"Email length must be between {AuthConfig.Email.MIN_LENGTH} and {AuthConfig.Email.MAX_LENGTH} characters."
        )

    for ch in email_nfc:
        if ch in AuthConfig.Email.FORBIDDEN_CHARS:
            errors.append(
                "Email contains forbidden characters like <, >, or whitespace."
            )
            break

    if email_nfc.count("@") != 1:
        errors.append("Email must contain exactly one '@' symbol.")
    else:
        parts = email_nfc.split("@")
        if len(parts) == 2:
            local_part, domain_part = parts
            if not local_part:
                errors.append("Email must have a local part before '@'.")
            if not domain_part:
                errors.append("Email must have a domain after '@'.")
            elif "." not in domain_part:
                errors.append(
                    "Email domain must contain at least one '.'."
                )
            elif domain_part.startswith(".") or domain_part.endswith("."):
                errors.append("Email domain cannot start or end with '.'.")

    if errors:
        raise ValueError("; ".join(errors))

    return str(email_nfc)
```

---

## Today I Learned

TIL: The `email_validator` function uses error accumulation through a list (`errors`) to gather all validation issues before raising a single `ValueError`. This approach ensures clear, concise error messages and simplifies complex validation logic, making it easier to maintain and extend.

---

*Generated by CodeWorm on 2026-02-28 01:50*
