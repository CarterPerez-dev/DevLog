# ConversionRates

**Type:** Today I Learned
**Repository:** CertGames-Core
**File:** frontend/admin-app/src/modules/revenue/components/conversion/ConversionRates.tsx
**Language:** tsx
**Lines:** 47-324
**Complexity:** 26.0

---

## Source Code

```tsx
function ConversionRates({
  data,
  dimension,
  isLoading,
  error,
}: ConversionRatesProps): React.JSX.Element {
  const getPlatformIcon = (platform: string): React.JSX.Element => {
    const lowerPlatform = platform.toLowerCase();
    if (lowerPlatform === 'web') {
      return <FiMonitor />;
    }
    if (lowerPlatform === 'ios' || lowerPlatform === 'android') {
      return <FiSmartphone />;
    }
    return <FiMonitor />;
  };

  const renderPlatformBreakdown = (): React.JSX.Element | null => {
    if (data === null || data === undefined || dimension !== 'platform') return null;

    const breakdown = data.breakdown;
    if (
      breakdown === null ||
      breakdown === undefined ||
      typeof breakdown !== 'object'
    ) {
      return null;
    }

    const platforms = Object.entries(breakdown)
      .map(([platform, metrics]) => {
        if (
          metrics !== null &&
          metrics !== undefined &&
          typeof metrics === 'object'
        ) {
          const platformData = metrics as Record<string, unknown>;
          return {
            platform,
            total_users: Number(platformData.total_users ?? 0),
            converted_users: Number(platformData.converted_users ?? 0),
            conversion_rate: Number(platformData.conversion_rate ?? 0),
          } as PlatformData;
        }
        return null;
      })
      .filter((item): item is PlatformData => item !== null);

    if (platforms.length === 0) {
      return (
        <div className={styles.emptyState}>
          <FiUsers />
          <span>No platform data available</span>
        </div>
      );
    }

    return (
      <div className={styles.platformGrid}>
        {platforms.map((platform) => (
          <div
            key={platform.platform}
            className={styles.platformCard}
          >
            <div className={styles.platformHeader}>
              <div className={styles.platformIcon}>
                {getPlatformIcon(platform.platform)}
              </div>
              <span className={styles.platformName}>
                {formatDisplayText(platform.platform)}
              </span>
            </div>

            <div className={styles.platformMetrics}>
              <div className={styles.metric}>
                <span className={styles.metricValue}>
                  {formatPercentage(platform.conversion_rate)}
                </span>
                <span className={styles.metricLabel}>Conversion Rate</span>
              </div>

              <div className={styles.metricDivider} />

              <div className={styles.metricStats}>
                <div className={styles.stat}>
                  <span className={styles.statValue}>
                    {formatNumber(platform.converted_users)}
                  </span>
                  <span className={styles.statLabel}>Converted</span>
                </div>
                <div className={styles.stat}>
                  <span className={styles.statValue}>
              
```

---

## Today I Learned

TIL: In `ConversionRates`, the function uses type assertions to cast object properties directly within array `.map()` calls, making the code concise and readable. This avoids redundant checks and keeps the logic focused on filtering and transforming data.

```tsx
const platformData = metrics as Record<string, unknown>;
return {
  platform,
  total_users: Number(platformData.total_users ?? 0),
  converted_users: Number(platformData.converted_users ?? 0),
  conversion_rate: Number(platformData.conversion_rate ?? 0),
} as PlatformData;
```

This pattern saves lines while ensuring type safety.

---

*Generated by CodeWorm on 2026-02-19 16:02*
