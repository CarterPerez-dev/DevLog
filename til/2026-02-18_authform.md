# AuthForm

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/encrypted-p2p-chat/frontend/src/components/Auth/AuthForm.tsx
**Language:** tsx
**Lines:** 23-184
**Complexity:** 15.0

---

## Source Code

```tsx
function AuthForm(props: AuthFormProps): JSX.Element {
  const [username, setUsername] = createSignal('')
  const [displayName, setDisplayName] = createSignal('')
  const [loading, setLoading] = createSignal(false)
  const [usernameError, setUsernameError] = createSignal<string | undefined>()
  const [displayNameError, setDisplayNameError] = createSignal<
    string | undefined
  >()

  const isRegister = (): boolean => props.mode === 'register'

  const title = (): string => (isRegister() ? 'CREATE ACCOUNT' : 'WELCOME BACK')

  const subtitle = (): string =>
    isRegister()
      ? 'REGISTER WITH A PASSKEY FOR SECURE, PASSWORDLESS AUTHENTICATION'
      : 'SIGN IN WITH YOUR PASSKEY TO CONTINUE'

  const validateForm = (): boolean => {
    let valid = true

    if (isRegister()) {
      const usernameResult = validateUsername(username())
      if (!usernameResult.valid) {
        setUsernameError(usernameResult.error)
        valid = false
      } else {
        setUsernameError(undefined)
      }

      const displayNameResult = validateDisplayName(displayName())
      if (!displayNameResult.valid) {
        setDisplayNameError(displayNameResult.error)
        valid = false
      } else {
        setDisplayNameError(undefined)
      }
    }

    return valid
  }

  const handleSubmit = async (): Promise<void> => {
    if (!validateForm()) {
      return
    }

    setLoading(true)

    try {
      if (isRegister()) {
        await authService.register(username(), displayName())
        showToast(
          'success',
          'REGISTRATION COMPLETE',
          'YOUR PASSKEY HAS BEEN CREATED'
        )
      } else {
        const trimmedUsername = username().trim()
        const usernameValue = trimmedUsername === '' ? undefined : trimmedUsername
        await authService.login(usernameValue)
        showToast('success', 'LOGIN SUCCESSFUL', 'WELCOME BACK')
      }
    } catch (error) {
      let message = 'AN UNEXPECTED ERROR OCCURRED'

      if (error instanceof ApiError) {
        message = error.message.toUpperCase()
      } else if (error instanceof Error) {
        if (error.name === 'NotAllowedError') {
          message = 'PASSKEY OPERATION CANCELLED'
        } else if (error.name === 'InvalidStateError') {
          message = 'PASSKEY ALREADY REGISTERED'
        } else {
          message = error.message.toUpperCase()
        }
      }

      showToast(
        'error',
        isRegister() ? 'REGISTRATION FAILED' : 'LOGIN FAILED',
        message
      )
    } finally {
      setLoading(false)
    }
  }

  return (
    <AuthCard title={title()} subtitle={subtitle()}>
      <div class="space-y-4">
        <Show when={isRegister()}>
          <Input
            name="username"
            label="USERNAME"
            placeholder="ENTER USERNAME"
            value={username()}
            onInput={setUsername}
            error={usernameError()}
            required
            disabled={loading()}
            fullWidth
          />

    
```

---

## Today I Learned

TIL: In the `AuthForm` component, the use of `createSignal` from Solid.js for state management is clever. It simplifies handling form inputs and errors by providing reactive signals that automatically update when values change, making the component more maintainable and easier to reason about.

```tsx
const [username, setUsername] = createSignal('')
const [usernameError, setUsernameError] = createSignal<string | undefined>()
```

This pattern ensures that state changes trigger re-renders, keeping the UI in sync with the form's current state.

---

*Generated by CodeWorm on 2026-02-18 18:59*
