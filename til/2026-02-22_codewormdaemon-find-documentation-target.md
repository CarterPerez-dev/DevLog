# CodeWormDaemon._find_documentation_target

**Type:** Today I Learned
**Repository:** CodeWorm
**File:** codeworm/daemon.py
**Language:** python
**Lines:** 392-442
**Complexity:** 11.0

---

## Source Code

```python
async def _find_documentation_target(self) -> DocumentationTarget | None:
        """
        Find a documentation target using weighted doc type selection
        Tries the selected type first, then falls back to others
        """
        type_weights = self.settings.documentation.type_weights
        redoc_days = self.settings.documentation.redocument_after_days
        enabled_repos = [r for r in self.settings.repos if r.enabled]

        selected_type = select_doc_type(type_weights)
        tried_types: set[DocType] = set()

        all_types = list(type_weights.keys())

        for type_str in [selected_type.value] + all_types:
            try:
                doc_type = DocType(type_str)
            except ValueError:
                continue

            if doc_type in tried_types:
                continue
            if doc_type in (DocType.WEEKLY_SUMMARY, DocType.MONTHLY_SUMMARY):
                continue
            tried_types.add(doc_type)

            for repo in enabled_repos:
                if repo.name in self.stats.repos_exhausted:
                    continue

                targets = self.target_router.find_targets(
                    doc_type = doc_type,
                    repo = repo,
                    limit = 30,
                )

                for target in targets:
                    if self.state.should_document(
                            target.snippet,
                            doc_type = doc_type,
                            redocument_after_days = redoc_days,
                    ):
                        self.logger.debug(
                            "target_found",
                            doc_type = doc_type.value,
                            target = target.display_name,
                            repo = repo.name,
                        )
                        return target

        return None
```

---

## Today I Learned

TIL: I learned about the weighted fallback strategy in `CodeWormDaemon._find_documentation_target`. The function first tries the selected type based on weights, then iteratively checks other types if the initial attempt fails. This ensures a thorough search while leveraging prioritization.

```python
for type_str in [selected_type.value] + all_types:
    doc_type = DocType(type_str)
    # ...
```

This pattern efficiently balances between specific and general approaches, making the code both flexible and targeted.

---

*Generated by CodeWorm on 2026-02-22 12:43*
