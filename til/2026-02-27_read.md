# read

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/metadata-scrubber-tool/src/commands/read.py
**Language:** python
**Lines:** 23-61
**Complexity:** 10.0

---

## Source Code

```python
def read(
    file_path: Path = typer.Argument(
        exists=True,  # Must exist on the filesystem
        file_okay=True,  # Can be a file
        dir_okay=True,  # Can be a directory
        readable=True,  # Must be readable (permissions check)
        resolve_path=True,  # Auto-convert to absolute path
        help="The path to the file you want to process",
    ),
    recursive: bool = typer.Option(False, "--recursive", "-r", help="Recursively process files in the specified directory."),
    ext: str = typer.Option(None,"--extension", "-ext", help="The file extension to filter by. eg: jpg, png, pdf"),
):
    if recursive and not ext:
        raise typer.BadParameter("If you provide --recursive or -r, you must also provide --extension or -ext.")
    if ext and not recursive:
        raise typer.BadParameter("If you provide --extension or -ext, you must also provide --recursive or -r.")

    for file in get_target_files(file_path, ext) if recursive else [file_path]:
        try:
            # Get the correct object from the factory
            handler = MetadataFactory.get_handler(str(file))

            # Read
            console.print(f"üîé Reading [bold cyan]{file.name}[/bold cyan]...")
            current_data = handler.read()
            if log.isEnabledFor(logging.DEBUG):
                # if verbose mode is enabled, log the Info
                log.info(f"Successfully read metadata from {file.name}")
            print_metadata_table(current_data)

        except Exception as e:
            # display error in console
            console.print(f"‚ùå [bold red]Skipped[/bold red] [cyan]{file.name}[/cyan]: [dim]{e}[/dim]")

            # LOG: Full technical details (Stack trace) for you to debug

            if log.isEnabledFor(logging.DEBUG):
                # if verbose mode is enabled, log the traceback
                log.error(f"Failed to read metadata from {file}", exc_info=True)
```

---

## Today I Learned

TIL: In the `read` function, the use of Typer's argument validation options (`exists`, `file_okay`, etc.) ensures robust command-line input handling. This makes the function more user-friendly by automatically checking file/directory existence and readability before execution.

```python
def read(
    file_path: Path = typer.Argument(...),
    recursive: bool = typer.Option(False, "--recursive", "-r"),
    ext: str = typer.Option(None, "--extension", "-ext"),
):
```

This pattern simplifies error handling and enhances user experience by preventing common issues at the argument parsing stage.

---

*Generated by CodeWorm on 2026-02-27 18:16*
