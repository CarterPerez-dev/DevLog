# Repository.calculate_activity_score

**Type:** Today I Learned
**Repository:** kill-pr0cess.inc
**File:** backend/src/models/github.rs
**Language:** rust
**Lines:** 213-264
**Complexity:** 12.0

---

## Source Code

```rust
pub fn calculate_activity_score(&self) -> f64 {
        let mut score = 0.0;

        // Stars contribute to score (logarithmic scale to prevent skewing)
        if self.stargazers_count > 0 {
            score += (self.stargazers_count as f64).ln() * 10.0;
        }

        // Recent activity bonus
        if let Some(pushed_at) = self.pushed_at {
            let days_since_push = (Utc::now() - pushed_at).num_days();
            if days_since_push < 30 {
                score += 20.0;
            } else if days_since_push < 90 {
                score += 10.0;
            }
        }

        // Fork ratio (indicates usefulness)
        if self.stargazers_count > 0 {
            let fork_ratio = self.forks_count as f64 / self.stargazers_count as f64;
            score += fork_ratio * 15.0;
        }

        // Issue management (lower open issues ratio is better)
        if self.open_issues_count > 0 {
            score -= (self.open_issues_count as f64).ln() * 2.0;
        }

        // Documentation (has description and topics)
        if self.description.is_some() {
            score += 5.0;
        }
        if let Some(topics) = &self.topics {
            if !topics.is_empty() {
                score += topics.len() as f64 * 2.0;
            }
        }

        // License indicates maturity
        if self.license_name.is_some() {
            score += 5.0;
        }

        // Penalize archived repositories
        if self.is_archived {
            score *= 0.5;
        }

        // Normalize to 0-100 scale
        score.max(0.0).min(100.0)
    }
```

---

## Today I Learned

TIL: In `calculate_activity_score`, Rust's logarithmic scoring for stargazers_count and open_issues_count prevents skewing towards repositories with many followers. This clever use of `.ln()` ensures that while popular repos get a boost, extremely popular ones don't dominate the score.

```rust
score += (self.stargazers_count as f64).ln() * 10.0;
score -= (self.open_issues_count as f64).ln() * 2.0;
```

This technique keeps scores more balanced and meaningful across different repository sizes!

---

*Generated by CodeWorm on 2026-02-21 12:19*
