# SQLiScanner._test_boolean_based_sqli

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/api-security-scanner/backend/scanners/sqli_scanner.py
**Language:** python
**Lines:** 141-214
**Complexity:** 15.0

---

## Source Code

```python
def _test_boolean_based_sqli(self) -> dict[str, Any]:
        """
        Test for boolean based blind SQL injection

        Compares responses from true vs false conditions to detect SQLi

        Returns:
            dict[str, Any]: Boolean based SQLi test results
        """
        try:
            baseline_response = self.make_request("GET", "/?id=1")
            baseline_length = len(baseline_response.text)
            baseline_status = baseline_response.status_code

            if baseline_status != 200:
                return {
                    "vulnerable": False,
                    "description": "Baseline request failed",
                    "baseline_status": baseline_status,
                }

            boolean_payloads = SQLiPayloads.BOOLEAN_BASED_BLIND
            true_payloads = [
                p for p in boolean_payloads
                if "AND '1'='1" in p or "AND 1=1" in p
            ]
            false_payloads = [
                p for p in boolean_payloads if "AND '1'='2" in p
                or "AND 1=2" in p or "AND 1=0" in p
            ]

            true_lengths = []
            for payload in true_payloads:
                response = self.make_request("GET", f"/?id={payload}")
                true_lengths.append(len(response.text))

            false_lengths = []
            for payload in false_payloads:
                response = self.make_request("GET", f"/?id={payload}")
                false_lengths.append(len(response.text))

            avg_true = statistics.mean(true_lengths)
            avg_false = statistics.mean(false_lengths)

            length_diff = abs(avg_true - avg_false)

            if length_diff > 100 and avg_true != avg_false:
                return {
                    "vulnerable":
                    True,
                    "baseline_length":
                    baseline_length,
                    "true_condition_avg_length":
                    avg_true,
                    "false_condition_avg_length":
                    avg_false,
                    "length_difference":
                    length_diff,
                    "confidence":
                    "HIGH" if length_diff > 500 else "MEDIUM",
                }

            return {
                "vulnerable": False,
                "description": "No boolean-based SQLi detected",
                "length_difference": length_diff,
            }

        except Exception as e:
            return {
                "vulnerable": False,
                "error": str(e),
                "description": "Error testing boolean-based SQLi",
            }
```

---

## Today I Learned

TIL: This function uses length comparison to detect boolean-based blind SQL injection by averaging response lengths from true and false payloads. Cleverly, it handles baseline checks and exception handling to ensure reliable results.

```python
true_lengths = [len(self.make_request("GET", f"/?id={payload}").text) for payload in true_payloads]
```

This list comprehension elegantly collects the length of responses for each true condition payload.

---

*Generated by CodeWorm on 2026-02-19 08:03*
