# login

**Type:** Today I Learned
**Repository:** angelamos-operations
**File:** CarterOS-Server/src/aspects/auth/routes/auth.py
**Language:** python
**Lines:** 52-70
**Complexity:** 1.0

---

## Source Code

```python
async def login(
    request: Request,
    response: Response,
    db: DBSession,
    ip: ClientIP,
    form_data: Annotated[OAuth2PasswordRequestForm,
                         Depends()],
) -> TokenWithUserResponse:
    """
    Login with email and password
    """
    result, refresh_token = await AuthService.login(
        db,
        email=form_data.username,
        password=form_data.password,
        ip_address=ip,
    )
    set_refresh_cookie(response, refresh_token)
    return result
```

---

## Today I Learned

TIL: I learned about using `Annotated` with `Depends()` in FastAPI to type hint dependencies clearly. In the `login` function, `form_data` is annotated as `OAuth2PasswordRequestForm` and depends on `Depends()`, making dependency injection both readable and strongly typed.

```python
form_data: Annotated[OAuth2PasswordRequestForm,
                     Depends()]
```

This pattern enhances code clarity and maintainability by explicitly defining the type of the dependency.

---

*Generated by CodeWorm on 2026-03-01 21:33*
