# WiseAdapter.validate_recipient

**Type:** Today I Learned
**Repository:** stripe-referral
**File:** src/stripe_referral/adapters/wise.py
**Language:** python
**Lines:** 176-229
**Complexity:** 12.0

---

## Source Code

```python
def validate_recipient(
        self,
        recipient_data: dict[str,
                             Any]
    ) -> RecipientValidation:
        """
        Validate Wise recipient data
        """
        required_fields = ["account_holder_name", "details"]

        missing_fields = [
            field for field in required_fields
            if field not in recipient_data
        ]

        if missing_fields:
            return RecipientValidation(
                valid = False,
                error =
                f"Missing required fields: {', '.join(missing_fields)}",
            )

        account_holder_name = recipient_data.get(
            "account_holder_name",
            ""
        )
        if not account_holder_name or len(account_holder_name) < 2:
            return RecipientValidation(
                valid = False,
                error = "Invalid account holder name",
            )

        details = recipient_data.get("details", {})
        if not isinstance(details, dict):
            return RecipientValidation(
                valid = False,
                error = "Details must be a dictionary",
            )

        account_type = recipient_data.get("account_type", "aba")
        if account_type == "aba":
            if "accountNumber" not in details or "routingNumber" not in details:
                return RecipientValidation(
                    valid = False,
                    error =
                    "Missing accountNumber or routingNumber for ABA transfer",
                )
        elif account_type == "iban" and "iban" not in details:
            return RecipientValidation(
                valid = False,
                error = "Missing IBAN for IBAN transfer",
            )

        return RecipientValidation(valid = True)
```

---

## Today I Learned

TIL: This function uses list comprehension to efficiently find missing required fields, making the validation process concise and readable. It also employs early returns for clear error handling, ensuring each validation step is handled independently before proceeding.

```python
missing_fields = [field for field in required_fields if field not in recipient_data]
if missing_fields:
    return RecipientValidation(valid=False, error=f"Missing required fields: {', '.join(missing_fields)}")
```

This pattern simplifies the code and improves maintainability.

---

*Generated by CodeWorm on 2026-02-21 21:31*
