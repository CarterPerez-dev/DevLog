# identify_protocol

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/beginner/network-traffic-analyzer/python/src/netanal/analyzer.py
**Language:** python
**Lines:** 41-68
**Complexity:** 12.0

---

## Source Code

```python
def identify_protocol(packet: Packet) -> Protocol:
    """
    Identify the highest level protocol in a packet
    """
    if packet.haslayer(DNS):
        return Protocol.DNS

    if packet.haslayer(TCP):
        tcp_layer = packet[TCP]
        if tcp_layer.dport == Ports.HTTP or tcp_layer.sport == Ports.HTTP:
            return Protocol.HTTP
        if tcp_layer.dport == Ports.HTTPS or tcp_layer.sport == Ports.HTTPS:
            return Protocol.HTTPS
        return Protocol.TCP

    if packet.haslayer(UDP):
        udp_layer = packet[UDP]
        if udp_layer.dport == Ports.DNS or udp_layer.sport == Ports.DNS:
            return Protocol.DNS
        return Protocol.UDP

    if packet.haslayer(ICMP):
        return Protocol.ICMP

    if packet.haslayer(ARP):
        return Protocol.ARP

    return Protocol.OTHER
```

---

## Today I Learned

TIL: This function uses a series of conditional checks to identify the highest-level protocol within a network packet, leveraging `if` statements to progressively narrow down possibilities. Each condition builds upon the last, making the code concise and easy to follow‚Äîperfect for parsing complex packets in cybersecurity projects! üåêüîç

---

*Generated by CodeWorm on 2026-03-01 01:59*
