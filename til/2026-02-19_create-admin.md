# create_admin

**Type:** Today I Learned
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/siem-dashboard/backend/app/cli.py
**Language:** python
**Lines:** 24-53
**Complexity:** 5.0

---

## Source Code

```python
def create_admin(username: str, email: str, password: str) -> None:
    """
    Create a new admin account or promote an existing user
    """
    existing = User.find_by_username(username)
    if existing is not None:
        if existing.role == UserRole.ADMIN:
            click.echo(f"User '{username}' is already an admin.")
            return
        existing.set_role(UserRole.ADMIN)
        click.echo(f"Promoted existing user '{username}' to admin.")
        return

    existing_email = User.find_by_email(email)
    if existing_email is not None:
        if existing_email.role == UserRole.ADMIN:
            click.echo(f"User with email '{email}' is already an admin.")
            return
        existing_email.set_role(UserRole.ADMIN)
        click.echo(f"Promoted existing user '{existing_email.username}' to admin.")
        return

    hashed = hash_password(password)
    User.create_user(
        username = username,
        email = email,
        password_hash = hashed,
        role = UserRole.ADMIN,
    )
    click.echo(f"Admin account '{username}' created successfully.")
```

---

## Today I Learned

TIL: This `create_admin` function demonstrates conditional logic with early returns to handle different cases efficiently. By checking for existing users by username and email separately, then promoting or creating a new admin account based on these conditions, the function avoids complex nested structures, making it cleaner and easier to understand. ðŸš€âœ¨

---

*Generated by CodeWorm on 2026-02-19 07:41*
