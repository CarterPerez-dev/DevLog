# UserDetailModal

**Type:** Today I Learned
**Repository:** CertGames-Core
**File:** frontend/admin-app/src/modules/users/components/UserDetailModal.tsx
**Language:** tsx
**Lines:** 83-586
**Complexity:** 21.0

---

## Source Code

```tsx
function UserDetailModal({
  userId,
  open,
  onClose,
}: UserDetailModalProps): React.JSX.Element | null {
  const {
    data: user,
    isLoading: userLoading,
    error: userError,
  } = useUser(userId ?? '');

  const { data: shopData } = useShopItems();

  const generateImpersonationToken = useGenerateImpersonationToken();
  const forceLogout = useForceLogout();
  // const _sendEmailToUser = useSendEmailToUser(); // TODO: Implement email functionality
  const deleteUser = useDeleteUser();

  if (!open || !userId) return null;

  const handleQuickAction = (action: string): void => {
    if (
      userId.length === 0 ||
      user?.basic_info?.user_id === null ||
      user?.basic_info?.user_id === undefined
    )
      return;

    switch (action) {
      case 'impersonate':
        generateImpersonationToken.mutate(
          {
            userId: user.basic_info.user_id,
            tokenData: { duration_minutes: 60 },
          },
          {
            onSuccess: (data: unknown) => {
              if (
                data !== null &&
                typeof data === 'object' &&
                'impersonation_token' in data &&
                typeof (data as { impersonation_token: unknown })
                  .impersonation_token === 'string' &&
                (data as { impersonation_token: string }).impersonation_token
                  .length > 0
              ) {
                if (
                  navigator.clipboard?.writeText !== null &&
                  navigator.clipboard?.writeText !== undefined
                ) {
                  navigator.clipboard
                    .writeText(
                      (data as { impersonation_token: string }).impersonation_token,
                    )
                    .then(() => {
                      const durationMinutes =
                        typeof (data as { duration_minutes?: unknown })
                          .duration_minutes === 'number'
                          ? String(
                              (data as { duration_minutes?: unknown })
                                .duration_minutes,
                            )
                          : 'unknown';
                      toast.success(
                        `Impersonation token generated and copied to clipboard! Expires in ${durationMinutes} minutes.`,
                      );
                    })
                    .catch(() => {
                      toast.success(
                        <div>
                          <p>Impersonation token generated! (Copy manually)</p>
                          <p
                            style={{
                              fontSize: '12px',
                              wordBreak: 'break-all',
                              marginTop: '8px',
                            }}
                          >
                            {(
                              data as { impersonation_token: string }
                            ).impersonation_token.substr
```

---

## Today I Learned

TIL: I learned how to handle clipboard operations and toast notifications elegantly in React using TypeScript. In `UserDetailModal`, the `handleQuickAction` function generates an impersonation token, then uses `navigator.clipboard.writeText()` to copy it to the clipboard if supported. If not, it falls back to displaying the token in a toast notification with expiration details. This ensures a smooth user experience regardless of browser capabilities! ðŸš€ðŸ“‹

---

*Generated by CodeWorm on 2026-02-19 17:42*
