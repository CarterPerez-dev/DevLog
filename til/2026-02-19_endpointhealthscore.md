# EndpointHealthScore

**Type:** Today I Learned
**Repository:** CertGames-Core
**File:** frontend/admin-app/src/modules/analytics/components/endpoints/EndpointHealthScore.tsx
**Language:** tsx
**Lines:** 37-268
**Complexity:** 29.0

---

## Source Code

```tsx
function EndpointHealthScore({ endpoint, days }: Props): React.JSX.Element {
  const { data: health, isLoading, isError } = useEndpointHealth(endpoint, days);

  const getFactorStatus = (score: number): 'good' | 'warning' | 'critical' => {
    if (score >= 80) return 'good';
    if (score >= 50) return 'warning';
    return 'critical';
  };

  const renderHealthFactors = (): React.JSX.Element => {
    if (health?.health === null || health?.health === undefined) {
      return <div className={styles.noData}>No health data available</div>;
    }

    const factors: HealthFactor[] = Object.entries(health.health.factors).map(
      ([key, value]) => ({
        name: formatDisplayText(key),
        value: typeof value === 'number' ? value : 0,
        weight: 25, // Equal weight for simplicity
        status: getFactorStatus(typeof value === 'number' ? value : 0),
      }),
    );

    return (
      <div className={styles.factorsList}>
        {factors.map((factor) => (
          <div
            key={factor.name}
            className={styles.factorItem}
          >
            <div className={styles.factorHeader}>
              <span className={styles.factorName}>{factor.name}</span>
              <span className={`${styles.factorScore} ${styles[factor.status]}`}>
                {factor.value.toFixed(0)}%
              </span>
            </div>
            <div className={styles.factorBar}>
              <div
                className={`${styles.factorProgress} ${styles[factor.status]}`}
                style={{ width: `${String(factor.value)}%` }}
              />
            </div>
          </div>
        ))}
      </div>
    );
  };

  const renderSLAViolations = (): React.JSX.Element | null => {
    if (health?.sla_violations === null || health?.sla_violations === undefined) {
      return null;
    }

    const violations = [
      {
        name: 'Response Time',
        violated: health.sla_violations.response_time_violated,
        icon: FiClock,
      },
      {
        name: 'Error Rate',
        violated: health.sla_violations.error_rate_violated,
        icon: FiAlertCircle,
      },
      {
        name: 'Availability',
        violated: health.sla_violations.availability_violated,
        icon: FiHeart,
      },
    ];

    return (
      <div className={styles.slaSection}>
        <h4 className={styles.sectionTitle}>SLA Compliance</h4>
        <div className={styles.slaGrid}>
          {violations.map((violation) => {
            const Icon = violation.icon;
            return (
              <div
                key={violation.name}
                className={`${styles.slaItem} ${violation.violated ? styles.violated : styles.compliant}`}
              >
                <Icon className={styles.slaIcon} />
                <span className={styles.slaName}>{violation.name}</span>
                {violation.violated ? (
                  <FiXCircle className={styles.statusIcon} />
                ) : (
                  <FiCheckCircle
```

---

## Today I Learned

TIL: In `EndpointHealthScore`, the function uses dynamic styling and conditional rendering to display health factors and SLA violations based on their status. This makes the UI responsive and easy to understand, with clear visual indicators like colors and icons.

```tsx
const getFactorStatus = (score: number): 'good' | 'warning' | 'critical' => {
  if (score >= 80) return 'good';
  if (score >= 50) return 'warning';
  return 'critical';
};
```

This clever status determination ensures the UI reflects health accurately, making it easy to spot issues at a glance.

---

*Generated by CodeWorm on 2026-02-19 15:27*
