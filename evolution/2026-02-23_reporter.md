# reporter

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/report/reporter.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/report/reporter.go
Change type: new file

Diff:
@@ -0,0 +1,61 @@
+/*
+AngelaMos | 2025
+reporter.go
+*/
+
+package report
+
+import (
+	"fmt"
+	"io"
+	"os"
+
+	"github.com/CarterPerez-dev/docksec/internal/finding"
+)
+
+type Reporter interface {
+	Report(findings finding.Collection) error
+}
+
+func NewReporter(format, outputFile string) (Reporter, error) {
+	var w io.Writer = os.Stdout
+	var closer func() error
+
+	if outputFile != "" {
+		f, err := os.Create(outputFile)
+		if err != nil {
+			return nil, fmt.Errorf("creating output file: %w", err)
+		}
+		w = f
+		closer = f.Close
+	}
+
+	switch format {
+	case "terminal", "":
+		return &TerminalReporter{
+			w:       w,
+			closer:  closer,
+			colored: outputFile == "",
+		}, nil
+	case "json":
+		return &JSONReporter{w: w, closer: closer}, nil
+	case "sarif":
+		return &SARIFReporter{w: w, closer: closer}, nil
+	case "junit":
+		return &JUnitReporter{w: w, closer: closer}, nil
+	default:
+		return nil, fmt.Errorf("unsupported output format: %s", format)
+	}
+}
+
+type baseReporter struct {
+	w      io.Writer
+	closer func() error
+}
+
+func (r *baseReporter) close() error {
+	if r.closer != nil {
+		return r.closer()
+	}
+	return nil
+}

```

---

## Code Evolution

### Change Analysis for `internal/report/reporter.go`

**What was Changed:**
The file `reporter.go` introduces a new Go package named `report`. It defines an interface `Reporter` with a method `Report` that takes a collection of findings and returns an error. The implementation includes functions to create different types of reporters (`TerminalReporter`, `JSONReporter`, `SARIFReporter`, `JUnitReporter`) based on the specified format and output file. A base reporter struct is also defined, providing common functionality for closing resources.

**Why it was Likely Changed:**
This change likely aims to standardize how findings are reported in different formats (terminal, JSON, SARIF, JUnit) within the docksec project. By defining an interface and factory function, the code becomes more modular and easier to extend or modify if new reporting formats need to be added.

**Impact on Behavior:**
The addition of a `Reporter` interface allows for flexible handling of different output formats. Users can now easily switch between terminal output, JSON files, SARIF reports, etc., without changing existing code that interacts with the reporter. This enhances the project's flexibility and maintainability.

**Risks or Concerns:**
- **Error Handling:** The factory function could benefit from more comprehensive error handling to ensure all potential issues are gracefully managed.
- **Resource Management:** Proper resource cleanup is handled by the `close` method, but itâ€™s crucial that this method is called when the reporter is no longer needed to avoid memory leaks.

Overall, this change significantly improves the project's reporting capabilities while maintaining a clean and maintainable codebase.

---

*Generated by CodeWorm on 2026-02-23 16:14*
