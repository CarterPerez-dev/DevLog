# enums

**Type:** Code Evolution
**Repository:** social-media-notes
**File:** backend/app/core/enums.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 8c757802
Message: easy peasy
Author: CarterPerez-dev
File: backend/app/core/enums.py
Change type: new file

Diff:
@@ -0,0 +1,90 @@
+"""
+â’¸AngelaMos | 2025
+enums.py
+"""
+
+from enum import Enum
+from typing import Any
+
+import sqlalchemy as sa
+
+
+def enum_values_callable(enum_class: type[Enum]) -> list[str]:
+    """
+    Returns enum VALUES (not names) for SQLAlchemy storage
+
+    Prevents the common trap where SQLAlchemy stores enum NAMES by default,
+    causing database breakage if you rename an enum member
+    """
+    return [str(item.value) for item in enum_class]
+
+
+class SafeEnum(sa.Enum):
+    """
+    SQLAlchemy Enum type that stores VALUES and handles unknown values gracefully
+
+    https://blog.wrouesnel.com/posts/sqlalchemy-enums-careful-what-goes-into-the-database/
+    """
+    def __init__(self, *enums: type[Enum], **kw: Any) -> None:
+        if "values_callable" not in kw:
+            kw["values_callable"] = enum_values_callable
+        super().__init__(*enums, **kw)
+        self._unknown_value = (
+            kw["_adapted_from"]._unknown_value
+            if "_adapted_from" in kw else kw.get("unknown_value")
+        )
+
+    def _object_value_for_elem(self, elem: str) -> Enum:
+        """
+        Override to return unknown_value instead of raising LookupError
+        """
+        try:
+            return self._object_lookup[elem]
+        except LookupError:
+            if self._unknown_value is not None:
+                return self._unknown_value
+            raise
+
+
+class Environment(str, Enum):
+    """
+    Application environment.
+    """
+    DEVELOPMENT = "development"
+    STAGING = "staging"
+    PRODUCTION = "production"
+
+
+class UserRole(str, Enum):
+    """
+    User roles for authorization.
+    """
+    UNKNOWN = "unknown"
+    USER = "user"
+    ADMIN = "admin"
+
+
+class TokenType(str, Enum):
+    """
+    JWT token types.
+    """
+    ACCESS = "access"
+    REFRESH = "refresh"
+
+
+class HealthStatus(str, Enum):
+    """
+    Health check status values.
+    """
+    HEALTHY = "healthy"
+    UNHEALTHY = "unhealthy"
+    DEGRADED = "degraded"
+
+
+class Platform(str, Enum):
+    """
+    Social media platforms for video entries.
+    """
+    TIKTOK = "tiktok"
+    INSTAGRAM = "instagram"
+    YOUTUBE = "youtube"

```

---

## Code Evolution

### Change Analysis for Commit 8c757802 in `backend/app/core/enums.py`

#### What Was Changed:
- A new file `enums.py` was added, introducing several custom enums and a utility function.
- The file includes enums for `Environment`, `UserRole`, `TokenType`, `HealthStatus`, and `Platform`.
- A custom SQLAlchemy enum type `SafeEnum` is defined to handle unknown values gracefully.

#### Why It Was Likely Changed:
The addition of these enums likely aims to standardize and improve the handling of constants across the application. The `SafeEnum` class ensures that enum values are stored correctly in the database, mitigating issues with enum name changes. This change enhances code maintainability and robustness by centralizing constant definitions.

#### Impact on Behavior:
- **Database Storage:** Enum values will now be stored as strings, preventing issues related to enum name changes.
- **Error Handling:** The `SafeEnum` class handles unknown values gracefully, returning a default value instead of raising an error.
- **Consistency:** Centralized enums ensure consistent usage and naming across the application.

#### Risks or Concerns:
- **Backward Compatibility:** Ensuring that existing code using these enums does not break due to changes in their implementation.
- **Performance:** The `SafeEnum` class may introduce minor performance overhead due to additional checks for unknown values. However, this is generally minimal and acceptable given the benefits.

Overall, this change significantly improves the robustness and maintainability of the application's enum handling.

---

*Generated by CodeWorm on 2026-02-23 17:46*
