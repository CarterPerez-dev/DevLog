# Base

**Type:** Code Evolution
**Repository:** social-media-notes
**File:** backend/app/core/Base.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 8c757802
Message: easy peasy
Author: CarterPerez-dev
File: backend/app/core/Base.py
Change type: new file

Diff:
@@ -0,0 +1,84 @@
+"""
+â’¸AngelaMos | 2025
+Base.py
+"""
+
+from uuid import UUID
+from datetime import UTC, datetime
+
+import uuid6
+from sqlalchemy.orm import (
+    Mapped,
+    mapped_column,
+    DeclarativeBase,
+)
+from sqlalchemy import (
+    DateTime,
+    MetaData,
+    func,
+)
+from sqlalchemy.ext.asyncio import AsyncAttrs
+
+
+NAMING_CONVENTION = {
+    "ix": "ix_%(column_0_label)s",
+    "uq": "uq_%(table_name)s_%(column_0_name)s",
+    "ck": "ck_%(table_name)s_%(constraint_name)s",
+    "fk": "fk_%(table_name)s_%(column_0_name)s_%(referred_table_name)s",
+    "pk": "pk_%(table_name)s",
+}
+
+
+class Base(AsyncAttrs, DeclarativeBase):
+    """
+    Base class for all SQLAlchemy models
+    """
+    metadata = MetaData(naming_convention = NAMING_CONVENTION)
+
+
+class UUIDMixin:
+    """
+    Mixin for UUID v7 primary key
+
+    UUID v7 is time sortable and distributed safe, optimal for B tree indexes
+    """
+    id: Mapped[UUID] = mapped_column(
+        primary_key = True,
+        default = uuid6.uuid7,
+    )
+
+
+class TimestampMixin:
+    """
+    Mixin for created_at and updated_at timestamps
+    """
+    created_at: Mapped[datetime] = mapped_column(
+        DateTime(timezone = True),
+        default = lambda: datetime.now(UTC),
+        server_default = func.now(),
+    )
+    updated_at: Mapped[datetime | None] = mapped_column(
+        DateTime(timezone = True),
+        default = None,
+        onupdate = lambda: datetime.now(UTC),
+        server_onupdate = func.now(),
+    )
+
+
+class SoftDeleteMixin:
+    """
+    Mixin for soft delete functionality
+    """
+    deleted_at: Mapped[datetime | None] = mapped_column(
+        DateTime(timezone = True),
+        default = None,
+    )
+    is_deleted: Mapped[bool] = mapped_column(default = False)
+
+    def soft_delete(self) -> None:
+        self.is_deleted = True
+        self.deleted_at = datetime.now(UTC)
+
+    def restore(self) -> None:
+        self.is_deleted = False
+        self.deleted_at = None

```

---

## Code Evolution

### Change Analysis for Commit 8c757802

**What was Changed:**
A new file `Base.py` was added to the repository, introducing a base class and mixins for common database model functionalities. The changes include:
- Defining a `Base` class that inherits from `AsyncAttrs` and `DeclarativeBase`.
- Implementing three mixins: `UUIDMixin`, `TimestampMixin`, and `SoftDeleteMixin`.

**Why it was Likely Changed:**
This change likely aims to standardize the structure of database models across the application. By providing common functionalities like UUID primary keys, timestamp management, and soft delete capabilities, developers can focus on business logic rather than boilerplate code.

**Impact on Behavior:**
- Models inheriting from `Base` will automatically have a time-sortable UUID as their primary key.
- Timestamps for creation and updates are managed with UTC timezone support.
- Soft delete functionality is available through the `soft_delete()` and `restore()` methods.

**Risks or Concerns:**
- The use of `uuid6.uuid7` might not be widely known, which could introduce confusion among team members unfamiliar with this UUID variant.
- The `Base` class and mixins are tightly coupled to SQLAlchemy, making it harder to switch ORM frameworks if needed in the future.
- The `soft_delete()` method modifies multiple columns; ensure that these operations are atomic to avoid partial state changes.

---

*Generated by CodeWorm on 2026-02-23 17:30*
