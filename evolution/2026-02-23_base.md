# base

**Type:** Code Evolution
**Repository:** stripe-referral
**File:** src/stripe_referral/repositories/base.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: bfb52633
Message: feat: Done
Author: CarterPerez-dev
File: src/stripe_referral/repositories/base.py
Change type: new file

Diff:
@@ -0,0 +1,83 @@
+"""
+â’¸AngelaMos | 2025 | CertGames.com
+Base repository with generic CRUD operations
+"""
+
+from typing import (
+    Any,
+    Generic,
+    TypeVar,
+)
+from sqlalchemy import select
+from sqlalchemy.orm import Session
+
+from ..database.Base import Base
+
+
+T = TypeVar("T", bound = Base)
+
+
+class BaseRepository(Generic[T]):
+    """
+    Base repository with common CRUD operations
+    """
+    def __init__(self, db: Session, model: type[T]) -> None:
+        """
+        Initialize repository with database session and model type
+        """
+        self.db = db
+        self.model = model
+
+    def create(self, **kwargs: Any) -> T:
+        """
+        Create a new record
+        """
+        instance = self.model(**kwargs)
+        self.db.add(instance)
+        self.db.commit()
+        self.db.refresh(instance)
+        return instance
+
+    def get_by_id(self, record_id: int) -> T | None:
+        """
+        Get record by ID
+        """
+        return self.db.get(self.model, record_id)
+
+    def get_all(self,
+                limit: int | None = None,
+                offset: int = 0) -> list[T]:
+        """
+        Get all records with pagination
+        """
+        stmt = select(self.model).offset(offset)
+        if limit:
+            stmt = stmt.limit(limit)
+        return list(self.db.execute(stmt).scalars().all())
+
+    def update(self, record_id: int, **kwargs: Any) -> T | None:
+        """
+        Update record by ID
+        """
+        instance = self.get_by_id(record_id)
+        if not instance:
+            return None
+
+        for key, value in kwargs.items():
+            setattr(instance, key, value)
+
+        self.db.commit()
+        self.db.refresh(instance)
+        return instance
+
+    def delete(self, record_id: int) -> bool:
+        """
+        Delete record by ID
+        """
+        instance = self.get_by_id(record_id)
+        if not instance:
+            return False
+
+        self.db.delete(instance)
+        self.db.commit()
+        return True

```

---

## Code Evolution

### Change Analysis for `BaseRepository` Class in `stripe_referral/repositories/base.py`

**What was Changed:**
A new file, `base.py`, was added to the `stripe_referral/repositories` directory containing a generic base repository class named `BaseRepository`. This class implements common CRUD operations using SQLAlchemy.

**Why it was Likely Changed:**
This change introduces a reusable base class for repositories, which can be extended by specific repository implementations. It standardizes database interactions and provides a consistent interface across different models, promoting code reuse and maintainability.

**Impact on Behavior:**
The `BaseRepository` class offers generic methods to create, retrieve (by ID), list with pagination, update, and delete records. This simplifies the implementation of repositories for various models in the `stripe_referral` module by providing a common structure and reducing boilerplate code.

**Risks or Concerns:**
- **Type Safety:** While type hints are used, they rely on the `Base` class from another module, which might not always be sufficient. Ensuring that all model classes extend `Base` is crucial.
- **Overhead:** The generic nature of the repository may introduce some overhead due to the need for type annotations and dynamic method calls.
- **Error Handling:** The current implementation does minimal error handling (e.g., no explicit checks for database connection issues). This could be improved by adding more robust error management.

Overall, this change is a feature addition that enhances code organization and maintainability.

---

*Generated by CodeWorm on 2026-02-23 03:02*
