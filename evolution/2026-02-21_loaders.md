# loaders

**Type:** Code Evolution
**Repository:** CertGames-Core
**File:** backend/api/domains/games/middleware/loaders.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: fe44f45e
Message: dev v2.0.4 (#169)

* chore(deps): update uv.lock with latest dependency versions

* feat:
- add terminal takedown game
- add back buttons to landing page pages (learn, play, features)
- add back buttons to ai tools and games
- add 10 tests (1000 pratice questions) for the CompTIA SecAI+ v1 exam/certification
- update some deps
- bump to v2.0.4 of CertGames

* error there but not here wtf

* error there but not here wtf
Author: Carter Perez
File: backend/api/domains/games/middleware/loaders.py
Change type: modified

Diff:
@@ -10,6 +10,7 @@ from api.core.validation.exceptions import DatabaseError
 from api.domains.account.models.User import User
 
 from ..services.phishing.phishing_ops import PhishingService
+from ..services.terminal.terminal_ops import TerminalService
 
 
 def load_phishing_examples() -> None:
@@ -20,9 +21,7 @@ def load_phishing_examples() -> None:
         examples = PhishingService.get_all_examples()
         g.phishing_examples = examples
     except Exception as e:
-        raise DatabaseError(
-            f"Error loading phishing examples: {str(e)}"
-        ) from e
+        raise DatabaseError(f"Error loading phishing examples: {str(e)}") from e
 
 
 def load_user_game_history() -> None:
@@ -45,10 +44,7 @@ def load_phishing_leaderboard() -> None:
     """
     Load phishing game leaderboard
     """
-    limit: int = g.validated.get(
-        'limit',
-        Business.PHISHING_LEADERBOARD_LIMIT
-    )
+    limit: int = g.validated.get('limit', Business.PHISHING_LEADERBOARD_LIMIT)
 
     try:
         top_scores = PhishingService.get_top_scores_per_user(limit)
@@ -70,3 +66,52 @@ def load_phishing_leaderboard() -> None:
         raise DatabaseError(
             f"Error loading phishing leaderboard: {str(e)}"
         ) from e
+
+
+def load_terminal_challenges() -> None:
+    try:
+        mode = g.validated.get('mode', 'quick_fire')
+        difficulty = g.validated.get('difficulty')
+        challenges = TerminalService.get_challenges_by_mode(mode, difficulty)
+        g.terminal_challenges = challenges
+    except Exception as e:
+        raise DatabaseError(f"Error loading terminal challenges: {str(e)}") from e
+
+
+def load_terminal_game_history() -> None:
+    user: User = g.user
+
+    try:
+        history = TerminalService.get_user_history(
+            str(user.id),
+            limit = Business.TERMINAL_HISTORY_LIMIT
+        )
+        g.terminal_game_history = history
+    except DatabaseError:
+        g.terminal_game_history = []
+
+
+def load_terminal_leaderboard() -> None:
+    limit: int = g.validated.get('limit', Business.TERMINAL_LEADERBOARD_LIMIT)
+    mode: str | None = g.validated.get('mode')
+
+    try:
+        top_scores = TerminalService.get_top_scores_per_user(limit, mode)
+
+        leaderboard_data = []
+        for score_entry in top_scores:
+            user = TerminalService.get_user_by_id(score_entry["userId"])
+            if user:
+                leaderboard_dat
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The code added two new functions, `load_terminal_challenges`, `load_terminal_game_history`, and `load_terminal_leaderboard`. These functions interact with the `TerminalService` to load challenges, game history, and leaderboard data for a terminal takedown game. Additionally, the existing function `load_phishing_examples` was modified to remove redundant error handling.

**Why it was Likely Changed:**
This change likely aims to integrate a new terminal-based game into CertGames, enhancing the platform with more interactive content. The addition of back buttons and 10 practice tests for CompTIA SecAI+ v1 certification suggests an effort to diversify user engagement and prepare users better.

**Impact on Behavior:**
The introduction of these functions will enable the backend to dynamically load data specific to the terminal game, such as challenges and leaderboards. This improves the application's responsiveness and adaptability to different game modes and difficulties.

**Risks or Concerns:**
- **Error Handling**: The removal of redundant error handling in `load_phishing_examples` could potentially lead to less informative error messages if an unexpected exception occurs.
- **Code Duplication**: While the new functions are well-structured, there might be opportunities for refactoring common patterns into reusable utility functions.
- **Dependency Management**: Ensuring that all dependencies (`TerminalService`, etc.) are correctly managed and up-to-date is crucial to avoid runtime issues.

Overall, this change significantly expands the game functionality while maintaining a clean structure.

---

*Generated by CodeWorm on 2026-02-21 11:18*
