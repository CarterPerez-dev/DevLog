# json

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/reporter/json.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/reporter/json.go
Change type: new file

Diff:
@@ -0,0 +1,77 @@
+// Â©AngelaMos | 2026
+// json.go
+
+package reporter
+
+import (
+	"encoding/json"
+	"io"
+
+	"github.com/CarterPerez-dev/portia/pkg/types"
+)
+
+type JSON struct{}
+
+type jsonOutput struct {
+	Findings []jsonFinding `json:"findings"`
+	Summary  jsonSummary   `json:"summary"`
+}
+
+type jsonFinding struct {
+	RuleID      string  `json:"rule_id"`
+	Description string  `json:"description"`
+	Severity    string  `json:"severity"`
+	Secret      string  `json:"secret"` //nolint:gosec
+	Entropy     float64 `json:"entropy,omitempty"`
+	File        string  `json:"file"`
+	Line        int     `json:"line"`
+	Commit      string  `json:"commit,omitempty"`
+	Author      string  `json:"author,omitempty"`
+	HIBPStatus  string  `json:"hibp_status,omitempty"`
+	BreachCount int     `json:"breach_count,omitempty"`
+}
+
+type jsonSummary struct {
+	TotalFiles    int    `json:"total_files"`
+	TotalFindings int    `json:"total_findings"`
+	TotalRules    int    `json:"total_rules"`
+	Duration      string `json:"duration"`
+	HIBPChecked   int    `json:"hibp_checked,omitempty"`
+	HIBPBreached  int    `json:"hibp_breached,omitempty"`
+}
+
+func (j *JSON) Report(
+	w io.Writer, result *types.ScanResult,
+) error {
+	output := jsonOutput{
+		Summary: jsonSummary{
+			TotalFiles:    result.TotalFiles,
+			TotalFindings: len(result.Findings),
+			TotalRules:    result.TotalRules,
+			Duration:      result.Duration.String(),
+			HIBPChecked:   result.HIBPChecked,
+			HIBPBreached:  result.HIBPBreached,
+		},
+	}
+
+	output.Findings = make([]jsonFinding, len(result.Findings))
+	for i, f := range result.Findings {
+		output.Findings[i] = jsonFinding{
+			RuleID:      f.RuleID,
+			Description: f.Description,
+			Severity:    f.Severity.String(),
+			Secret:      maskSecret(f.Secret),
+			Entropy:     f.Entropy,
+			File:        f.FilePath,
+			Line:        f.LineNumber,
+			Commit:      f.CommitSHA,
+			Author:      f.Author,
+			HIBPStatus:  f.HIBPStatus.String(),
+			BreachCount: f.BreachCount,
+		}
+	}
+
+	enc := json.NewEncoder(w)
+	enc.SetIndent("", "  ")
+	return enc.Encode(output)
+}

```

---

## Code Evolution

### Change Analysis for `json.go`

**What was Changed:**
A new file, `json.go`, was added to the `reporter` package in the secrets scanner project. This file introduces a JSON reporter implementation that converts scan results into JSON format.

**Why it Was Likely Changed:**
This change likely aims to provide an additional reporting mechanism for the secrets scanner, enabling users to output findings in JSON format. This is useful for integration with other tools or systems that consume JSON data.

**Impact on Behavior:**
The `Report` function now has a new method of generating reports. It takes an `io.Writer` and a `types.ScanResult`, encoding the result into a structured JSON report. The output includes detailed findings, summary statistics, and optional HIBP status information.

**Risks or Concerns:**
- **Security:** The `Secret` field is not masked with `nolint:gosec`, which could potentially expose sensitive data in logs or other outputs.
- **Performance:** Iterating over the findings to construct JSON objects may impact performance for large scan results.
- **Error Handling:** The function does not handle potential errors from encoding, such as invalid input or I/O issues.

Overall, this change enhances the project's flexibility and utility by adding a JSON reporting option.

---

*Generated by CodeWorm on 2026-02-22 21:13*
