# calendar

**Type:** Code Evolution
**Repository:** ios-test
**File:** red-recon/app/(app)/(tabs)/calendar.tsx
**Language:** tsx
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```tsx
Commit: 120aefce
Message: checkpoint
Author: CarterPerez-dev
File: red-recon/app/(app)/(tabs)/calendar.tsx
Change type: modified

Diff:
@@ -4,7 +4,7 @@
  */
 
 import { useCalendarMonth } from '@/api/hooks'
-import { type CalendarDay, PHASE_COLORS, PHASE_LABELS } from '@/api/types'
+import { type CalendarDay, CyclePhase, PHASE_COLORS } from '@/api/types'
 import { PeriodLogSheet } from '@/features/calendar'
 import { DottedBackground } from '@/shared/components'
 import { haptics } from '@/shared/utils'
@@ -12,20 +12,42 @@ import { colors } from '@/theme/tokens'
 import { ChevronLeft, ChevronRight } from 'lucide-react-native'
 import type React from 'react'
 import { useCallback, useMemo, useState } from 'react'
-import { ActivityIndicator, Pressable } from 'react-native'
+import { ActivityIndicator, Dimensions, Pressable, ScrollView } from 'react-native'
 import { SafeAreaView } from 'react-native-safe-area-context'
 import { Stack, Text, XStack, YStack } from 'tamagui'
 
-const WEEKDAYS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'] as const
+const WEEKDAYS = ['S', 'M', 'T', 'W', 'T', 'F', 'S'] as const
 const MONTH_NAMES = [
   'January', 'February', 'March', 'April', 'May', 'June',
   'July', 'August', 'September', 'October', 'November', 'December'
 ] as const
 
+const { width: SCREEN_WIDTH } = Dimensions.get('window')
+const CALENDAR_PADDING = 16
+const CELL_GAP = 6
+const CELL_SIZE = (SCREEN_WIDTH - (CALENDAR_PADDING * 2) - (CELL_GAP * 6)) / 7
+
 interface CalendarCellData {
   day: CalendarDay | null
   dayNumber: number | null
   isToday: boolean
+  dateStr: string | null
+}
+
+function getPhaseBackgroundColor(phase: CyclePhase | undefined): string {
+  if (!phase) return 'transparent'
+  switch (phase) {
+    case CyclePhase.MENSTRUAL:
+      return 'rgba(220, 38, 38, 0.12)'
+    case CyclePhase.FOLLICULAR:
+      return 'rgba(236, 72, 153, 0.10)'
+    case CyclePhase.OVULATION:
+      return 'rgba(245, 158, 11, 0.12)'
+    case CyclePhase.LUTEAL:
+      return 'rgba(100, 116, 139, 0.10)'
+    default:
+      return 'transparent'
+  }
 }
 
 function CalendarDayCell({
@@ -38,42 +60,34 @@ function CalendarDayCell({
   const { day, dayNumber, isToday } = data
 
   if (dayNumber === null) {
-    return <Stack flex={1} aspectRatio={1} />
+    return <Stack width={CELL_SIZE} height={CELL_SIZE} />
   }
 
-  const phaseColor = day ? (PHASE_COLORS[day.phase] ?? colors.textMuted.val) : colors.textMuted.val
   const isPeriod = day?.is_period ?? false
   const isPredicted = (day?.is_predicted_period ?? false) && !isPeriod
+  const phaseBg = getPhaseBackgroundColor(day?.phase)
 
   return (
-    <Pressable style={{ flex: 1 }} onPress={onPress}>
+    <Pressable onPress={onPress}>
       <Stack
-        flex={1}
-        aspectRatio={1}
+        width={CELL_SIZE}
+        height={CELL_SIZE}
         alignItems="center"
         justifyContent="center"
         borderRadius="$2"
-        backgroundColor={isPeriod ? '#dc2626' : isPredicted ? '$bgSur
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The code changes include updates to the `CalendarCellData` interface, introduction of a new function `getPhaseBackgroundColor`, and modifications in how cells are rendered within the `CalendarDayCell` component. Specifically:
- The `WEEKDAYS` array is shortened.
- A new constant `SCREEN_WIDTH` is introduced using `Dimensions.get('window')`.
- `CELL_SIZE` calculations are updated based on screen width.
- A new function `getPhaseBackgroundColor` is added to determine background colors for different cycle phases.

**Why it was Likely Changed:**
These changes likely aim to improve the calendar's responsiveness and visual clarity by:
- Shortening the weekday array for brevity or localization purposes.
- Dynamic cell sizing based on screen width, enhancing usability across devices.
- Introducing a utility function for consistent phase coloring.

**Impact on Behavior:**
The updated cell rendering logic will now correctly display different background colors based on the user's cycle phase. The calendar grid layout should adapt better to various screen sizes, providing a more uniform and visually appealing interface.

**Risks or Concerns:**
- Potential issues with weekday localization if `WEEKDAYS` is shortened.
- Ensuring that all phase-related styles are correctly applied without causing visual glitches.
- The introduction of new state properties (`dateStr`) may require additional logic to handle date string updates properly.

---

*Generated by CodeWorm on 2026-02-23 12:04*
