# useWakeWord

**Type:** Code Evolution
**Repository:** angelamos-operations
**File:** CarterOS-Client/src/aspects/assistant/facets/angela/hooks/useWakeWord.ts
**Language:** typescript
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```typescript
Commit: 3894239b
Message: angela-3d implementation - in prog open wake
Author: CarterPerez-dev
File: CarterOS-Client/src/aspects/assistant/facets/angela/hooks/useWakeWord.ts
Change type: new file

Diff:
@@ -0,0 +1,72 @@
+// ===================
+// Â© AngelaMos | 2026
+// useWakeWord.ts
+// ===================
+
+import { useEffect, useRef, useCallback } from 'react'
+import { createWakeWordEngine } from '../lib/porcupine'
+import { AudioRecorder } from '../lib/audio'
+import { logger } from '../lib/debug'
+
+type WakeWordEngine = Awaited<ReturnType<typeof createWakeWordEngine>>
+
+interface UseWakeWordResult {
+  wakeWordRef: React.MutableRefObject<WakeWordEngine | null>
+  recorderRef: React.MutableRefObject<AudioRecorder | null>
+  setWakeWordCallback: (callback: () => void) => void
+}
+
+export function useWakeWord(
+  onReady: () => void,
+  onError: (error: Error) => void
+): UseWakeWordResult {
+  const wakeWordRef = useRef<WakeWordEngine | null>(null)
+  const recorderRef = useRef<AudioRecorder | null>(null)
+  const callbackRef = useRef<(() => void) | null>(null)
+
+  const setWakeWordCallback = useCallback((callback: () => void) => {
+    callbackRef.current = callback
+    if (wakeWordRef.current) {
+      wakeWordRef.current.onWakeWord = callback
+    }
+  }, [])
+
+  useEffect(() => {
+    let mounted = true
+
+    const init = async () => {
+      try {
+        recorderRef.current = new AudioRecorder()
+        await recorderRef.current.initialize()
+        logger.page.log('AudioRecorder ready')
+
+        const wakeWord = await createWakeWordEngine()
+        wakeWordRef.current = wakeWord
+
+        if (callbackRef.current) {
+          wakeWord.onWakeWord = callbackRef.current
+        }
+
+        await wakeWord.start()
+        logger.page.log('Wake word listening')
+
+        if (mounted) onReady()
+      } catch (err) {
+        logger.page.error('Init error:', err)
+        if (mounted) {
+          onError(err instanceof Error ? err : new Error('Init failed'))
+        }
+      }
+    }
+
+    init()
+
+    return () => {
+      mounted = false
+      wakeWordRef.current?.dispose()
+      recorderRef.current?.dispose()
+    }
+  }, [onReady, onError])
+
+  return { wakeWordRef, recorderRef, setWakeWordCallback }
+}

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `useWakeWord.ts` was added, implementing a hook for handling wake word detection using the Porcupine library. The hook initializes an audio recorder and a wake word engine, sets up callbacks, and manages their lifecycle.

**Why it was Likely Changed:**
This change likely aims to integrate voice-activated commands into the AngelaOS client by providing a reusable mechanism for detecting specific wake words (e.g., "Angela"). This is crucial for enabling hands-free interaction with the assistant.

**Impact on Behavior:**
The introduction of `useWakeWord` allows components to listen for wake words and execute predefined actions when detected. It ensures that audio recording and wake word detection are properly initialized, disposed of, and error-handled.

**Risks or Concerns:**
- **Resource Management:** Proper disposal of the audio recorder and wake word engine is critical to avoid memory leaks.
- **Error Handling:** The hook should handle errors more granularly to provide better debugging information. For instance, distinguishing between initialization failures and runtime issues could be beneficial.
- **Performance:** Continuous audio recording might impact battery life on mobile devices; thus, efficient management of the recording state is essential.

Overall, this change enhances the assistant's functionality by enabling voice commands, but careful testing and optimization are necessary to ensure smooth operation.

---

*Generated by CodeWorm on 2026-02-22 15:29*
