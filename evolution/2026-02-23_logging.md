# logging

**Type:** Code Evolution
**Repository:** CodeWorm
**File:** codeworm/core/logging.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: ca3ce30d
Message: v1.0.2: add doc type system, Docker infrastructure, and web dashboard

- Add 11 documentation types (function, class, file, security review, TIL, etc.)
  with weighted random selection so the same codebase generates 10x more unique content
- Add Docker Compose for Ollama (GPU passthrough) + Redis + Dashboard + Nginx
- Add FastAPI backend with REST API, WebSocket live events, and Redis pub/sub
- Add React dashboard with stats, live log, commit feed, repo list, and worm viz
- Add next_scheduled_run logging after each cycle completes
- Update repos config and README for v1.0.2
Author: CarterPerez-dev
File: codeworm/core/logging.py
Change type: modified

Diff:
@@ -13,7 +13,11 @@ from rich.console import Console
 console = Console()
 
 
-def configure_logging(json_mode: bool | None = None, debug: bool = False) -> None:
+def configure_logging(
+    json_mode: bool | None = None,
+    debug: bool = False,
+    redis_url: str = "",
+) -> None:
     """
     Configure structlog for the daemon
     Auto-detects JSON mode based on TTY if not specified
@@ -26,28 +30,35 @@ def configure_logging(json_mode: bool | None = None, debug: bool = False) -> Non
     shared_processors: list[structlog.types.Processor] = [
         structlog.contextvars.merge_contextvars,
         structlog.processors.add_log_level,
-        structlog.processors.TimeStamper(fmt="iso", utc=True),
+        structlog.processors.TimeStamper(fmt = "iso",
+                                         utc = True),
         structlog.processors.StackInfoRenderer(),
         structlog.processors.format_exc_info,
     ]
 
+    if redis_url:
+        from codeworm.core.events import init_publisher, redis_log_processor
+
+        init_publisher(redis_url)
+        shared_processors.append(redis_log_processor)
+
     if json_mode:
         processors = [
             *shared_processors,
-            structlog.processors.JSONRenderer(serializer=_json_serializer),
+            structlog.processors.JSONRenderer(serializer = _json_serializer),
         ]
     else:
         processors = [
             *shared_processors,
-            structlog.dev.ConsoleRenderer(colors=True),
+            structlog.dev.ConsoleRenderer(colors = True),
         ]
 
     structlog.configure(
-        processors=processors,
-        wrapper_class=structlog.make_filtering_bound_logger(log_level),
-        context_class=dict,
-        logger_factory=structlog.PrintLoggerFactory(),
-        cache_logger_on_first_use=True,
+        processors = processors,
+        wrapper_class = structlog.make_filtering_bound_logger(log_level),
+        context_class = dict,
+        logger_factory = structlog.PrintLoggerFactory(),
+        cache_logger_on_first_use = True,
     )
 
 

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
In `codeworm/core/logging.py`, the function `configure_logging` was modified to accept an additional parameter `redis_url`. The function now conditionally includes Redis logging if a `redis_url` is provided, and updates the processors list accordingly.

**Why it was Likely Changed:**
This change likely supports integrating with a Redis backend for structured logging. Adding this parameter allows the system to optionally send logs via Redis pub/sub, which can be useful for real-time monitoring or aggregating logs across multiple instances.

**Impact on Behavior:**
The function now has more flexibility in how it processes and outputs logs. If `redis_url` is provided, logs will be sent through Redis; otherwise, they will be output to the console or JSON file based on the `json_mode` parameter.

**Risks or Concerns:**
- **Dependency Management:** Ensuring that the necessary Redis dependencies are correctly installed.
- **Configuration Complexity:** The new parameter might add complexity for users who do not need this feature, potentially leading to confusion.
- **Performance Impact:** Sending logs through Redis could introduce latency if not properly optimized.

Overall, this change enhances the logging system's flexibility and potential integration with other services like Redis.

---

*Generated by CodeWorm on 2026-02-23 21:35*
