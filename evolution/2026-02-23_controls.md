# controls

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/benchmark/controls.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/benchmark/controls.go
Change type: new file

Diff:
@@ -0,0 +1,1693 @@
+/*
+AngelaMos | 2025
+controls.go
+*/
+
+package benchmark
+
+import "github.com/CarterPerez-dev/docksec/internal/finding"
+
+// Control represents a CIS Docker Benchmark control with its metadata,
+// including severity level, remediation guidance, and references.
+type Control struct {
+	ID          string
+	Section     string
+	Title       string
+	Description string
+	Remediation string
+	Severity    finding.Severity
+	Scored      bool
+	Level       int
+	References  []string
+}
+
+// ToCISControl converts this Control to a finding.CISControl for embedding
+// in security findings.
+func (c Control) ToCISControl() *finding.CISControl {
+	return &finding.CISControl{
+		ID:          c.ID,
+		Section:     c.Section,
+		Title:       c.Title,
+		Description: c.Description,
+		Scored:      c.Scored,
+		Level:       c.Level,
+	}
+}
+
+var controlRegistry = make(map[string]Control)
+
+// Register adds a CIS control to the global registry, keyed by control ID.
+func Register(c Control) {
+	controlRegistry[c.ID] = c
+}
+
+// Get retrieves a control from the registry by its ID.
+// Returns the control and true if found, or zero value and false if not.
+func Get(id string) (Control, bool) {
+	c, ok := controlRegistry[id]
+	return c, ok
+}
+
+// All returns a slice of all registered CIS controls.
+func All() []Control {
+	controls := make([]Control, 0, len(controlRegistry))
+	for _, c := range controlRegistry {
+		controls = append(controls, c)
+	}
+	return controls
+}
+
+// BySection returns all controls belonging to the specified CIS section.
+func BySection(section string) []Control {
+	var controls []Control
+	for _, c := range controlRegistry {
+		if c.Section == section {
+			controls = append(controls, c)
+		}
+	}
+	return controls
+}
+
+func init() {
+	registerHostControls()
+	registerDaemonControls()
+	registerDaemonFilesControls()
+	registerImageControls()
+	registerContainerRuntimeControls()
+	registerSecurityOperationsControls()
+	registerSwarmControls()
+}
+
+func registerHostControls() {
+	Register(Control{
+		ID:          "1.1.1",
+		Section:     "Host Configuration",
+		Title:       "Ensure a separate partition for containers has been created",
+		Severity:    finding.SeverityMedium,
+		Description: "All Docker containers and their data and metadata are stored under /var/lib/docker directory. By default, this directory is stored on the same partition as the root filesystem. A separate partition provides isolation and prevents DoS attacks from filling up the host filesystem.",
+		Remediation: "Create a separate partition for /var/lib/docker. Use LVM or partition management tools during system installation or configuration.",
+		Scored:      true,
+		Level:       1,
+		References:  []string{"https://docs.docker.com/storage/"},
+	})
+
+	Register(Control{
+		ID:          "1.1.2",
+		Section:   
```

---

## Code Evolution

### Change Analysis for `internal/benchmark/controls.go`

**What was Changed:**
The file `internal/benchmark/controls.go` was added as part of the initial release, introducing a new struct `Control` to represent CIS Docker Benchmark controls and associated functions for managing these controls. The code includes methods like `ToCISControl`, which converts `Control` instances into `finding.CISControl` objects, and registry functions such as `Register`, `Get`, `All`, and `BySection`.

**Why it was Likely Changed:**
This change likely aims to centralize the management of CIS Docker Benchmark controls within a single file. The introduction of a global registry (`controlRegistry`) allows for easy access and manipulation of these controls, facilitating their use in security findings.

**Impact on Behavior:**
The addition of this file enhances the functionality by providing tools to manage and retrieve CIS controls. This impacts the overall security assessment process, making it easier to integrate and audit Docker configurations according to CIS benchmarks.

**Risks or Concerns:**
While the implementation appears robust, there are a few potential risks:
- **Data Duplication:** If multiple parts of the codebase need to access these controls, ensuring consistency across all references is crucial.
- **Performance Impact:** The use of a global map (`controlRegistry`) could impact performance if not managed carefully. Ensuring efficient lookups and updates will be important.

Overall, this change significantly improves the structure and manageability of CIS Docker Benchmark controls within the `docksec` repository.

---

*Generated by CodeWorm on 2026-02-23 15:35*
