# query.strategies

**Type:** Code Evolution
**Repository:** CertGames-Core
**File:** frontend/user-app/src/core/app/query.strategies.ts
**Language:** typescript
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```typescript
Commit: 93bdad8f
Message: fix possible leaking (#170)
Author: Carter Perez
File: frontend/user-app/src/core/app/query.strategies.ts
Change type: modified

Diff:
@@ -1,6 +1,6 @@
 // ===========================
 // Query Strategies
-// ©AngelaMos | 2025
+// ©AngelaMos | 2026
 // ===========================
 
 import { AxiosError } from 'axios';
@@ -46,12 +46,12 @@ export const QUERY_STRATEGIES = {
    * STATIC_REFERENCE - Configuration and reference data
    * - Business: Achievement definitions, system config rarely change
    * - Stale: 15 minutes (very stable data)
-   * - Cache: 30 minutes (optimize bandwidth)
+   * - Cache: 20 minutes (prevent unbounded memory growth)
    * - Retry: 3 attempts (infrastructure issues should be retried)
    */
   STATIC_REFERENCE: {
-    staleTime: 30 * 60 * 1000,
-    gcTime: 60 * 60 * 1000,
+    staleTime: 15 * 60 * 1000,
+    gcTime: 20 * 60 * 1000,
     retry: (failureCount: number, error: unknown): boolean => {
       if (error instanceof AxiosError) {
         const status = error.response?.status;
@@ -175,17 +175,15 @@ export const QUERY_STRATEGIES = {
   },
 
   /**
-   * STUDY_RESOURCES - Ultra-long cached study resources
-   * - Business: YouTube links, articles, study materials NEVER change
-   * - Stale: 7 days (resources added rarely, ~weekly max)
-   * - Cache: 7 days (aggressive caching - static content)
+   * STUDY_RESOURCES - Long cached study resources
+   * - Business: YouTube links, articles, study materials rarely change
+   * - Stale: 1 hour (resources added infrequently)
+   * - Cache: 1 hour (prevent unbounded memory growth from infinite scroll pages)
    * - Retry: 3 attempts (infrastructure issues should be retried)
-   * - Why 7 days: Resources are static reference data, added manually/infrequently
-   * - Performance: Huge bandwidth savings, instant loads after first fetch
    */
   STUDY_RESOURCES: {
-    staleTime: 7 * 24 * 60 * 60 * 1000,
-    gcTime: 7 * 24 * 60 * 60 * 1000,
+    staleTime: 60 * 60 * 1000,
+    gcTime: 60 * 60 * 1000,
     retry: (failureCount: number, error: unknown): boolean => {
       if (error instanceof AxiosError) {
         const status = error.response?.status;

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The commit `93bdad8f` modifies the `query.strategies.ts` file in the frontend/user-app/src/core/app directory. Specifically, the staleTime and gcTime values for several query strategies have been adjusted. The `STATIC_REFERENCE` strategy now has a shorter cache duration of 20 minutes instead of 30 minutes, while the `STUDY_RESOURCES` strategy's cache and garbage collection times are both set to 1 hour.

**Why it was Likely Changed:**
This change likely addresses potential memory leaks by reducing the cache duration for strategies that may accumulate data over time. The `STATIC_REFERENCE` strategy now has a more aggressive garbage collection policy, preventing unbounded memory growth. For the `STUDY_RESOURCES` strategy, setting both staleTime and gcTime to 1 hour ensures that cached resources are refreshed regularly, mitigating risks associated with infinite scroll pages.

**Impact on Behavior:**
The updated cache times will result in more frequent updates for certain query strategies, potentially improving data freshness but also increasing the frequency of network requests. This could impact performance metrics such as load time and bandwidth usage.

**Risks or Concerns:**
There is a risk that reducing the cache duration might lead to increased server load due to more frequent API calls. Additionally, users may experience slight delays in loading cached content initially after an update. However, these risks are mitigated by the aggressive retry logic for infrastructure issues and the overall stability of the data involved.

Overall, this change aims to balance performance with memory management, addressing potential issues identified in issue #170.

---

*Generated by CodeWorm on 2026-02-22 08:24*
