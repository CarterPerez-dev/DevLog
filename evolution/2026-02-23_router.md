# router

**Type:** Code Evolution
**Repository:** angelamos-3d
**File:** backend/app/wake/router.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: a61e4cd8
Message: feat: complete mvp v1.0.0
Author: CarterPerez-dev
File: backend/app/wake/router.py
Change type: new file

Diff:
@@ -0,0 +1,54 @@
+"""
+Â©AngelaMos | 2026
+router.py
+"""
+
+from fastapi import APIRouter, WebSocket, WebSocketDisconnect
+
+from app.wake import service
+from app.wake.schemas import WakeWordModelsResponse
+
+
+router = APIRouter()
+
+
+@router.get("/wakeword/models", response_model = WakeWordModelsResponse)
+async def list_models() -> WakeWordModelsResponse:
+    """
+    List available wake word models.
+    """
+    return WakeWordModelsResponse(models = service.list_models())
+
+
+@router.websocket("/ws/wake")
+async def websocket_detect(websocket: WebSocket) -> None:
+    """
+    WebSocket endpoint for real-time wake word detection.
+    Send audio chunks as binary, receive JSON detection events.
+    """
+    await websocket.accept()
+
+    model = service.create_session_model()
+
+    try:
+        while True:
+            msg = await websocket.receive()
+
+            if msg.get("type") == "websocket.disconnect":
+                break
+
+            if "text" in msg:
+                if msg["text"] == "reset":
+                    model.reset()
+                continue
+
+            if "bytes" not in msg:
+                continue
+
+            detections = service.process_audio(model, msg["bytes"])
+
+            for detection in detections:
+                await websocket.send_json(detection.model_dump())
+
+    except WebSocketDisconnect:
+        pass

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `router.py` was added to the `backend/app/wake` directory, introducing two main components:
1. An API endpoint `/wakeword/models` that returns a list of available wake word models.
2. A WebSocket endpoint `/ws/wake` for real-time wake word detection.

**Why it was Likely Changed:**
This change likely represents the completion of MVP v1.0.0, adding essential functionalities to the wake word recognition system:
- **GET /wakeword/models**: Provides a list of available models, useful for user configuration.
- **WebSocket Endpoint**: Enables real-time detection and feedback, enhancing interactivity.

**Impact on Behavior:**
The addition of these endpoints significantly enhances the application's functionality. Users can now manage wake word models and interact with the system in real time via WebSocket, improving usability and responsiveness.

**Risks or Concerns:**
- **WebSocket Handling**: The WebSocket implementation could potentially lead to resource leaks if not properly managed.
- **Error Handling**: The current error handling for `WebSocketDisconnect` is minimal. Consider adding more robust error logging and handling mechanisms.
- **Security**: Ensure that the WebSocket endpoint is secured, especially when dealing with binary data transmission.

Overall, this change introduces valuable features but requires careful consideration of potential risks.

---

*Generated by CodeWorm on 2026-02-23 19:07*
