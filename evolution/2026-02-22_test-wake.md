# test_wake

**Type:** Code Evolution
**Repository:** angelamos-operations
**File:** Angela-Wake/test_wake.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: dae6cf01
Message: add checklist tool
Author: CarterPerez-dev
File: Angela-Wake/test_wake.py
Change type: new file

Diff:
@@ -0,0 +1,53 @@
+#!/usr/bin/env python3
+"""
+Quick test script for Angela wake word detection.
+Say "angela" into your mic and watch for detections.
+"""
+
+import asyncio
+import json
+import numpy as np
+import sounddevice as sd
+import websockets
+
+SAMPLE_RATE = 16000
+CHUNK_MS = 80
+CHUNK_SAMPLES = int(SAMPLE_RATE * CHUNK_MS / 1000)
+
+async def test_wake_word():
+    uri = "ws://localhost:5003/ws"
+
+    print("Connecting to Angela-Wake server...")
+    async with websockets.connect(uri) as ws:
+        print("Connected! Say 'angela' into your mic...")
+        print("Press Ctrl+C to stop\n")
+
+        def audio_callback(indata, frames, time, status):
+            if status:
+                print(f"Audio status: {status}")
+            audio_bytes = (indata[:, 0] * 32767).astype(np.int16).tobytes()
+            asyncio.run_coroutine_threadsafe(ws.send(audio_bytes), loop)
+
+        loop = asyncio.get_event_loop()
+
+        with sd.InputStream(
+            samplerate=SAMPLE_RATE,
+            channels=1,
+            dtype=np.float32,
+            blocksize=CHUNK_SAMPLES,
+            callback=audio_callback
+        ):
+            while True:
+                try:
+                    msg = await asyncio.wait_for(ws.recv(), timeout=0.1)
+                    data = json.loads(msg)
+                    if data.get("detected"):
+                        print(f">>> DETECTED: {data['model']} (score: {data['score']:.3f})")
+                except asyncio.TimeoutError:
+                    pass
+
+if __name__ == "__main__":
+    try:
+        asyncio.run(test_wake_word())
+    except KeyboardInterrupt:
+        print("\nStopped.")

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `test_wake.py` was added to the repository. This script is a test tool for Angela wake word detection, allowing users to say "angela" into their microphone and observe detections.

- **Added:** The script includes imports for necessary libraries (`asyncio`, `json`, `numpy`, `sounddevice`, `websockets`).
- **Added:** An asynchronous function `test_wake_word()` that sets up a WebSocket connection, captures audio input, and processes it.
- **Added:** Audio processing logic within an `audio_callback` function to handle incoming audio data.

**Why It Was Likely Changed:**
This change was likely made to facilitate testing of the wake word detection system. The script provides a straightforward way for developers or testers to verify that the wake word "angela" is correctly detected when spoken into the microphone.

**Impact on Behavior:**
The new script allows users to test the wake word detection functionality by speaking into their microphone and observing real-time detections in the console. It connects to the Angela-Wake server, captures audio chunks, and sends them for processing while listening for detection responses.

**Risks or Concerns:**
- **Resource Usage:** The script continuously runs an audio stream, which could consume significant system resources.
- **Network Dependency:** Reliance on a WebSocket connection means that network issues could disrupt testing.
- **User Interaction:** Users must manually stop the script by pressing Ctrl+C, which could be inconvenient for extended testing sessions.

---

*Generated by CodeWorm on 2026-02-22 19:28*
