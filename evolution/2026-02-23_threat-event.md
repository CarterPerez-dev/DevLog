# threat_event

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/app/models/threat_event.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 7f35fbd8
Message: feat: complete Phase 1 â€” rule-based detection pipeline, API, Docker E2E

Phase 1 delivers end-to-end threat detection from nginx log ingestion
through rule-based scoring to REST API and WebSocket alerts.

- API layer: /threats, /stats, /models/status, /ws/alerts, /health, /ready
- Alert dispatcher with Redis pub/sub + PostgreSQL persistence
- Typer CLI: vigil serve, config, health
- Integration tests (tailer -> pipeline -> DB round-trip)
- Docker E2E verified: dev.compose.yml stack with all services healthy
- Linting clean: ruff, mypy strict (0 issues), pylint 10/10
- 75 tests passing across 8 test modules
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/app/models/threat_event.py
Change type: modified

Diff:
@@ -3,7 +3,14 @@
 threat_event.py
 """
 
-from sqlalchemy import Column, Float, Index, JSON, SmallInteger, text
+from sqlalchemy import (
+    Column,
+    Float,
+    Index,
+    JSON,
+    SmallInteger,
+    text,
+)
 from sqlmodel import Field
 
 from app.models.base import TimestampedModel
@@ -30,25 +37,17 @@ class ThreatEvent(TimestampedModel, table=True):
     source_ip: str = Field(max_length=45)
     request_method: str = Field(max_length=10)
     request_path: str
-    status_code: int = Field(
-        sa_column=Column(SmallInteger, nullable=False)
-    )
+    status_code: int = Field(sa_column=Column(SmallInteger, nullable=False))
     response_size: int
     user_agent: str
-    threat_score: float = Field(
-        sa_column=Column(Float, nullable=False)
-    )
+    threat_score: float = Field(sa_column=Column(Float, nullable=False))
     severity: str = Field(max_length=6)
-    component_scores: dict[str, float] = Field(
-        sa_column=Column(JSON, nullable=False)
-    )
+    component_scores: dict[str, float] = Field(sa_column=Column(JSON, nullable=False))
     geo_country: str | None = Field(default=None, max_length=2)
     geo_city: str | None = Field(default=None, max_length=255)
     geo_lat: float | None = Field(default=None)
     geo_lon: float | None = Field(default=None)
-    feature_vector: list[float] = Field(
-        sa_column=Column(JSON, nullable=False)
-    )
+    feature_vector: list[float] = Field(sa_column=Column(JSON, nullable=False))
     matched_rules: list[str] | None = Field(
         default=None, sa_column=Column(JSON, nullable=True)
     )

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
In `app/models/threat_event.py`, the code now uses parentheses to group imports and adds type hints for fields in the `ThreatEvent` class. Specifically, the `status_code`, `threat_score`, `component_scores`, and `feature_vector` fields have their `sa_column` attributes moved inside the `Field` function.

**Why it was Likely Changed:**
This change likely aims to improve code readability and adhere to Pythonic patterns by grouping related imports together. Moving the `sa_column` attribute directly into the `Field` call simplifies the syntax and makes the field definitions clearer.

**Impact on Behavior:**
The behavior of the `ThreatEvent` model remains unchanged. The fields still have the same column types, constraints, and default values as before. This change does not affect data storage or retrieval logic.

**Risks or Concerns:**
There are no apparent risks associated with this change. It is a refactoring that improves code structure without altering functionality. However, it's important to ensure that any changes in syntax do not inadvertently introduce bugs, especially when dealing with complex models and database interactions.

Overall, this change enhances the readability of the model definitions while maintaining the integrity of the threat event data schema.

---

*Generated by CodeWorm on 2026-02-23 08:02*
