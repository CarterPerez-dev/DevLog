# stats

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/app/schemas/stats.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 7f35fbd8
Message: feat: complete Phase 1 — rule-based detection pipeline, API, Docker E2E

Phase 1 delivers end-to-end threat detection from nginx log ingestion
through rule-based scoring to REST API and WebSocket alerts.

- API layer: /threats, /stats, /models/status, /ws/alerts, /health, /ready
- Alert dispatcher with Redis pub/sub + PostgreSQL persistence
- Typer CLI: vigil serve, config, health
- Integration tests (tailer -> pipeline -> DB round-trip)
- Docker E2E verified: dev.compose.yml stack with all services healthy
- Linting clean: ruff, mypy strict (0 issues), pylint 10/10
- 75 tests passing across 8 test modules
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/app/schemas/stats.py
Change type: new file

Diff:
@@ -0,0 +1,47 @@
+"""
+©AngelaMos | 2026
+stats.py
+"""
+
+from pydantic import BaseModel
+
+
+class SeverityBreakdown(BaseModel):
+    """
+    Count of threats per severity tier.
+    """
+
+    high: int = 0
+    medium: int = 0
+    low: int = 0
+
+
+class IPStatEntry(BaseModel):
+    """
+    Source IP with associated threat count.
+    """
+
+    source_ip: str
+    count: int
+
+
+class PathStatEntry(BaseModel):
+    """
+    Request path with associated threat count.
+    """
+
+    path: str
+    count: int
+
+
+class StatsResponse(BaseModel):
+    """
+    Aggregate threat statistics for a given time range.
+    """
+
+    time_range: str
+    total_requests: int
+    threats_detected: int
+    severity_breakdown: SeverityBreakdown
+    top_source_ips: list[IPStatEntry]
+    top_attacked_paths: list[PathStatEntry]

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `stats.py` was added to the project, introducing Pydantic models for aggregating and representing threat statistics. The file defines three main data classes: `SeverityBreakdown`, `IPStatEntry`, and `PathStatEntry`. These models are used to structure API responses related to threat detection metrics.

**Why it was Likely Changed:**
This change likely supports the completion of Phase 1 by providing a standardized way to represent statistical data about threats. The introduction of these models ensures that the backend can consistently return structured JSON responses for various endpoints, such as `/stats`, which are crucial for monitoring and reporting threat activity.

**Impact on Behavior:**
The addition of these models will affect how API responses are formatted. Clients interacting with the `/stats` endpoint will now receive a well-structured response containing detailed statistics about threats, including counts by severity, top source IPs, and attacked paths. This improves the clarity and usability of the API for monitoring tools or dashboards.

**Risks or Concerns:**
While the addition of these models is beneficial, there is a risk that changes to these schemas might break existing clients if not properly communicated and managed during future updates. Additionally, ensuring that all test cases cover these new response structures will be important to maintain API stability.

---

*Generated by CodeWorm on 2026-02-23 07:23*
