# ReferralProgram

**Type:** Code Evolution
**Repository:** stripe-referral
**File:** src/stripe_referral/models/ReferralProgram.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: bfb52633
Message: feat: Done
Author: CarterPerez-dev
File: src/stripe_referral/models/ReferralProgram.py
Change type: new file

Diff:
@@ -0,0 +1,104 @@
+"""
+ⒸAngelaMos | 2025 | CertGames.com
+ReferralProgram model
+"""
+
+from __future__ import annotations
+
+from typing import (
+    TYPE_CHECKING,
+    Any,
+)
+
+from sqlalchemy import (
+    JSON,
+    Boolean,
+    Float,
+    Integer,
+    String,
+)
+from sqlalchemy.orm import (
+    Mapped,
+    mapped_column,
+    relationship,
+)
+
+from ..config.constants import (
+    MAX_PROGRAM_KEY_LENGTH,
+    MAX_PROGRAM_NAME_LENGTH,
+)
+from ..config.enums import (
+    AdapterType,
+    CurrencyCode,
+    RewardType,
+)
+from ..database.Base import (
+    Base,
+    TimestampMixin,
+)
+
+if TYPE_CHECKING:
+    from .ReferralCode import ReferralCode
+    from .ReferralTracking import ReferralTracking
+
+
+class ReferralProgram(Base, TimestampMixin):
+    """
+    Referral program configuration
+    """
+    __tablename__ = "referral_programs"
+
+    id: Mapped[int] = mapped_column(
+        primary_key = True,
+        autoincrement = True
+    )
+    name: Mapped[str] = mapped_column(
+        String(MAX_PROGRAM_NAME_LENGTH),
+        unique = True,
+        index = True
+    )
+    program_key: Mapped[str] = mapped_column(
+        String(MAX_PROGRAM_KEY_LENGTH),
+        unique = True,
+        index = True
+    )
+
+    reward_amount: Mapped[float] = mapped_column(Float, nullable = False)
+    reward_currency: Mapped[str] = mapped_column(
+        String(3),
+        default = CurrencyCode.USD.value
+    )
+    reward_type: Mapped[str] = mapped_column(
+        String(50),
+        default = RewardType.ONE_TIME.value
+    )
+
+    is_active: Mapped[bool] = mapped_column(Boolean, default = True)
+    max_rewards_per_user: Mapped[int | None] = mapped_column(
+        Integer,
+        nullable = True
+    )
+    conversion_window_days: Mapped[int | None] = mapped_column(
+        Integer,
+        nullable = True
+    )
+
+    adapter_type: Mapped[str] = mapped_column(
+        String(50),
+        default = AdapterType.MANUAL.value
+    )
+    adapter_config: Mapped[dict[str,
+                                Any]] = mapped_column(
+                                    JSON,
+                                    default = dict
+                                )
+
+    codes: Mapped[list[ReferralCode]] = relationship(
+        "ReferralCode",
+        back_populates = "program",
+        cascade = "all, delete-orphan"
+    )
+    trackings: Mapped[list[ReferralTracking]] = relationship(
+        "ReferralTracking",
+        back_populates = "program"
+    )

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `ReferralProgram.py` was added to the repository, introducing a SQLAlchemy model class named `ReferralProgram`. This class defines attributes and relationships for managing referral program configurations within the application.

**Why it was Likely Changed:**
This change likely represents an enhancement or addition to the application's feature set related to managing referral programs. The introduction of this model suggests that the developers are expanding the system’s capabilities to handle more complex referral logic, such as tracking rewards, user limits, and conversion windows.

**Impact on Behavior:**
The `ReferralProgram` class will enable the application to store and manage detailed configurations for each referral program. This includes attributes like reward amounts, currency types, active status, and adapter settings. The relationships with `ReferralCode` and `ReferralTracking` classes suggest that it also supports tracking individual codes and user interactions.

**Risks or Concerns:**
- **Data Integrity:** Ensuring that the `reward_type`, `adapter_type`, and other string fields are correctly validated.
- **Performance:** With potential large numbers of referral programs, indexing and query optimization will be important to maintain performance.
- **Configuration Management:** The use of JSON for adapter configurations may introduce flexibility but also complexity in handling dynamic settings.

Overall, this change significantly enhances the application’s ability to manage complex referral program logic.

---

*Generated by CodeWorm on 2026-02-23 02:43*
