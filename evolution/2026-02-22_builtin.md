# builtin

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/rules/builtin.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/rules/builtin.go
Change type: new file

Diff:
@@ -0,0 +1,1742 @@
+// ©AngelaMos | 2026
+// builtin.go
+
+package rules
+
+import (
+	"regexp"
+
+	"github.com/CarterPerez-dev/portia/pkg/types"
+)
+
+func ptr(f float64) *float64 { return &f }
+
+func RegisterBuiltins(reg *Registry) {
+	for _, r := range builtinRules {
+		reg.Register(r)
+	}
+}
+
+var builtinRules = []*types.Rule{
+	{
+		ID:          "aws-access-key-id",
+		Description: "AWS Access Key ID",
+		Severity:    types.SeverityCritical,
+		Keywords:    []string{"AKIA"},
+		Pattern: regexp.MustCompile(
+			`\b((?:AKIA|ABIA|ACCA|ASIA)[0-9A-Z]{16})\b`,
+		),
+		SecretGroup: 1,
+		SecretType:  types.SecretTypeAPIKey,
+	},
+	{
+		ID:          "aws-secret-access-key",
+		Description: "AWS Secret Access Key",
+		Severity:    types.SeverityCritical,
+		Keywords:    []string{"aws_secret", "aws_access", "secret_access"},
+		Pattern: regexp.MustCompile(
+			`(?i)(?:aws_secret_access_key|aws_secret|secret_access)` +
+				`[\s=:'"]+([A-Za-z0-9/+=]{40})\b`,
+		),
+		SecretGroup: 1,
+		Entropy:     ptr(3.5),
+		SecretType:  types.SecretTypeAPIKey,
+	},
+	{
+		ID:          "aws-session-token",
+		Description: "AWS Session Token",
+		Severity:    types.SeverityHigh,
+		Keywords:    []string{"aws_session_token"},
+		Pattern: regexp.MustCompile(
+			`(?i)aws_session_token[\s=:'"]+` +
+				`([A-Za-z0-9/+=]{100,})\b`,
+		),
+		SecretGroup: 1,
+		SecretType:  types.SecretTypeToken,
+	},
+	{
+		ID:          "github-pat-fine",
+		Description: "GitHub Fine-Grained Personal Access Token",
+		Severity:    types.SeverityCritical,
+		Keywords:    []string{"github_pat_"},
+		Pattern: regexp.MustCompile(
+			`\b(github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})\b`,
+		),
+		SecretGroup: 1,
+		SecretType:  types.SecretTypeToken,
+	},
+	{
+		ID:          "github-pat-classic",
+		Description: "GitHub Personal Access Token (Classic)",
+		Severity:    types.SeverityCritical,
+		Keywords:    []string{"ghp_"},
+		Pattern: regexp.MustCompile(
+			`\b(ghp_[a-zA-Z0-9]{36})\b`,
+		),
+		SecretGroup: 1,
+		SecretType:  types.SecretTypeToken,
+	},
+	{
+		ID:          "github-oauth-token",
+		Description: "GitHub OAuth Access Token",
+		Severity:    types.SeverityCritical,
+		Keywords:    []string{"gho_"},
+		Pattern: regexp.MustCompile(
+			`\b(gho_[a-zA-Z0-9]{36})\b`,
+		),
+		SecretGroup: 1,
+		SecretType:  types.SecretTypeToken,
+	},
+	{
+		ID:          "github-app-token",
+		Description: "GitHub App Installation Token",
+		Severity:    types.SeverityHigh,
+		Keywords:    []string{"ghs_"},
+		Pattern: regexp.MustCompile(
+			`\b(ghs_[a-zA-Z0-9]{36})\b`,
+		),
+		SecretGroup: 1,
+		SecretType:  types.SecretTypeToken,
+	},
+	{
+		ID:          "github-refresh-token",
+		Description: "GitHub Refresh Token",
+		Severity:    types.SeverityHigh,
+		Keywords:    []string{"ghr_"},
+		Pattern: regexp.M
```

---

## Code Evolution

### Change Analysis for `builtin.go`

**What was Changed:**
A new file `builtin.go` was added to the `internal/rules` package, containing a list of predefined rules (`builtinRules`). These rules are designed to detect common secrets such as AWS access keys, GitHub personal access tokens, GitLab tokens, Google Cloud Platform API keys, and Azure client secrets. Each rule includes an ID, description, severity level, keywords, regex pattern for detection, secret group, entropy (for some), and the type of secret.

**Why it was Likely Changed:**
This change likely aims to enhance the `secrets-scanner` tool by adding a set of built-in rules that can automatically detect known secrets. This is part of completing the Go version of Portia's secrets scanner as indicated in the commit message, ensuring robust detection capabilities out-of-the-box.

**Impact on Behavior:**
The addition of these rules will significantly improve the tool’s ability to identify and categorize sensitive information like API keys and tokens across multiple platforms (AWS, GitHub, GitLab, GCP, Azure). This enhances security by making it easier for users to quickly locate and manage their secrets.

**Risks or Concerns:**
While adding predefined rules is beneficial, there's a risk that these might not cover all possible variations of secret values. Additionally, the regex patterns used should be carefully tested to avoid false positives or negatives. The entropy check in some cases could also introduce complexity without significantly improving detection accuracy.

---

*Generated by CodeWorm on 2026-02-22 21:29*
