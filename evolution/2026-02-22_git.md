# git

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/cli/git.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/cli/git.go
Change type: new file

Diff:
@@ -0,0 +1,72 @@
+// Â©AngelaMos | 2026
+// git.go
+
+package cli
+
+import (
+	"github.com/spf13/cobra"
+
+	"github.com/CarterPerez-dev/portia/internal/rules"
+	"github.com/CarterPerez-dev/portia/internal/source"
+	"github.com/CarterPerez-dev/portia/internal/ui"
+)
+
+var (
+	gitBranch  string
+	gitSince   string
+	gitDepth   int
+	stagedOnly bool
+)
+
+var gitCmd = &cobra.Command{
+	Use:   "git [repo-path]",
+	Short: "Scan git repository history for secrets",
+	Args:  cobra.MaximumNArgs(1),
+	RunE:  runGit,
+}
+
+func init() {
+	gitCmd.Flags().StringVarP(
+		&gitBranch, "branch", "b", "",
+		"branch to scan (default: HEAD)",
+	)
+	gitCmd.Flags().StringVar(
+		&gitSince, "since", "",
+		"scan commits since date (YYYY-MM-DD)",
+	)
+	gitCmd.Flags().IntVarP(
+		&gitDepth, "depth", "d", 0,
+		"max number of commits to scan (0 = all)",
+	)
+	gitCmd.Flags().BoolVar(
+		&stagedOnly, "staged", false,
+		"scan only staged changes",
+	)
+}
+
+func runGit(cmd *cobra.Command, args []string) error {
+	path := "."
+	if len(args) > 0 {
+		path = args[0]
+	}
+
+	ui.PrintBanner()
+
+	reg := rules.NewRegistry()
+	rules.RegisterBuiltins(reg)
+	applyRuleConfig(reg)
+
+	if gitSince == "" && cfg != nil && cfg.Scan.Since != "" {
+		gitSince = cfg.Scan.Since
+	}
+	if gitDepth == 0 && cfg != nil && cfg.Scan.Depth > 0 {
+		gitDepth = cfg.Scan.Depth
+	}
+
+	src := source.NewGit(
+		path, gitBranch, gitSince, gitDepth,
+		stagedOnly, maxSize, excludes,
+	)
+
+	return executeScan(cmd.Context(), reg, src)
+}

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `git.go` was added to the `internal/cli` package, introducing a command-line interface for scanning Git repositories for secrets. The file includes a `cobra.Command` definition (`gitCmd`) with flags for specifying the repository path, branch, commit range, and depth of scan.

**Why it Was Likely Changed:**
This change likely aims to enhance the `secrets-scanner` tool by adding support for scanning Git repositories specifically. The introduction of command-line options allows users to customize the scope and depth of the secret detection process, making the tool more versatile and user-friendly.

**Impact on Behavior:**
The addition of this file significantly expands the functionality of the `secrets-scanner`. Users can now scan Git repositories by specifying various parameters such as branch, commit range, and depth. This feature improves the tool's ability to handle different scanning scenarios, from quick checks to comprehensive audits.

**Risks or Concerns:**
While the new functionality is beneficial, there are a few potential risks:
- **Error Handling:** The `runGit` function relies on external configurations (`cfg`) that may not always be available. Proper error handling should ensure the tool behaves gracefully when these values are missing.
- **Resource Management:** Scanning deep commit histories or large repositories could consume significant resources. Careful management of memory and CPU usage is necessary to prevent performance issues.

Overall, this change enhances the `secrets-scanner` by providing more granular control over Git repository scans.

---

*Generated by CodeWorm on 2026-02-22 20:08*
