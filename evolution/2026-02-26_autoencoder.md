# autoencoder

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/ml/autoencoder.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 9397b12a
Message: add learn folder, move hidden files, update root readme, add learn folder, add clang tidy, and format
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/ml/autoencoder.py
Change type: new file

Diff:
@@ -0,0 +1,74 @@
+"""
+©AngelaMos | 2026
+autoencoder.py
+"""
+
+import torch
+from torch import Tensor, nn
+
+
+class ThreatAutoencoder(nn.Module):
+    """
+    Symmetric autoencoder for HTTP request anomaly detection.
+
+    Architecture (35-dim input):
+        Encoder: 35 → 24 → 12 → 6 (bottleneck)
+        Decoder: 6 → 12 → 24 → 35
+
+    Trained on normal traffic only. High reconstruction error
+    indicates an anomalous (potentially malicious) request.
+    """
+
+    def __init__(self, input_dim: int = 35) -> None:
+        super().__init__()
+        self.input_dim = input_dim
+
+        self.encoder = nn.Sequential(
+            nn.Linear(input_dim, 24),
+            nn.BatchNorm1d(24),
+            nn.LeakyReLU(0.2),
+            nn.Dropout(0.2),
+            nn.Linear(24, 12),
+            nn.BatchNorm1d(12),
+            nn.LeakyReLU(0.2),
+            nn.Dropout(0.2),
+            nn.Linear(12, 6),
+        )
+
+        self.decoder = nn.Sequential(
+            nn.Linear(6, 12),
+            nn.BatchNorm1d(12),
+            nn.LeakyReLU(0.2),
+            nn.Dropout(0.2),
+            nn.Linear(12, 24),
+            nn.BatchNorm1d(24),
+            nn.LeakyReLU(0.2),
+            nn.Dropout(0.2),
+            nn.Linear(24, input_dim),
+            nn.Sigmoid(),
+        )
+
+    def encode(self, x: Tensor) -> Tensor:
+        """
+        Compress input through the encoder to the 6-dim bottleneck.
+        """
+        return self.encoder(x)
+
+    def decode(self, z: Tensor) -> Tensor:
+        """
+        Reconstruct input from the bottleneck representation.
+        """
+        return self.decoder(z)
+
+    def forward(self, x: Tensor) -> Tensor:
+        """
+        Full forward pass: encode then decode.
+        """
+        return self.decode(self.encode(x))
+
+    def compute_reconstruction_error(self, x: Tensor) -> Tensor:
+        """
+        Per-sample mean squared error between input and reconstruction.
+        """
+        reconstructed = self.forward(x)
+        return torch.mean((x - reconstructed) ** 2, dim=1)

```

---

## Code Evolution

### Change Analysis for `PROJECTS/advanced/ai-threat-detection/backend/ml/autoencoder.py`

**What was Changed:**
A new file, `autoencoder.py`, was added to the repository. This file introduces a custom autoencoder model for detecting anomalies in HTTP requests using PyTorch.

**Why it was Likely Changed:**
The addition of this file likely aims to implement an advanced machine learning technique specifically tailored for threat detection in network traffic data. The use of an autoencoder is common in anomaly detection tasks, where the model learns a compressed representation (bottleneck) and then reconstructs the input from this representation. High reconstruction error can indicate anomalies.

**Impact on Behavior:**
The new `ThreatAutoencoder` class provides methods for encoding inputs into a bottleneck layer and decoding them back to their original form. The forward pass method combines these steps, while an additional method calculates per-sample mean squared errors between the input and reconstructed outputs, serving as a reconstruction error metric.

**Risks or Concerns:**
- **Overfitting Risk:** Since the model is trained only on normal traffic, it might not generalize well to new types of anomalies.
- **Complexity Management:** The architecture with multiple layers and dropout could be complex to tune. Care must be taken to ensure proper hyperparameter settings.
- **Performance Impact:** Training such a model can be resource-intensive, especially if the dataset is large.

Overall, this change significantly enhances the project's threat detection capabilities by introducing a sophisticated machine learning approach.

---

*Generated by CodeWorm on 2026-02-26 01:34*
