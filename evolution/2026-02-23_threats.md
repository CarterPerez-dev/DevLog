# threats

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/app/schemas/threats.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 7f35fbd8
Message: feat: complete Phase 1 — rule-based detection pipeline, API, Docker E2E

Phase 1 delivers end-to-end threat detection from nginx log ingestion
through rule-based scoring to REST API and WebSocket alerts.

- API layer: /threats, /stats, /models/status, /ws/alerts, /health, /ready
- Alert dispatcher with Redis pub/sub + PostgreSQL persistence
- Typer CLI: vigil serve, config, health
- Integration tests (tailer -> pipeline -> DB round-trip)
- Docker E2E verified: dev.compose.yml stack with all services healthy
- Linting clean: ruff, mypy strict (0 issues), pylint 10/10
- 75 tests passing across 8 test modules
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/app/schemas/threats.py
Change type: new file

Diff:
@@ -0,0 +1,57 @@
+"""
+©AngelaMos | 2026
+threats.py
+"""
+
+import uuid
+from datetime import datetime
+from typing import Literal
+
+from pydantic import BaseModel
+
+
+class GeoInfo(BaseModel):
+    """
+    Geographic location data from GeoIP lookup.
+    """
+
+    country: str | None = None
+    city: str | None = None
+    lat: float | None = None
+    lon: float | None = None
+
+
+class ThreatEventResponse(BaseModel):
+    """
+    Single threat event returned by the API.
+    """
+
+    id: uuid.UUID
+    created_at: datetime
+    source_ip: str
+    request_method: str
+    request_path: str
+    status_code: int
+    response_size: int
+    user_agent: str
+    threat_score: float
+    severity: Literal["HIGH", "MEDIUM", "LOW"]
+    component_scores: dict[str, float]
+    geo: GeoInfo
+    matched_rules: list[str] | None = None
+    model_version: str | None = None
+    reviewed: bool = False
+    review_label: str | None = None
+
+    model_config = {"from_attributes": True}
+
+
+class ThreatListResponse(BaseModel):
+    """
+    Paginated list of threat events.
+    """
+
+    total: int
+    limit: int
+    offset: int
+    items: list[ThreatEventResponse]

```

---

## Code Evolution

### Change Analysis for Commit 7f35fbd8

**What was Changed:**
A new file `threats.py` was added to the project, defining two Pydantic models: `ThreatEventResponse` and `ThreatListResponse`. These models are used to structure API responses related to threat events.

**Why it was Likely Changed:**
This change likely supports the newly implemented Phase 1 of the rule-based detection pipeline by providing a standardized schema for threat event data. The models ensure consistent data representation across the application, facilitating easier integration with the REST and WebSocket APIs.

**Impact on Behavior:**
The introduction of these models will impact how threat events are represented in API responses. They provide detailed information about each threat event, including geographic location (`GeoInfo`), severity level, component scores, and more. This enhances the clarity and utility of the API responses for both internal processing and external consumption.

**Risks or Concerns:**
While the addition of these models is generally beneficial, there are a few potential risks:
- **Backward Compatibility:** If existing code relies on older data structures, changes might be required.
- **Performance Impact:** The use of `uuid` and `datetime` could slightly impact performance if not optimized. 
- **Maintenance Overhead:** Ensuring these models remain up-to-date with any new threat detection rules or features will require ongoing maintenance.

Overall, this change is a significant step in completing Phase 1 by standardizing data representation for the threat detection pipeline.

---

*Generated by CodeWorm on 2026-02-23 07:19*
