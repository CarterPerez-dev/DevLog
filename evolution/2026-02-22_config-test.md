# config_test

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/config/config_test.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/config/config_test.go
Change type: new file

Diff:
@@ -0,0 +1,173 @@
+// Â©AngelaMos | 2026
+// config_test.go
+
+package config
+
+import (
+	"os"
+	"path/filepath"
+	"testing"
+
+	"github.com/stretchr/testify/assert"
+	"github.com/stretchr/testify/require"
+)
+
+func TestLoadExplicitPath(t *testing.T) {
+	t.Parallel()
+
+	dir := t.TempDir()
+	path := filepath.Join(dir, "portia.toml")
+
+	content := `
+[rules]
+disable = ["generic-password"]
+
+[scan]
+max_file_size = 2097152
+excludes = ["vendor/", "*.test.js"]
+
+[output]
+format = "json"
+verbose = true
+
+[hibp]
+enabled = true
+`
+	require.NoError(t, os.WriteFile(path, []byte(content), 0o644))
+
+	cfg, err := Load(path)
+	require.NoError(t, err)
+	require.NotNil(t, cfg)
+
+	assert.Equal(t, []string{"generic-password"}, cfg.Rules.Disable)
+	assert.Equal(t, int64(2097152), cfg.Scan.MaxFileSize)
+	assert.Equal(t, []string{"vendor/", "*.test.js"}, cfg.Scan.Excludes)
+	assert.Equal(t, "json", cfg.Output.Format)
+	assert.True(t, cfg.Output.Verbose)
+	assert.True(t, cfg.HIBP.Enabled)
+}
+
+func TestLoadNonexistentExplicitPath(t *testing.T) {
+	t.Parallel()
+
+	cfg, err := Load("/nonexistent/path/portia.toml")
+	require.NoError(t, err)
+	require.NotNil(t, cfg)
+	assert.Equal(t, "terminal", cfg.Output.Format)
+	assert.Equal(t, int64(1<<20), cfg.Scan.MaxFileSize)
+}
+
+func TestLoadEmptyPathReturnsDefaults(t *testing.T) {
+	dir := t.TempDir()
+	origDir, err := os.Getwd()
+	require.NoError(t, err)
+	require.NoError(t, os.Chdir(dir))
+	defer os.Chdir(origDir) //nolint:errcheck
+
+	cfg, err := Load("")
+	require.NoError(t, err)
+	require.NotNil(t, cfg)
+	assert.Equal(t, "terminal", cfg.Output.Format)
+	assert.Equal(t, int64(1<<20), cfg.Scan.MaxFileSize)
+}
+
+func TestLoadDiscoveryFromCurrentDir(t *testing.T) {
+	dir := t.TempDir()
+	origDir, err := os.Getwd()
+	require.NoError(t, err)
+	require.NoError(t, os.Chdir(dir))
+	defer os.Chdir(origDir) //nolint:errcheck
+
+	content := `
+[output]
+format = "sarif"
+`
+	require.NoError(t, os.WriteFile(
+		filepath.Join(dir, DefaultConfigFile),
+		[]byte(content), 0o644,
+	))
+
+	cfg, err := Load("")
+	require.NoError(t, err)
+	require.NotNil(t, cfg)
+	assert.Equal(t, "sarif", cfg.Output.Format)
+}
+
+func TestLoadPyprojectFallback(t *testing.T) {
+	dir := t.TempDir()
+	origDir, err := os.Getwd()
+	require.NoError(t, err)
+	require.NoError(t, os.Chdir(dir))
+	defer os.Chdir(origDir) //nolint:errcheck
+
+	content := `
+[project]
+name = "myproject"
+
+[tool.portia.output]
+format = "json"
+verbose = true
+`
+	require.NoError(t, os.WriteFile(
+		filepath.Join(dir, "pyproject.toml"),
+		[]byte(content), 0o644,
+	))
+
+	cfg, err := Load("")
+	require.NoError(t, err)
+	require.NotNil(t, cfg)
+	assert.Equal(t, "json", cfg.Output.Format)
+	assert.True(t, cfg.Output.Verbose)
+}
+
+func TestLoadPyprojectIgnoredWhenEmpty(t *test
```

---

## Code Evolution

### Change Analysis for `config_test.go`

**What Was Changed:**
The commit introduces a new file, `config_test.go`, which contains multiple test functions to validate the configuration loading logic in the `secrets-scanner` project. The tests cover various scenarios such as loading explicit paths, handling non-existent paths, default configurations, fallbacks from `pyproject.toml`, and validating TOML templates.

**Why It Was Likely Changed:**
This change was likely made to ensure comprehensive testing of the configuration loader's behavior under different conditions. By covering edge cases like non-existent files and fallback mechanisms, the tests provide robust validation of the configuration handling logic.

**Impact on Behavior:**
The new tests will help maintain the correctness of the configuration loading process as the project evolves. They ensure that the scanner behaves predictably when encountering unexpected or missing configurations, thereby enhancing reliability.

**Risks or Concerns:**
While these tests are valuable for ensuring robustness, they may introduce some overhead in terms of test execution time and complexity. Additionally, if the default configurations or fallback mechanisms change, existing tests might need updates to reflect new behaviors accurately.

Overall, this addition is a positive step towards improving the project's quality through comprehensive testing.

---

*Generated by CodeWorm on 2026-02-22 20:35*
