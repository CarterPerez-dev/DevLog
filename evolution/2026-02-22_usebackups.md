# useBackups

**Type:** Code Evolution
**Repository:** oneIsNun_
**File:** react-scss/src/api/hooks/useBackups.ts
**Language:** typescript
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```typescript
Commit: fc968a71
Message: feat: transform to MongoDB management dashboard

Major refactor from auth template to MongoDB dashboard:

Backend:
- Fix WebSocket context issue (use context.Background instead of r.Context)
- Add Dockerfile.dev with Air hot reload and mongodb-database-tools
- Update go.mod to Go 1.25
- Add Makefile for mongo and app management
- Add dev.compose.yml for Docker development environment
- Configure mongo-rs.yml for 3-node replica set

Frontend:
- Add HydrateFallback to silence React Router warning
- Update CSP to allow localhost:8080 and ws connections
- Replace auth pages with dashboard, collections, backups, slow-queries
- Add WebSocket hook for real-time metrics
- Add metrics, backups, collections API hooks and types
- Update shell with connection status indicator
- Remove auth-related code (login, register, protected routes)

Removed legacy GO/*.md architecture docs (moved to CLAUDE.md)
Author: CarterPerez-dev
File: react-scss/src/api/hooks/useBackups.ts
Change type: new file

Diff:
@@ -0,0 +1,79 @@
+// ===================
+// AngelaMos | 2026
+// useBackups.ts
+// ===================
+
+import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query'
+import { apiClient } from '@/core/api'
+import { API_ENDPOINTS, QUERY_CONFIG, QUERY_KEYS } from '@/config'
+import {
+  parseApiResponse,
+  BackupListResponseSchema,
+  BackupSchema,
+  type Backup,
+  type BackupListResponse,
+  type CreateBackupRequest,
+} from '../types'
+
+export function useBackups() {
+  return useQuery({
+    queryKey: QUERY_KEYS.BACKUPS.LIST(),
+    queryFn: async (): Promise<BackupListResponse> => {
+      const { data } = await apiClient.get(API_ENDPOINTS.BACKUPS.LIST)
+      return parseApiResponse(BackupListResponseSchema, data)
+    },
+    staleTime: QUERY_CONFIG.STALE_TIME.BACKUPS,
+  })
+}
+
+export function useBackup(id: string) {
+  return useQuery({
+    queryKey: QUERY_KEYS.BACKUPS.BY_ID(id),
+    queryFn: async (): Promise<Backup> => {
+      const { data } = await apiClient.get(API_ENDPOINTS.BACKUPS.BY_ID(id))
+      return parseApiResponse(BackupSchema, data)
+    },
+    enabled: !!id,
+  })
+}
+
+export function useCreateBackup() {
+  const queryClient = useQueryClient()
+
+  return useMutation({
+    mutationFn: async (request: CreateBackupRequest) => {
+      const { data } = await apiClient.post(API_ENDPOINTS.BACKUPS.CREATE, request)
+      return data
+    },
+    onSuccess: () => {
+      queryClient.invalidateQueries({ queryKey: QUERY_KEYS.BACKUPS.ALL })
+    },
+  })
+}
+
+export function useRestoreBackup() {
+  const queryClient = useQueryClient()
+
+  return useMutation({
+    mutationFn: async (id: string) => {
+      const { data } = await apiClient.post(API_ENDPOINTS.BACKUPS.RESTORE(id))
+      return data
+    },
+    onSuccess: () => {
+      queryClient.invalidateQueries({ queryKey: QUERY_KEYS.BACKUPS.ALL })
+    },
+  })
+}
+
+export function useDeleteBackup() {
+  const queryClient = useQueryClient()
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `useBackups.ts` was added to the project, introducing React Query hooks for managing backups in a MongoDB dashboard. The hooks include:
- `useBackups`: Fetches a list of all backups.
- `useBackup(id)`: Fetches details of a specific backup by ID.
- `useCreateBackup`: Creates a new backup.
- `useRestoreBackup`: Restores a backup.
- `useDeleteBackup`: Deletes a backup.

**Why it was Likely Changed:**
This change likely addresses the need for a comprehensive MongoDB management dashboard, providing essential CRUD operations for backups. The use of React Query ensures efficient and consistent data fetching and mutation handling, improving the user experience by reducing re-renders and optimizing network requests.

**Impact on Behavior:**
The addition of these hooks will enable real-time updates and interactions with backup data in the frontend. Users can now create, restore, and delete backups directly from the dashboard, enhancing functionality and usability.

**Risks or Concerns:**
- **API Errors:** The hooks rely on successful API responses; any issues with backend services could lead to errors.
- **Data Consistency:** Ensuring that the `queryClient.invalidateQueries` calls are correctly implemented is crucial to maintain data consistency across the application.
- **Security:** Proper validation and sanitization of input parameters (e.g., `id`) should be enforced to prevent security vulnerabilities.

---

*Generated by CodeWorm on 2026-02-22 18:53*
