# finding

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/finding/finding.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/finding/finding.go
Change type: new file

Diff:
@@ -0,0 +1,271 @@
+/*
+AngelaMos | 2025
+finding.go
+*/
+
+package finding
+
+import (
+	"crypto/sha256"
+	"encoding/hex"
+	"fmt"
+	"strings"
+	"time"
+)
+
+const (
+	containerIDShortLength = 12
+	imageIDShortLength     = 12
+)
+
+type Severity int
+
+const (
+	SeverityInfo Severity = iota
+	SeverityLow
+	SeverityMedium
+	SeverityHigh
+	SeverityCritical
+)
+
+var severityToString = map[Severity]string{
+	SeverityInfo:     "INFO",
+	SeverityLow:      "LOW",
+	SeverityMedium:   "MEDIUM",
+	SeverityHigh:     "HIGH",
+	SeverityCritical: "CRITICAL",
+}
+
+var stringToSeverity = func() map[string]Severity {
+	m := make(map[string]Severity, len(severityToString))
+	for sev, str := range severityToString {
+		m[str] = sev
+	}
+	return m
+}()
+
+var severityColors = map[Severity]string{
+	SeverityInfo:     "\033[36m",
+	SeverityLow:      "\033[34m",
+	SeverityMedium:   "\033[33m",
+	SeverityHigh:     "\033[31m",
+	SeverityCritical: "\033[35m",
+}
+
+func (s Severity) String() string {
+	if str, ok := severityToString[s]; ok {
+		return str
+	}
+	return "UNKNOWN"
+}
+
+func (s Severity) Color() string {
+	if color, ok := severityColors[s]; ok {
+		return color
+	}
+	return "\033[0m"
+}
+
+func ParseSeverity(s string) (Severity, bool) {
+	sev, ok := stringToSeverity[strings.ToUpper(strings.TrimSpace(s))]
+	return sev, ok
+}
+
+type TargetType string
+
+const (
+	TargetContainer  TargetType = "container"
+	TargetImage      TargetType = "image"
+	TargetDockerfile TargetType = "dockerfile"
+	TargetCompose    TargetType = "compose"
+	TargetDaemon     TargetType = "daemon"
+)
+
+type Target struct {
+	Type TargetType
+	Name string
+	ID   string
+}
+
+func (t Target) String() string {
+	if t.ID != "" && len(t.ID) >= containerIDShortLength {
+		return fmt.Sprintf(
+			"%s:%s (%s)",
+			t.Type,
+			t.Name,
+			t.ID[:containerIDShortLength],
+		)
+	}
+	if t.ID != "" {
+		return fmt.Sprintf("%s:%s (%s)", t.Type, t.Name, t.ID)
+	}
+	return fmt.Sprintf("%s:%s", t.Type, t.Name)
+}
+
+type Location struct {
+	Path   string
+	Line   int
+	Column int
+}
+
+func (l Location) String() string {
+	if l.Line > 0 {
+		return fmt.Sprintf("%s:%d", l.Path, l.Line)
+	}
+	return l.Path
+}
+
+type CISControl struct {
+	ID          string
+	Section     string
+	Title       string
+	Description string
+	Scored      bool
+	Level       int
+}
+
+func (c CISControl) String() string {
+	return fmt.Sprintf("CIS %s", c.ID)
+}
+
+type Finding struct {
+	ID          string
+	RuleID      string
+	Title       string
+	Description string
+	Severity    Severity
+	Category    string
+	Target      Target
+	Location    *Location
+	Remediation string
+	References  []string
+	CISControl  *CISControl
+	Timestamp   time.Time
+}
+
+func New(
+	ruleID string,
+	title string,
+	severity Severity,
+	target Target,
+) *Finding {
+	f := &Finding{
+		RuleID:    ruleID,
+		Title:     ti
```

---

## Code Evolution

### Change Analysis for `finding.go`

**What was Changed:**
The file `finding.go` introduces a new package named `finding`, which includes various types and functions to manage security findings in Docker environments. It defines structures like `Severity`, `Target`, `Location`, `CISControl`, and `Finding`. Additionally, it provides methods for filtering and aggregating findings based on severity, category, target type, and more.

**Why it was Likely Changed:**
This change likely aims to standardize the handling of security findings in Docker-related projects. By defining a clear structure for `Finding` objects and providing utility functions, the code can be reused across different parts of the application, ensuring consistency and ease of maintenance.

**Impact on Behavior:**
The introduction of these types and methods allows for better organization and filtering of security findings. Developers can now easily create, modify, and filter findings based on severity, category, target type, etc., which is crucial for security audits and compliance checks.

**Risks or Concerns:**
- **Error Handling:** The code does not include explicit error handling, which could be a risk if the input data is invalid.
- **Performance:** The `generateID` function may be called frequently, especially with complex `Location` objects. Optimizing this function for performance might be necessary.
- **Code Duplication:** While the methods like `WithDescription`, `WithCategory`, etc., are useful, they could potentially lead to code duplication if not used consistently.

Overall, this change significantly enhances the manageability and reusability of security findings in Docker projects.

---

*Generated by CodeWorm on 2026-02-23 15:43*
