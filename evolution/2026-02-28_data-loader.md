# data_loader

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/ml/data_loader.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: f9b5a614
Message: feat: did a couple things idk
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/ml/data_loader.py
Change type: modified

Diff:
@@ -13,6 +13,7 @@ import numpy as np
 
 from app.core.features.encoder import encode_for_inference
 from app.core.features.extractor import extract_request_features
+from app.core.features.mappings import WINDOWED_FEATURE_NAMES
 from app.core.ingestion.parsers import ParsedLogEntry
 
 logger = logging.getLogger(__name__)
@@ -26,21 +27,6 @@ _DEFAULT_IP = "192.168.1.100"
 _DEFAULT_UA = ("Mozilla/5.0 (compatible; Konqueror/3.5; Linux)"
                " KHTML/3.5.8 (like Gecko)")
 
-_WINDOWED_FEATURE_NAMES: list[str] = [
-    "req_count_1m",
-    "req_count_5m",
-    "req_count_10m",
-    "error_rate_5m",
-    "unique_paths_5m",
-    "unique_uas_10m",
-    "method_entropy_5m",
-    "avg_response_size_5m",
-    "status_diversity_5m",
-    "path_depth_variance_5m",
-    "inter_request_time_mean",
-    "inter_request_time_std",
-]
-
 
 @dataclass
 class CSICRequest:
@@ -192,7 +178,7 @@ def load_csic_dataset(
         entry = csic_to_parsed_entry(req)
         features = extract_request_features(entry)
 
-        for name in _WINDOWED_FEATURE_NAMES:
+        for name in WINDOWED_FEATURE_NAMES:
             features[name] = 0.0
 
         vector = encode_for_inference(features)
@@ -211,3 +197,32 @@ def load_csic_dataset(
     )
 
     return X, y
+
+
+def load_csic_normal(
+    path: Path,
+) -> tuple[np.ndarray, np.ndarray]:
+    """
+    Load a CSIC 2010 normal traffic file and return (X, y) arrays
+    with all labels set to 0
+    """
+    reqs = parse_csic_file(path, label=0)
+
+    vectors: list[list[float]] = []
+    for req in reqs:
+        entry = csic_to_parsed_entry(req)
+        features = extract_request_features(entry)
+        for name in WINDOWED_FEATURE_NAMES:
+            features[name] = 0.0
+        vectors.append(encode_for_inference(features))
+
+    X = np.array(vectors, dtype=np.float32)
+    y = np.zeros(len(vectors), dtype=np.int32)
+
+    logger.info(
+        "Loaded %d normal samples from %s",
+        len(vectors),
+        path.name,
+    )
+
+    return X, y

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The code introduced a new function `load_csic_normal` and modified the existing `load_csic_dataset` function in `data_loader.py`. The `_WINDOWED_FEATURE_NAMES` list, previously defined inline, is now imported from another module. Additionally, the feature names are accessed using `WINDOWED_FEATURE_NAMES` instead of `_WINDOWED_FEATURE_NAMES`.

**Why it was Likely Changed:**
This change likely aims to improve code organization and maintainability by centralizing feature names in a single location (`app.core.features.mappings`). This approach reduces redundancy and makes future modifications easier.

**Impact on Behavior:**
- The `load_csic_dataset` function now uses the imported `WINDOWED_FEATURE_NAMES`, which should not affect its behavior since it was already using the same list.
- The new `load_csic_normal` function loads normal traffic data, setting all labels to 0. This is a useful utility for testing or training models with balanced datasets.

**Risks or Concerns:**
- **Deprecation Risk:** The inline definition of `_WINDOWED_FEATURE_NAMES` has been removed, which could lead to confusion if the import path changes.
- **Testing:** Ensure that `load_csic_normal` is thoroughly tested in isolation and integrated properly into existing workflows.
- **Documentation:** Update any relevant documentation to reflect the new function.

Overall, this change enhances code structure while maintaining functionality.

---

*Generated by CodeWorm on 2026-02-28 16:47*
