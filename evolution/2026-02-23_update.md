# update

**Type:** Code Evolution
**Repository:** angela
**File:** internal/cli/update.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: ea4cc501
Message: Create canonical module source location - release v1.0.0
Author: CarterPerez-dev
File: internal/cli/update.go
Change type: new file

Diff:
@@ -0,0 +1,614 @@
+// Â©AngelaMos | 2026
+// update.go
+
+package cli
+
+import (
+	"context"
+	"fmt"
+	"os"
+	"path/filepath"
+	"sort"
+	"strings"
+	"time"
+
+	"github.com/CarterPerez-dev/angela/internal/config"
+	"github.com/CarterPerez-dev/angela/internal/osv"
+	"github.com/CarterPerez-dev/angela/internal/pypi"
+	"github.com/CarterPerez-dev/angela/internal/pyproject"
+	"github.com/CarterPerez-dev/angela/internal/requirements"
+	"github.com/CarterPerez-dev/angela/internal/ui"
+	"github.com/CarterPerez-dev/angela/pkg/types"
+	"github.com/spf13/cobra"
+)
+
+var (
+	verbose     bool
+	minSeverity string
+)
+
+type updateFlags struct {
+	file              string
+	safe              bool
+	vulns             bool
+	includePrerelease bool
+}
+
+func defaultCacheDir() string {
+	home, err := os.UserHomeDir()
+	if err != nil {
+		home = "."
+	}
+	return filepath.Join(home, ".angela", "cache")
+}
+
+// Execute sets up the CLI and runs the root command
+func Execute() {
+	root := &cobra.Command{
+		Use:   "angela",
+		Short: "Python dependency updater and vulnerability scanner",
+		Long: `angela scans your pyproject.toml, updates dependencies to their
+latest stable versions, and checks for known CVEs using OSV.dev.`,
+		SilenceUsage:  true,
+		SilenceErrors: true,
+		PersistentPreRun: func(
+			_ *cobra.Command, _ []string,
+		) {
+			ui.PrintBanner()
+		},
+	}
+
+	defaultHelp := root.HelpFunc()
+	root.SetHelpFunc(
+		func(cmd *cobra.Command, args []string) {
+			if cmd.Root() == cmd {
+				ui.PrintBannerWithArt()
+			} else {
+				ui.PrintBanner()
+			}
+			defaultHelp(cmd, args)
+		},
+	)
+
+	root.PersistentFlags().BoolVarP(
+		&verbose, "verbose", "v", false,
+		"show full vulnerability details",
+	)
+	root.PersistentFlags().StringVar(
+		&minSeverity, "min-severity", "",
+		"minimum severity to report (critical, high, moderate, low)",
+	)
+
+	root.AddCommand(
+		newInitCmd(),
+		newUpdateCmd(),
+		newCheckCmd(),
+		newScanCmd(),
+		newCacheCmd(),
+	)
+
+	if err := root.Execute(); err != nil {
+		PrintError(err.Error())
+		os.Exit(1)
+	}
+}
+
+const pyprojectTemplate = `[project]
+name = "%s"
+version = "0.1.0"
+description = ""
+requires-python = ">=3.13"
+dependencies = []
+
+[tool.angela]
+# Minimum severity to report (critical, high, moderate, low)
+# min-severity = "moderate"
+
+# Dependencies to skip during updates
+# ignore = []
+
+# Vulnerability IDs to suppress (accepted risk)
+# ignore-vulns = []
+`
+
+func newInitCmd() *cobra.Command {
+	return &cobra.Command{
+		Use:   "init",
+		Short: "Create a new pyproject.toml with angela configuration",
+		RunE: func(_ *cobra.Command, _ []string) error {
+			return runInit()
+		},
+	}
+}
+
+func runInit() error {
+	if _, err := os.Stat("pyproject.toml"); err == nil {
+		return fmt.Errorf("pyproject.toml already exists")
+	}
+
+	dir, err :=
```

---

## Code Evolution

### Change Analysis for `internal/cli/update.go`

**What was Changed:**
The commit introduces a new file, `update.go`, which contains the implementation of CLI commands for dependency updates and checks in the Python project management tool, Angela. This includes commands like `init`, `update`, and `check`.

**Why it Was Likely Changed:**
This change likely aims to enhance the functionality of Angela by providing a more comprehensive set of CLI tools for managing dependencies. The introduction of these commands allows users to initialize projects, update dependencies safely or aggressively, and check available updates without modifying files.

**Impact on Behavior:**
The new commands significantly expand Angela's capabilities. Users can now create a project with initial configuration, update dependencies while respecting version constraints, and verify which updates are available without applying them. This improves usability and flexibility for managing Python projects.

**Risks or Concerns:**
- **Error Handling:** The `os.WriteFile` call lacks proper error handling, potentially leading to silent failures.
- **Security:** Hardcoded file permissions (`0o644`) in the `runInit` function could be insecure if not properly managed.
- **Deprecation:** The use of `nolint:gosec` may indicate potential security concerns that should be addressed.

Overall, this change enhances Angela's feature set but requires careful review to ensure robustness and security.

---

*Generated by CodeWorm on 2026-02-23 13:33*
