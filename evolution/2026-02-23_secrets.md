# secrets

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/rules/secrets.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/rules/secrets.go
Change type: new file

Diff:
@@ -0,0 +1,1370 @@
+/*
+AngelaMos | 2025
+secrets.go
+*/
+
+package rules
+
+import (
+	"math"
+	"regexp"
+	"strings"
+)
+
+type SecretType string
+
+const (
+	SecretTypeGeneric          SecretType = "generic"
+	SecretTypeAWSKey           SecretType = "aws_key"
+	SecretTypeAWSSecret        SecretType = "aws_secret"
+	SecretTypeGCPKey           SecretType = "gcp_key"
+	SecretTypeAzureKey         SecretType = "azure_key"
+	SecretTypeGitHub           SecretType = "github_token"
+	SecretTypeGitLab           SecretType = "gitlab_token"
+	SecretTypeSlack            SecretType = "slack_token"
+	SecretTypeStripe           SecretType = "stripe_key"
+	SecretTypeTwilio           SecretType = "twilio_key"
+	SecretTypeSendGrid         SecretType = "sendgrid_key"
+	SecretTypeMailgun          SecretType = "mailgun_key"
+	SecretTypeNPM              SecretType = "npm_token"
+	SecretTypePyPI             SecretType = "pypi_token"
+	SecretTypeDockerHub        SecretType = "dockerhub_token"
+	SecretTypeSSHKey           SecretType = "ssh_key"
+	SecretTypePrivateKey       SecretType = "private_key"
+	SecretTypeJWT              SecretType = "jwt"
+	SecretTypeBasicAuth        SecretType = "basic_auth"
+	SecretTypeBearer           SecretType = "bearer_token"
+	SecretTypeAPIKey           SecretType = "api_key"
+	SecretTypePassword         SecretType = "password"
+	SecretTypeDatabase         SecretType = "database_url"
+	SecretTypeConnectionString SecretType = "connection_string"
+)
+
+type SecretPattern struct {
+	Type        SecretType
+	Pattern     *regexp.Regexp
+	Description string
+}
+
+var SecretPatterns = []SecretPattern{
+	// ==================== AWS ====================
+	{
+		Type: SecretTypeAWSKey,
+		Pattern: regexp.MustCompile(
+			`(?i)(AKIA|ABIA|ACCA|ASIA)[0-9A-Z]{16}`,
+		),
+		Description: "AWS Access Key ID",
+	},
+	{
+		Type: SecretTypeAWSSecret,
+		Pattern: regexp.MustCompile(
+			`(?i)aws_?secret_?access_?key\s*[=:]\s*['"]?([A-Za-z0-9/+=]{40})['"]?`,
+		),
+		Description: "AWS Secret Access Key",
+	},
+	{
+		Type: SecretTypeAWSKey,
+		Pattern: regexp.MustCompile(
+			`(?i)aws_?session_?token\s*[=:]\s*['"]?([A-Za-z0-9/+=]{100,})['"]?`,
+		),
+		Description: "AWS Session Token",
+	},
+
+	// ==================== GCP ====================
+	{
+		Type:        SecretTypeGCPKey,
+		Pattern:     regexp.MustCompile(`(?i)("type"\s*:\s*"service_account")`),
+		Description: "GCP Service Account JSON",
+	},
+	{
+		Type:        SecretTypeGCPKey,
+		Pattern:     regexp.MustCompile(`(?i)AIza[0-9A-Za-z\-_]{35}`),
+		Description: "Google API Key",
+	},
+	{
+		Type: SecretTypeGCPKey,
+		Pattern: regexp.MustCompile(
+			`(?i)[0-9]+-[0-9A-Za-z_]{32}\.apps\.googleusercontent\.com`,
+		),
+		Description: "Google OAuth Client ID",
+	},
+
+	// ==================== Azure ====================
+	{
+		Type: SecretTypeAzureKey,
+		Pattern: regexp.MustCompile
```

---

## Code Evolution

### Change Analysis for `internal/rules/secrets.go`

**What was Changed:**
The file `secrets.go` was added as a new file in the repository, introducing a comprehensive set of constants and regular expressions to identify various types of secrets used by different services (AWS, GCP, Azure, GitHub, GitLab, Slack, etc.). The code defines a `SecretType` enum with 20+ distinct secret types and a `SecretPattern` struct that includes regex patterns for each type along with descriptions.

**Why it was Likely Changed:**
This change likely aims to improve the security posture by enabling more precise detection of sensitive information within the codebase. By defining specific patterns, the system can better identify secrets like API keys, tokens, and other credentials, which are often stored insecurely in source code or environment variables.

**Impact on Behavior:**
The introduction of these regex patterns will allow for enhanced secret detection during security scans or static analysis tools. This can help prevent accidental exposure of sensitive information by flagging potential issues early in the development lifecycle.

**Risks or Concerns:**
While this change improves security, there are a few risks to consider:
- **False Positives:** The regex patterns might incorrectly identify non-secret strings as secrets.
- **Maintenance Overhead:** Regularly updating and maintaining these regex patterns can be time-consuming.
- **Performance Impact:** Regex matching can introduce performance overhead during code analysis.

Overall, this change is a significant step towards better security practices but should be complemented with thorough testing to ensure accuracy.

---

*Generated by CodeWorm on 2026-02-23 16:33*
