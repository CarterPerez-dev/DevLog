# generator

**Type:** Code Evolution
**Repository:** CodeWorm
**File:** codeworm/llm/generator.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: ca3ce30d
Message: v1.0.2: add doc type system, Docker infrastructure, and web dashboard

- Add 11 documentation types (function, class, file, security review, TIL, etc.)
  with weighted random selection so the same codebase generates 10x more unique content
- Add Docker Compose for Ollama (GPU passthrough) + Redis + Dashboard + Nginx
- Add FastAPI backend with REST API, WebSocket live events, and Redis pub/sub
- Add React dashboard with stats, live log, commit feed, repo list, and worm viz
- Add next_scheduled_run logging after each cycle completes
- Update repos config and README for v1.0.2
Author: CarterPerez-dev
File: codeworm/llm/generator.py
Change type: modified

Diff:
@@ -19,14 +19,31 @@ from codeworm.llm.prompts import (
     build_commit_prompt,
     build_documentation_prompt,
 )
+from codeworm.models import DocType
 
 if TYPE_CHECKING:
     from codeworm.analysis import AnalysisCandidate
+    from codeworm.analysis.targets import DocumentationTarget
     from codeworm.core.config import OllamaSettings, PromptSettings
 
 
 logger = get_logger("generator")
 
+DOC_TYPE_LABELS: dict[DocType,
+                      str] = {
+                          DocType.FUNCTION_DOC: "Documentation",
+                          DocType.CLASS_DOC: "Class Documentation",
+                          DocType.FILE_DOC: "File Overview",
+                          DocType.MODULE_DOC: "Module Overview",
+                          DocType.SECURITY_REVIEW: "Security Review",
+                          DocType.PERFORMANCE_ANALYSIS: "Performance Analysis",
+                          DocType.TIL: "Today I Learned",
+                          DocType.CODE_EVOLUTION: "Code Evolution",
+                          DocType.PATTERN_ANALYSIS: "Pattern Analysis",
+                          DocType.WEEKLY_SUMMARY: "Weekly Summary",
+                          DocType.MONTHLY_SUMMARY: "Monthly Summary",
+                      }
+
 
 @dataclass
 class GeneratedDocumentation:
@@ -39,6 +56,7 @@ class GeneratedDocumentation:
     generated_at: datetime
     tokens_used: int
     generation_time_ms: int
+    doc_type: DocType = DocType.FUNCTION_DOC
 
     @property
     def word_count(self) -> int:
@@ -46,29 +64,72 @@ class GeneratedDocumentation:
 
     def to_markdown(self, candidate: AnalysisCandidate) -> str:
         """
-        Format as markdown file content
+        Format as markdown file content for AnalysisCandidate (legacy)
         """
-        header = f"""# {candidate.snippet.display_name}
+        return self._format_markdown(
+            display_name = candidate.snippet.display_name,
+            repo = candidate.snippet.repo,
+            file_path = str(candidate.scanned_file.relative_path),
+            language = candidate.snippet.language.value,
+            start_line = candidate.snippet.start_line,
+            end_line = candidate.snippet.end_line,
+            complexity = candidate.snippet.complexity,
+            source = candidate.snippet.source
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The code added support for multiple documentation types, updated the `GeneratedDocumentation` class to include a `doc_type` field, and introduced new methods to format markdown content based on different target types (`AnalysisCandidate` and `DocumentationTarget`). The `DOC_TYPE_LABELS` dictionary maps these types to human-readable labels.

**Why it was Likely Changed:**
This change likely aims to enhance the flexibility and extensibility of the documentation generation system. By supporting various document types, the system can generate more diverse and tailored content, which is crucial for maintaining a comprehensive codebase documentation.

**Impact on Behavior:**
The new methods `to_markdown_from_target` and `_format_markdown` allow generating markdown content based on different targets (e.g., snippets or full files), providing flexibility in how documentation is produced. The addition of `doc_type` ensures that the generated documentation includes metadata about its type, which can be useful for categorization and filtering.

**Risks or Concerns:**
While this change improves the system's adaptability, it introduces complexity. Ensuring that all types are correctly handled and that the new methods do not conflict with existing logic is crucial. Additionally, testing these new features thoroughly to verify their correctness and performance will be essential.

---

*Generated by CodeWorm on 2026-02-23 21:47*
