# routes

**Type:** Code Evolution
**Repository:** angelamos-operations
**File:** Angela-TTS/server/routes.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 3894239b
Message: angela-3d implementation - in prog open wake
Author: CarterPerez-dev
File: Angela-TTS/server/routes.py
Change type: new file

Diff:
@@ -0,0 +1,52 @@
+"""
+Angela TTS Server - Routes
+"""
+
+import io
+
+import edge_tts
+from fastapi import APIRouter, HTTPException
+from fastapi.responses import Response
+from pydantic import BaseModel
+
+from .config import VOICE
+
+router = APIRouter()
+
+
+class SynthesizeRequest(BaseModel):
+    text: str
+
+
+@router.get("/health")
+async def health():
+    return {"status": "ok", "model": "edge-tts", "voice": VOICE}
+
+
+@router.post("/synthesize")
+async def synthesize(request: SynthesizeRequest):
+    if not request.text.strip():
+        raise HTTPException(status_code = 400, detail = "Empty text")
+
+    communicate = edge_tts.Communicate(request.text, VOICE)
+
+    buffer = io.BytesIO()
+    async for chunk in communicate.stream():
+        if chunk["type"] == "audio":
+            buffer.write(chunk["data"])
+
+    buffer.seek(0)
+    return Response(content = buffer.read(), media_type = "audio/mpeg")
+
+
+@router.get("/voices")
+async def list_voices():
+    voices = await edge_tts.list_voices()
+    return {
+        "voices": [
+            {
+                "voice_id": v["ShortName"],
+                "name": v["FriendlyName"]
+            } for v in voices
+        ]
+    }

```

---

## Code Evolution

### Change Analysis for Commit 3894239b

**What was Changed:**
The commit introduces a new file `routes.py` in the `Angela-TTS/server/` directory, which defines routes for an API server using FastAPI. The file includes three main endpoints:
1. `/health`: Returns status information.
2. `/synthesize`: Synthesizes text to speech using Microsoft Edge TTS.
3. `/voices`: Lists available voices from Edge TTS.

**Why it was Likely Changed:**
This change likely implements a new feature for the Angela Text-to-Speech (TTS) system, providing an API interface for users to interact with the TTS service. The endpoints allow clients to check the server's health, request speech synthesis, and retrieve voice options.

**Impact on Behavior:**
- **Health Check:** Clients can verify that the server is operational.
- **Speech Synthesis:** Users can send text to be converted into audio using a specified voice.
- **Voice Listing:** Provides information about available voices for customization.

**Risks or Concerns:**
- The `/synthesize` endpoint could potentially expose sensitive data if not properly secured, such as voice IDs and text content.
- Error handling is basic; more robust error management should be considered to handle various edge cases.
- The use of `io.BytesIO` might consume significant memory for large audio outputs. Consider implementing streaming responses to avoid this.

Overall, this change enhances the functionality of the Angela TTS system by providing a RESTful API interface, but attention should be paid to security and performance optimizations.

---

*Generated by CodeWorm on 2026-02-22 15:10*
