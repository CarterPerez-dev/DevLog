# config

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/cli/config.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/cli/config.go
Change type: new file

Diff:
@@ -0,0 +1,108 @@
+// Â©AngelaMos | 2026
+// config.go
+
+package cli
+
+import (
+	"fmt"
+	"os"
+
+	"github.com/spf13/cobra"
+
+	"github.com/CarterPerez-dev/portia/internal/rules"
+	"github.com/CarterPerez-dev/portia/internal/ui"
+)
+
+var configCmd = &cobra.Command{
+	Use:   "config",
+	Short: "Show configuration and rule information",
+}
+
+var configRulesCmd = &cobra.Command{
+	Use:   "rules",
+	Short: "List all available detection rules",
+	RunE:  runConfigRules,
+}
+
+var configShowCmd = &cobra.Command{
+	Use:   "show",
+	Short: "Show active configuration",
+	RunE:  runConfigShow,
+}
+
+func init() {
+	configCmd.AddCommand(configRulesCmd)
+	configCmd.AddCommand(configShowCmd)
+}
+
+func runConfigRules(_ *cobra.Command, _ []string) error {
+	reg := rules.NewRegistry()
+	rules.RegisterBuiltins(reg)
+
+	all := reg.All()
+	fmt.Fprintf(os.Stdout, "\n%s %s\n\n", //nolint:errcheck
+		ui.Shield,
+		ui.CyanBold(fmt.Sprintf("%d detection rules", len(all))),
+	)
+
+	for _, r := range all {
+		sevColor := ui.Cyan
+		switch r.Severity.String() {
+		case "CRITICAL":
+			sevColor = ui.RedBold
+		case "HIGH":
+			sevColor = ui.Red
+		case "MEDIUM":
+			sevColor = ui.Yellow
+		}
+
+		fmt.Fprintf(os.Stdout, "  %s %-40s %s  %s\n", //nolint:errcheck
+			ui.Diamond,
+			ui.White(r.ID),
+			sevColor(fmt.Sprintf("%-8s", r.Severity)),
+			r.Description,
+		)
+	}
+
+	fmt.Fprintln(os.Stdout) //nolint:errcheck
+	return nil
+}
+
+func runConfigShow(_ *cobra.Command, _ []string) error {
+	fmt.Fprintf(os.Stdout, "\n%s Active Configuration\n\n", //nolint:errcheck
+		ui.Arrow)
+	fmt.Fprintf( //nolint:errcheck
+		os.Stdout,
+		"  Format:     %s\n",
+		format,
+	)
+	fmt.Fprintf( //nolint:errcheck
+		os.Stdout,
+		"  Verbose:    %t\n",
+		verbose,
+	)
+	fmt.Fprintf( //nolint:errcheck
+		os.Stdout,
+		"  No Color:   %t\n",
+		noColor,
+	)
+	fmt.Fprintf( //nolint:errcheck
+		os.Stdout,
+		"  HIBP:       %t\n",
+		enableHIBP,
+	)
+	fmt.Fprintf( //nolint:errcheck
+		os.Stdout,
+		"  Max Size:   %d bytes\n",
+		maxSize,
+	)
+	if len(excludes) > 0 {
+		fmt.Fprintf(os.Stdout, "  Excludes:   %v\n", excludes) //nolint:errcheck
+	}
+	if cfg != nil && len(cfg.Rules.Disable) > 0 {
+		fmt.Fprintf(os.Stdout, "  Disabled:   %v\n", //nolint:errcheck
+			cfg.Rules.Disable)
+	}
+	fmt.Fprintln(os.Stdout) //nolint:errcheck
+	return nil
+}

```

---

## Code Evolution

### Change Analysis

**What was Changed**: 
A new file `config.go` was added to the `internal/cli` package, introducing two subcommands (`rules` and `show`) under a main command named `config`. These commands are responsible for displaying configuration details and available detection rules.

**Why it Was Likely Changed**: 
The addition of these commands likely aims to enhance user interaction with the secrets scanner by providing visibility into its current setup. This feature is crucial for debugging, troubleshooting, and ensuring that users can understand how their configurations affect the tool's behavior.

**Impact on Behavior**: 
- The `rules` subcommand lists all available detection rules along with their severity levels and descriptions.
- The `show` subcommand displays the active configuration settings, including format, verbosity, color usage, HIBP integration status, maximum size limit, exclusions, and disabled rules.

**Risks or Concerns**: 
While this change improves usability, it introduces potential risks if not handled properly:
- **Error Handling**: The use of `//nolint:errcheck` comments suggests that error handling might be overlooked. Ensuring proper error checking is crucial to maintain robustness.
- **Resource Usage**: Listing all rules can consume significant resources depending on the number of rules, which could impact performance.

Overall, this change enhances the tool's functionality and user experience without introducing major risks if implemented carefully.

---

*Generated by CodeWorm on 2026-02-22 20:04*
