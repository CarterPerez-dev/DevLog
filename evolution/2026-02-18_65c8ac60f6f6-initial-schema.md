# 65c8ac60f6f6_initial_schema

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/alembic/versions/65c8ac60f6f6_initial_schema.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 3fd9f773
Message: checkpoint - phase 13 complete
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/alembic/versions/65c8ac60f6f6_initial_schema.py
Change type: new file

Diff:
@@ -0,0 +1,143 @@
+"""
+Â©AngelaMos | 2026
+initial schema
+
+Revision ID: 65c8ac60f6f6
+Revises:
+Create Date: 2026-02-11 17:43:24.263837
+"""
+
+from typing import Sequence, Union
+
+from alembic import op
+import sqlalchemy as sa
+import sqlmodel
+
+revision: str = "65c8ac60f6f6"
+down_revision: Union[str, None] = None
+branch_labels: Union[str, Sequence[str], None] = None
+depends_on: Union[str, Sequence[str], None] = None
+
+
+def upgrade() -> None:
+    op.create_table(
+        "threat_events",
+        sa.Column("id", sa.Uuid(), nullable=False),
+        sa.Column(
+            "created_at",
+            sa.DateTime(timezone=True),
+            server_default=sa.text("CURRENT_TIMESTAMP"),
+            nullable=False,
+        ),
+        sa.Column(
+            "source_ip", sqlmodel.sql.sqltypes.AutoString(length=45), nullable=False
+        ),
+        sa.Column(
+            "request_method",
+            sqlmodel.sql.sqltypes.AutoString(length=10),
+            nullable=False,
+        ),
+        sa.Column(
+            "request_path", sqlmodel.sql.sqltypes.AutoString(), nullable=False
+        ),
+        sa.Column("status_code", sa.SmallInteger(), nullable=False),
+        sa.Column("response_size", sa.Integer(), nullable=False),
+        sa.Column(
+            "user_agent", sqlmodel.sql.sqltypes.AutoString(), nullable=False
+        ),
+        sa.Column("threat_score", sa.Float(), nullable=False),
+        sa.Column(
+            "severity", sqlmodel.sql.sqltypes.AutoString(length=6), nullable=False
+        ),
+        sa.Column("component_scores", sa.JSON(), nullable=False),
+        sa.Column(
+            "geo_country",
+            sqlmodel.sql.sqltypes.AutoString(length=2),
+            nullable=True,
+        ),
+        sa.Column(
+            "geo_city",
+            sqlmodel.sql.sqltypes.AutoString(length=255),
+            nullable=True,
+        ),
+        sa.Column("geo_lat", sa.Float(), nullable=True),
+        sa.Column("geo_lon", sa.Float(), nullable=True),
+        sa.Column("feature_vector", sa.JSON(), nullable=False),
+        sa.Column("matched_rules", sa.JSON(), nullable=True),
+        sa.Column(
+            "model_version",
+            sqlmodel.sql.sqltypes.AutoString(length=64),
+            nullable=True,
+        ),
+        sa.Column("reviewed", sa.Boolean(), nullable=False),
+        sa.Column(
+            "review_label",
+            sqlmodel.sql.sqltypes.AutoString(length=20),
+            nullable=True,
+        ),
+        sa.PrimaryKeyConstraint("id"),
+    )
+
+    op.create_index("idx_threat_events_created_at", "threat_events", ["created_at"])
+    op.create_index("idx_threat_events_source_ip", "threat_events", ["source_ip"])
+    op.create_index("idx_threat_events_severity", "threat_ev
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The commit introduces two new database tables, `threat_events` and `model_metadata`, along with their respective indexes in the schema file `65c8ac60f6f6_initial_schema.py`. The `threat_events` table captures detailed information about potential security threats, including metadata like source IP, request details, threat score, and geo-location data. The `model_metadata` table stores metadata related to machine learning models used for threat detection.

**Why it was Likely Changed:**
This change likely aims to enhance the backend system's ability to track and analyze security events more comprehensively. By creating detailed tables with specific fields, the developers can better manage and query threat data, improving overall threat detection capabilities.

**Impact on Behavior:**
The addition of these tables will enable the application to log and store a wide range of threat-related information, which is crucial for monitoring and responding to potential security incidents. The indexes created improve query performance, making it easier to filter and analyze specific types of events or model metadata.

**Risks or Concerns:**
- **Data Volume:** Storing detailed event data could lead to increased database storage requirements.
- **Performance:** While indexing improves querying, frequent updates might impact write performance.
- **Maintenance:** Regularly maintaining these tables and indexes will be necessary to ensure optimal performance.

---

*Generated by CodeWorm on 2026-02-18 09:46*
