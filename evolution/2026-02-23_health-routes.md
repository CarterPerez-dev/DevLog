# health_routes

**Type:** Code Evolution
**Repository:** social-media-notes
**File:** backend/app/core/health_routes.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 8c757802
Message: easy peasy
Author: CarterPerez-dev
File: backend/app/core/health_routes.py
Change type: new file

Diff:
@@ -0,0 +1,79 @@
+"""
+ⒸAngelaMos | 2025
+health_routes.py
+"""
+
+from fastapi import (
+    APIRouter,
+    status,
+)
+import redis.asyncio as redis
+from sqlalchemy import text
+
+from config import (
+    settings,
+    HealthStatus,
+)
+from .common_schemas import (
+    HealthResponse,
+    HealthDetailedResponse,
+)
+from .database import sessionmanager
+
+
+router = APIRouter(tags = ["health"])
+
+
+@router.get(
+    "/health",
+    response_model = HealthResponse,
+    status_code = status.HTTP_200_OK,
+)
+async def health_check() -> HealthResponse:
+    """
+    Basic health check
+    """
+    return HealthResponse(
+        status = HealthStatus.HEALTHY,
+        environment = settings.ENVIRONMENT.value,
+        version = settings.APP_VERSION,
+    )
+
+
+@router.get(
+    "/health/detailed",
+    response_model = HealthDetailedResponse,
+    status_code = status.HTTP_200_OK,
+)
+async def health_check_detailed() -> HealthDetailedResponse:
+    """
+    Detailed health check including database connectivity
+    """
+    db_status = HealthStatus.UNHEALTHY
+    redis_status = None
+
+    try:
+        async with sessionmanager.connect() as conn:
+            await conn.execute(text("SELECT 1"))
+            db_status = HealthStatus.HEALTHY
+    except Exception:
+        db_status = HealthStatus.UNHEALTHY
+
+    if settings.REDIS_URL:
+        try:
+            r = redis.from_url(str(settings.REDIS_URL))
+            await r.ping()
+            redis_status = HealthStatus.HEALTHY
+            await r.close()
+        except Exception:
+            redis_status = HealthStatus.UNHEALTHY
+
+    overall = HealthStatus.HEALTHY if db_status == HealthStatus.HEALTHY else HealthStatus.DEGRADED
+
+    return HealthDetailedResponse(
+        status = overall,
+        environment = settings.ENVIRONMENT.value,
+        version = settings.APP_VERSION,
+        database = db_status,
+        redis = redis_status,
+    )

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The commit added a new file `health_routes.py` to the project, introducing two health check endpoints using FastAPI. The basic health check returns a simple status, while the detailed health check includes database and Redis connectivity checks.

**Why it Was Likely Changed:**
This change likely aims to implement monitoring for the application's health, ensuring that both the backend services (database) and external dependencies (Redis) are functioning correctly. This is crucial for maintaining system reliability and diagnosing issues early.

**Impact on Behavior:**
The new endpoints `/health` and `/health/detailed` allow users to check the overall status of the application. The basic endpoint provides a quick overview, while the detailed one offers deeper insights into specific components' health. This can help in troubleshooting and ensuring that all services are operational.

**Risks or Concerns:**
- **Database Connection Issues:** The database connection attempt is done within an async context manager, which could potentially block other operations if not managed properly.
- **Resource Leaks:** Ensure that the Redis client is always closed after use to avoid resource leaks.
- **Exception Handling:** While exceptions are caught and handled, it's important to log these errors for better debugging.

This change enhances the application’s monitoring capabilities without significantly impacting existing functionality.

---

*Generated by CodeWorm on 2026-02-23 17:52*
