# capabilities

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/rules/capabilities.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/rules/capabilities.go
Change type: new file

Diff:
@@ -0,0 +1,322 @@
+/*
+AngelaMos | 2025
+capabilities.go
+*/
+
+package rules
+
+import (
+	"strings"
+
+	"github.com/CarterPerez-dev/docksec/internal/finding"
+)
+
+type CapabilityInfo struct {
+	Severity    finding.Severity
+	Description string
+}
+
+// Capabilities maps all Linux capabilities to their security implications
+// Organized by capability number (0-40) from include/uapi/linux/capability.h
+var Capabilities = map[string]CapabilityInfo{
+	// CAP 0 - File Ownership
+	"CAP_CHOWN": {
+		Severity:    finding.SeverityMedium,
+		Description: "Change file ownership. Can take ownership of any file, bypassing normal permission checks.",
+	},
+
+	// CAP 1 - DAC Override
+	"CAP_DAC_OVERRIDE": {
+		Severity:    finding.SeverityHigh,
+		Description: "Bypass file read, write, and execute permission checks. Complete filesystem access.",
+	},
+
+	// CAP 2 - DAC Read Search
+	"CAP_DAC_READ_SEARCH": {
+		Severity:    finding.SeverityHigh,
+		Description: "Bypass file read permission checks and directory read/execute checks. Read any file.",
+	},
+
+	// CAP 3 - File Owner Override
+	"CAP_FOWNER": {
+		Severity:    finding.SeverityHigh,
+		Description: "Bypass permission checks on operations requiring file owner UID match. Modify any file metadata.",
+	},
+
+	// CAP 4 - File Set-ID
+	"CAP_FSETID": {
+		Severity:    finding.SeverityMedium,
+		Description: "Don't clear set-user-ID and set-group-ID bits when a file is modified. Preserve SUID/SGID.",
+	},
+
+	// CAP 5 - Kill Processes
+	"CAP_KILL": {
+		Severity:    finding.SeverityMedium,
+		Description: "Send signals to arbitrary processes. Bypass permission checks for kill().",
+	},
+
+	// CAP 6 - Set GID
+	"CAP_SETGID": {
+		Severity:    finding.SeverityHigh,
+		Description: "Make arbitrary manipulations of process GIDs. Privilege escalation risk via group changes.",
+	},
+
+	// CAP 7 - Set UID
+	"CAP_SETUID": {
+		Severity:    finding.SeverityHigh,
+		Description: "Make arbitrary manipulations of process UIDs. Direct privilege escalation to root.",
+	},
+
+	// CAP 8 - Set Process Capabilities
+	"CAP_SETPCAP": {
+		Severity:    finding.SeverityHigh,
+		Description: "Modify process capabilities. Can grant new capabilities to self or child processes.",
+	},
+
+	// CAP 9 - Linux Immutable
+	"CAP_LINUX_IMMUTABLE": {
+		Severity:    finding.SeverityMedium,
+		Description: "Set the immutable and append-only file attributes. Can prevent file modification/deletion.",
+	},
+
+	// CAP 10 - Bind Privileged Ports
+	"CAP_NET_BIND_SERVICE": {
+		Severity:    finding.SeverityLow,
+		Description: "Bind to privileged ports (below 1024). Required for most server applications.",
+	},
+
+	// CAP 11 - Network Broadcast
+	"CAP_NET_BROADCAST": {
+		Severity:    finding.SeverityLow,
+		Description: "Send broadcast packets and listen to multicast. Can flood network segments.",
+	},
+
+	// CAP 12 - 
```

---

## Code Evolution

### Change Analysis for `capabilities.go`

**What was Changed:**
The file `internal/rules/capabilities.go` was added, introducing a new Go struct `CapabilityInfo` and a map `Capabilities`. The map contains 21 entries, each mapping a Linux capability name to an instance of `CapabilityInfo`, which includes severity and description fields.

**Why it was Likely Changed:**
This change likely aims to provide a comprehensive list of Linux capabilities with their associated security implications. This is crucial for docksec's security analysis tools, enabling detailed assessments of potential vulnerabilities related to these capabilities.

**Impact on Behavior:**
The introduction of this file enhances the security analysis by providing structured information about each capability. It allows the system to categorize findings based on severity and offer clear descriptions of the risks associated with each capability.

**Risks or Concerns:**
While the addition of detailed capability information is beneficial, there are a few potential concerns:
- **Maintenance:** The map needs regular updates as new capabilities may be introduced in future Linux versions.
- **Error Handling:** Ensure that the code handles cases where a capability name might not exist in the `Capabilities` map.
- **Security Implications:** The descriptions should be accurate and up-to-date to avoid misinterpretation of risks.

Overall, this change significantly improves the security analysis capabilities by providing clear, structured information on Linux capabilities.

---

*Generated by CodeWorm on 2026-02-23 16:25*
