# orchestrator

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/advanced/ai-threat-detection/backend/ml/orchestrator.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: f9b5a614
Message: feat: did a couple things idk
Author: CarterPerez-dev
File: PROJECTS/advanced/ai-threat-detection/backend/ml/orchestrator.py
Change type: modified

Diff:
@@ -5,8 +5,10 @@ orchestrator.py
 
 import json
 import logging
+import sys
 from dataclasses import dataclass
 from pathlib import Path
+from typing import Any
 
 import numpy as np
 
@@ -133,13 +135,24 @@ class TrainingOrchestrator:
                     "ensemble_roc_auc": ensemble.roc_auc,
                 })
                 passed = ensemble.passed_gates
-            except Exception:
+            except Exception as exc:
                 logger.exception("Ensemble validation failed")
+                print(
+                    f"  WARNING: validation raised"
+                    f" {type(exc).__name__}: {exc}",
+                    file=sys.stderr,
+                )
                 ensemble = None
                 passed = False
 
-            for artifact in self._output_dir.iterdir():
-                experiment.log_artifact(artifact)
+            for name in (
+                AE_FILENAME,
+                RF_FILENAME,
+                IF_FILENAME,
+                SCALER_FILENAME,
+                THRESHOLD_FILENAME,
+            ):
+                experiment.log_artifact(self._output_dir / name)
 
             run_id = experiment.run_id
 
@@ -159,7 +172,7 @@ class TrainingOrchestrator:
             mlflow_run_id=run_id,
         )
 
-    def _train_ae(self, X_normal: np.ndarray) -> dict:
+    def _train_ae(self, X_normal: np.ndarray) -> dict[str, Any]:
         """
         Train the autoencoder on normal-only data
         """
@@ -174,7 +187,7 @@ class TrainingOrchestrator:
             batch_size=self._batch_size,
         )
 
-    def _train_rf(self, X: np.ndarray, y: np.ndarray) -> dict:
+    def _train_rf(self, X: np.ndarray, y: np.ndarray) -> dict[str, Any]:
         """
         Train the random forest classifier
         """
@@ -184,7 +197,7 @@ class TrainingOrchestrator:
         )
         return train_random_forest(X, y)
 
-    def _train_if(self, X_normal: np.ndarray) -> dict:
+    def _train_if(self, X_normal: np.ndarray) -> dict[str, Any]:
         """
         Train the isolation forest on normal-only data
         """
@@ -196,9 +209,9 @@ class TrainingOrchestrator:
 
     def _export_models(
         self,
-        ae_result: dict,
-        rf_result: dict,
-        if_result: dict,
+        ae_result: dict[str, Any],
+        rf_result: dict[str, Any],
+        if_result: dict[str, Any],
     ) -> None:
         """
         Export all 3 models to ONNX and save scaler/threshold

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
- Added `sys` import and used it to print a warning message.
- Modified the exception handling block in `_validate_ensemble` method, adding logging and printing of the exception details.
- Updated return types of `_train_ae`, `_train_rf`, and `_train_if` methods to use `dict[str, Any]`.
- Changed artifact logging from iterating over all files in `_output_dir` to using specific filenames.

**Why it was Likely Changed:**
The changes likely aim to improve error handling and logging. Adding the `sys` import for printing a warning message provides more detailed feedback when validation fails. The updated return types with type hints make the code clearer, especially if these functions are used in other parts of the project. Logging specific filenames instead of all files ensures only relevant artifacts are logged.

**Impact on Behavior:**
- The behavior now includes logging and printing exceptions during ensemble validation.
- Artifacts will be logged for specific filenames rather than all files in `_output_dir`.

**Risks or Concerns:**
- The addition of `sys.stderr` print might clutter the standard error stream, potentially making it harder to distinguish between actual errors and warnings. Ensure this does not interfere with other logging mechanisms.
- Type hints should be consistently applied across the project for better maintainability.

Overall, these changes enhance the robustness and clarity of the code while maintaining its functionality.

---

*Generated by CodeWorm on 2026-03-01 00:55*
