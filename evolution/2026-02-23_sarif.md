# sarif

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/report/sarif.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/report/sarif.go
Change type: new file

Diff:
@@ -0,0 +1,317 @@
+/*
+AngelaMos | 2025
+sarif.go
+*/
+
+package report
+
+import (
+	"crypto/sha256"
+	"encoding/hex"
+	"encoding/json"
+	"fmt"
+	"io"
+	"time"
+
+	"github.com/CarterPerez-dev/docksec/internal/config"
+	"github.com/CarterPerez-dev/docksec/internal/finding"
+)
+
+type SARIFReporter struct {
+	w      io.Writer
+	closer func() error
+}
+
+type sarifReport struct {
+	Schema  string     `json:"$schema"`
+	Version string     `json:"version"`
+	Runs    []sarifRun `json:"runs"`
+}
+
+type sarifRun struct {
+	Tool        sarifTool         `json:"tool"`
+	Results     []sarifResult     `json:"results"`
+	Invocations []sarifInvocation `json:"invocations,omitempty"`
+}
+
+type sarifTool struct {
+	Driver sarifDriver `json:"driver"`
+}
+
+type sarifDriver struct {
+	Name           string      `json:"name"`
+	Version        string      `json:"version"`
+	InformationURI string      `json:"informationUri"`
+	Rules          []sarifRule `json:"rules"`
+}
+
+type sarifRule struct {
+	ID               string              `json:"id"`
+	Name             string              `json:"name"`
+	ShortDescription sarifMessage        `json:"shortDescription"`
+	FullDescription  sarifMessage        `json:"fullDescription,omitempty"`
+	Help             sarifMessage        `json:"help,omitempty"`
+	HelpURI          string              `json:"helpUri,omitempty"`
+	DefaultConfig    sarifDefaultConfig  `json:"defaultConfiguration"`
+	Properties       sarifRuleProperties `json:"properties,omitempty"`
+}
+
+type sarifDefaultConfig struct {
+	Level string `json:"level"`
+}
+
+type sarifRuleProperties struct {
+	Tags             []string `json:"tags,omitempty"`
+	SecuritySeverity string   `json:"security-severity,omitempty"`
+}
+
+type sarifMessage struct {
+	Text string `json:"text"`
+}
+
+type sarifResult struct {
+	RuleID              string                `json:"ruleId"`
+	RuleIndex           int                   `json:"ruleIndex"`
+	Level               string                `json:"level"`
+	Message             sarifMessage          `json:"message"`
+	Locations           []sarifLocation       `json:"locations,omitempty"`
+	PartialFingerprints map[string]string     `json:"partialFingerprints,omitempty"`
+	Properties          sarifResultProperties `json:"properties,omitempty"`
+}
+
+type sarifResultProperties struct {
+	SecuritySeverity string `json:"security-severity,omitempty"`
+}
+
+type sarifLocation struct {
+	PhysicalLocation sarifPhysicalLocation `json:"physicalLocation"`
+}
+
+type sarifPhysicalLocation struct {
+	ArtifactLocation sarifArtifactLocation `json:"artifactLocation"`
+	Region           *sarifRegion          `json:"region,omitempty"`
+}
+
+type sarifArtifactLocation struct {
+	URI string `json:"uri"`
+}
+
+type sarifRegion struct {
+	StartLine   int `json:"startLine,omitempty"`
+	StartColumn int `json:"startColumn,omitempty"`

```

---

## Code Evolution

### Change Analysis for `sarif.go`

**What was Changed:**
A new file, `sarif.go`, was added to the repository. This file introduces a SARIF (Static Analysis Results Interchange Format) reporter for generating security findings reports in JSON format. The code defines structures and methods necessary for creating SARIF-compliant reports.

**Why it Was Likely Changed:**
This change likely aims to integrate docksec with static analysis tools that support SARIF, enabling better integration and sharing of security findings across different CI/CD pipelines or security tools.

**Impact on Behavior:**
The addition of a SARIF reporter allows docksec to output its findings in a standardized format. This can improve the interoperability of security reports generated by docksec with other tools and platforms that consume SARIF files. The `Report` method encodes findings into JSON, adhering to the SARIF schema.

**Risks or Concerns:**
- **Complexity**: Implementing SARIF requires handling a complex schema, which could introduce bugs if not carefully managed.
- **Performance**: Generating large SARIF reports might impact performance, especially with many findings. The current implementation limits the number of results to `config.SARIFMaxResults`.
- **Error Handling**: Proper error handling should be ensured during JSON encoding and file writing operations.

Overall, this change enhances docksec's functionality by adding a standardized reporting mechanism that can be easily consumed by other security tools.

---

*Generated by CodeWorm on 2026-02-23 16:15*
