# useBulkUpload

**Type:** Code Evolution
**Repository:** vuemantics
**File:** frontend/src/api/hooks/useBulkUpload.ts
**Language:** typescript
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```typescript
Commit: 4d33b24a
Message: feat: dramatiq - bulkupload
Author: CarterPerez-dev
File: frontend/src/api/hooks/useBulkUpload.ts
Change type: new file

Diff:
@@ -0,0 +1,152 @@
+// ===================
+// © AngelaMos | 2026
+// useBulkUpload.ts
+// ===================
+
+import {
+  type UseMutationResult,
+  type UseQueryResult,
+  useMutation,
+  useQuery,
+  useQueryClient,
+} from '@tanstack/react-query'
+import { toast } from 'sonner'
+import {
+  type BatchListResponse,
+  type BatchStatusResult,
+  BULK_UPLOAD_ERROR_MESSAGES,
+  BULK_UPLOAD_SUCCESS_MESSAGES,
+  BulkUploadError,
+  type BulkUploadResult,
+  isValidBatchListResponse,
+  isValidBatchStatusResult,
+  isValidBulkUploadResult,
+} from '@/api/types'
+import { API_ENDPOINTS, QUERY_KEYS } from '@/config'
+import { apiClient } from '@/core/api'
+
+export const bulkUploadQueries = {
+  batches: () => QUERY_KEYS.UPLOADS.BATCHES(),
+  batch: (batchId: string) => QUERY_KEYS.UPLOADS.BATCH(batchId),
+} as const
+
+const createBulkUpload = async (files: File[]): Promise<BulkUploadResult> => {
+  const formData = new FormData()
+  files.forEach((file) => {
+    formData.append('files', file)
+  })
+
+  const response = await apiClient.post<unknown>(
+    API_ENDPOINTS.UPLOADS.BULK_UPLOAD,
+    formData,
+    {
+      headers: { 'Content-Type': 'multipart/form-data' },
+    }
+  )
+
+  const data: unknown = response.data
+
+  if (!isValidBulkUploadResult(data)) {
+    throw new BulkUploadError(
+      BULK_UPLOAD_ERROR_MESSAGES.INVALID_BULK_UPLOAD_RESPONSE,
+      API_ENDPOINTS.UPLOADS.BULK_UPLOAD
+    )
+  }
+
+  return data
+}
+
+const fetchBatchStatus = async (batchId: string): Promise<BatchStatusResult> => {
+  const response = await apiClient.get<unknown>(
+    API_ENDPOINTS.UPLOADS.BATCH(batchId)
+  )
+  const data: unknown = response.data
+
+  if (!isValidBatchStatusResult(data)) {
+    throw new BulkUploadError(
+      BULK_UPLOAD_ERROR_MESSAGES.INVALID_BATCH_STATUS_RESPONSE,
+      API_ENDPOINTS.UPLOADS.BATCH(batchId)
+    )
+  }
+
+  return data
+}
+
+const fetchBatches = async (
+  limit = 20,
+  offset = 0
+): Promise<BatchListResponse> => {
+  const response = await apiClient.get<unknown>(API_ENDPOINTS.UPLOADS.BATCHES, {
+    params: { limit, offset },
+  })
+  const data: unknown = response.data
+
+  if (!isValidBatchListResponse(data)) {
+    throw new BulkUploadError(
+      BULK_UPLOAD_ERROR_MESSAGES.INVALID_BATCH_LIST_RESPONSE,
+      API_ENDPOINTS.UPLOADS.BATCHES
+    )
+  }
+
+  return data
+}
+
+export const useCreateBulkUpload = (): UseMutationResult<
+  BulkUploadResult,
+  Error,
+  File[]
+> => {
+  const queryClient = useQueryClient()
+
+  return useMutation({
+    mutationFn: createBulkUpload,
+    onSuccess: (data): void => {
+      queryClient.invalidateQueries({ queryKey: bulkUploadQueries.batches() })
+      if (data.failed > 0) {
+        toast.warning(
+          `${data.failed} file${data.failed !== 1 ? 's' : ''} failed validation`
+        )
+      }
+    },
+   
```

---

## Code Evolution

### Change Analysis

**What was Changed**: A new file `useBulkUpload.ts` was added to the repository, introducing three main functions: `createBulkUpload`, `fetchBatchStatus`, and `fetchBatches`. Additionally, custom hooks for bulk upload operations were created using React Query—`useCreateBulkUpload`, `useBatchStatus`, and `useBatches`.

**Why it Was Likely Changed**: This change likely aims to provide a structured way to handle bulk file uploads in the application. By leveraging React Query, these functions enable efficient state management and error handling for asynchronous operations related to bulk uploads.

**Impact on Behavior**: The introduction of these hooks simplifies the process of managing bulk upload states and responses within components. `useCreateBulkUpload` handles the creation of a bulk upload, while `useBatchStatus` and `useBatches` manage fetching batch statuses and lists respectively. This improves code organization and makes it easier to track the progress and results of bulk uploads.

**Risks or Concerns**: The risk primarily lies in ensuring that all validation logic (e.g., `isValidBulkUploadResult`, `isValidBatchStatusResult`) is correctly implemented to prevent unexpected behavior. Additionally, the polling interval for batch status checks could lead to unnecessary API calls if not properly managed.

---

*Generated by CodeWorm on 2026-02-23 10:04*
