# sarif

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/reporter/sarif.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/reporter/sarif.go
Change type: new file

Diff:
@@ -0,0 +1,168 @@
+// Â©AngelaMos | 2026
+// sarif.go
+
+package reporter
+
+import (
+	"encoding/json"
+	"io"
+
+	"github.com/CarterPerez-dev/portia/pkg/types"
+)
+
+type SARIF struct{}
+
+type sarifLog struct {
+	Version string     `json:"version"`
+	Schema  string     `json:"$schema"`
+	Runs    []sarifRun `json:"runs"`
+}
+
+type sarifRun struct {
+	Tool    sarifTool     `json:"tool"`
+	Results []sarifResult `json:"results"`
+}
+
+type sarifTool struct {
+	Driver sarifDriver `json:"driver"`
+}
+
+type sarifDriver struct {
+	Name    string      `json:"name"`
+	Version string      `json:"version"`
+	Rules   []sarifRule `json:"rules,omitempty"`
+}
+
+type sarifRule struct {
+	ID               string          `json:"id"`
+	ShortDescription sarifMessage    `json:"shortDescription"`
+	DefaultConfig    sarifRuleConfig `json:"defaultConfiguration"`
+}
+
+type sarifRuleConfig struct {
+	Level string `json:"level"`
+}
+
+type sarifMessage struct {
+	Text string `json:"text"`
+}
+
+type sarifResult struct {
+	RuleID     string          `json:"ruleId"`
+	Level      string          `json:"level"`
+	Message    sarifMessage    `json:"message"`
+	Locations  []sarifLocation `json:"locations"`
+	Properties map[string]any  `json:"properties,omitempty"`
+}
+
+type sarifLocation struct {
+	PhysicalLocation sarifPhysicalLocation `json:"physicalLocation"`
+}
+
+type sarifPhysicalLocation struct {
+	ArtifactLocation sarifArtifactLocation `json:"artifactLocation"`
+	Region           sarifRegion           `json:"region"`
+}
+
+type sarifArtifactLocation struct {
+	URI string `json:"uri"`
+}
+
+type sarifRegion struct {
+	StartLine int `json:"startLine"`
+}
+
+func (s *SARIF) Report(
+	w io.Writer, result *types.ScanResult,
+) error {
+	ruleMap := make(map[string]bool)
+	var sarifRules []sarifRule
+
+	for _, f := range result.Findings {
+		if ruleMap[f.RuleID] {
+			continue
+		}
+		ruleMap[f.RuleID] = true
+		sarifRules = append(sarifRules, sarifRule{
+			ID:               f.RuleID,
+			ShortDescription: sarifMessage{Text: f.Description},
+			DefaultConfig: sarifRuleConfig{
+				Level: severityToSARIF(f.Severity),
+			},
+		})
+	}
+
+	var results []sarifResult
+	for _, f := range result.Findings {
+		r := sarifResult{
+			RuleID:  f.RuleID,
+			Level:   severityToSARIF(f.Severity),
+			Message: sarifMessage{Text: f.Description},
+			Locations: []sarifLocation{
+				{
+					PhysicalLocation: sarifPhysicalLocation{
+						ArtifactLocation: sarifArtifactLocation{
+							URI: f.FilePath,
+						},
+						Region: sarifRegion{
+							StartLine: f.LineNumber,
+						},
+					},
+				},
+			},
+		}
+
+		props := make(map[string]any)
+		if f.CommitSHA != "" {
+			props["commit"] = f.CommitSHA
+		}
+		if f.Entropy > 0 {
+			props["entropy"] = f.Entropy
+		}
+		if f.HIBPStatus == types.HIB
```

---

## Code Evolution

### Change Analysis for `sarif.go`

**What was Changed:**
The commit introduces a new file, `sarif.go`, which implements the SARIF (Static Analysis Results Interchange Format) reporter in Go. This includes defining data structures and methods to generate SARIF formatted reports from scan results.

**Why it was Likely Changed:**
This change likely aims to enhance the project's output capabilities by adding support for a widely used standard format for static analysis results, making it easier to integrate with other tools and platforms that consume SARIF files. The implementation follows Go idioms such as using `json` encoding and defining nested structs.

**Impact on Behavior:**
The new `Report` function in the `SARIF` struct converts a `types.ScanResult` into a SARIF formatted report, which can be written to an output writer. This will allow the project to generate reports that are compatible with tools like SonarQube or other static analysis platforms.

**Risks and Concerns:**
- **Error Handling:** The function uses `json.NewEncoder`, but there is no explicit error handling for writing to the output writer (`io.Writer`). Ensure robust error handling, especially when dealing with real-world I/O operations.
- **Performance:** Iterating over findings and constructing SARIF objects might be performance-intensive if the number of findings is large. Consider optimizing this process if necessary.
- **Schema Versioning:** The hardcoded schema version should be dynamically fetched or managed to avoid hardcoding in future updates.

Overall, this change significantly enhances the project's interoperability with other tools while adhering to Go best practices.

---

*Generated by CodeWorm on 2026-02-22 21:23*
