# usePeriodForDate

**Type:** Code Evolution
**Repository:** ios-test
**File:** red-recon/src/features/calendar/hooks/usePeriodForDate.ts
**Language:** typescript
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```typescript
Commit: b886d0ad
Message: feat(calendar): add period logging components

Add feature module for calendar period logging:
- FlowIntensitySelector: Light/Medium/Heavy flow picker
- usePeriodForDate: Hook to find period for given date
- PeriodLogSheet: Modal for creating/editing/deleting periods
Author: CarterPerez-dev
File: red-recon/src/features/calendar/hooks/usePeriodForDate.ts
Change type: new file

Diff:
@@ -0,0 +1,76 @@
+/**
+ * @AngelaMos | 2026
+ * usePeriodForDate.ts
+ */
+
+import { useMemo } from 'react'
+import { usePeriodLogs } from '@/api/hooks'
+import type { PeriodLogResponse } from '@/api/types'
+
+export interface UsePeriodForDateResult {
+  period: PeriodLogResponse | null
+  isLoading: boolean
+  isInPeriod: boolean
+  isStartDate: boolean
+  isEndDate: boolean
+}
+
+function isDateInRange(
+  dateStr: string,
+  startDate: string,
+  endDate: string | null
+): boolean {
+  const date = new Date(dateStr)
+  const start = new Date(startDate)
+
+  if (date < start) return false
+
+  if (endDate === null) {
+    const today = new Date()
+    today.setHours(23, 59, 59, 999)
+    return date <= today
+  }
+
+  const end = new Date(endDate)
+  return date <= end
+}
+
+export function usePeriodForDate(dateStr: string): UsePeriodForDateResult {
+  const { data: periodLogs, isLoading } = usePeriodLogs()
+
+  const result = useMemo(() => {
+    if (!periodLogs || !dateStr) {
+      return {
+        period: null,
+        isInPeriod: false,
+        isStartDate: false,
+        isEndDate: false,
+      }
+    }
+
+    const actualPeriods = periodLogs.filter((p) => !p.is_predicted)
+
+    for (const period of actualPeriods) {
+      if (isDateInRange(dateStr, period.start_date, period.end_date)) {
+        return {
+          period,
+          isInPeriod: true,
+          isStartDate: dateStr === period.start_date,
+          isEndDate: period.end_date !== null && dateStr === period.end_date,
+        }
+      }
+    }
+
+    return {
+      period: null,
+      isInPeriod: false,
+      isStartDate: false,
+      isEndDate: false,
+    }
+  }, [periodLogs, dateStr])
+
+  return {
+    ...result,
+    isLoading,
+  }
+}

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `usePeriodForDate.ts` was added, introducing a React hook named `usePeriodForDate`. This hook leverages the `usePeriodLogs` API to determine if a given date falls within any recorded period logs. It returns detailed information about whether the date is in a period, and if so, which period it belongs to.

**Why it was Likely Changed:**
This change likely aims to provide calendar users with more granular control over their period data by allowing them to quickly identify periods associated with specific dates. This could be useful for features like logging symptoms or tracking menstrual cycles accurately.

**Impact on Behavior:**
The new hook enables developers to easily check if a date corresponds to an existing period log, and provides additional context such as whether the date is the start or end of a period. This can enhance user experience by offering more precise and contextual information within calendar-related features.

**Risks or Concerns:**
- **Performance:** The hook filters through all period logs on every render, which could impact performance if there are many period logs.
- **Data Consistency:** Ensuring that the `usePeriodLogs` API returns accurate data is crucial to avoid incorrect period detection.
- **Edge Cases:** Handling dates near the end of periods (e.g., when `endDate` is null) requires careful consideration to ensure correct behavior.

Overall, this change introduces valuable functionality while introducing some potential performance and consistency risks.

---

*Generated by CodeWorm on 2026-02-23 11:49*
