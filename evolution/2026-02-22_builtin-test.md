# builtin_test

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/rules/builtin_test.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/rules/builtin_test.go
Change type: new file

Diff:
@@ -0,0 +1,541 @@
+// Â©AngelaMos | 2026
+// builtin_test.go
+
+package rules
+
+import (
+	"testing"
+
+	"github.com/stretchr/testify/assert"
+	"github.com/stretchr/testify/require"
+)
+
+func TestRegisterBuiltins(t *testing.T) {
+	t.Parallel()
+	reg := NewRegistry()
+	RegisterBuiltins(reg)
+	assert.GreaterOrEqual(t, reg.Len(), 70)
+}
+
+func TestBuiltinRuleIDs(t *testing.T) {
+	t.Parallel()
+	reg := NewRegistry()
+	RegisterBuiltins(reg)
+	seen := make(map[string]bool)
+	for _, r := range reg.All() {
+		assert.NotEmpty(t, r.ID)
+		assert.NotEmpty(t, r.Description)
+		assert.NotEmpty(t, r.Keywords)
+		assert.NotNil(t, r.Pattern)
+		assert.False(t, seen[r.ID], "duplicate ID: %s", r.ID)
+		seen[r.ID] = true
+	}
+}
+
+func TestBuiltinPatternMatches(t *testing.T) { //nolint:funlen,gocognit
+	t.Parallel()
+
+	tests := map[string]struct {
+		ruleID    string
+		input     string
+		wantMatch bool
+		wantGroup string
+	}{
+		"aws access key": { //nolint:gosec
+			ruleID:    "aws-access-key-id",
+			input:     `aws_key = "AKIAIOSFODNN7EXAMPLE"`,
+			wantMatch: true,
+			wantGroup: "AKIAIOSFODNN7EXAMPLE",
+		},
+		"aws access key ABIA prefix": {
+			ruleID:    "aws-access-key-id",
+			input:     `ABIAIOSFODNN7EXAMPL0`,
+			wantMatch: true,
+			wantGroup: "ABIAIOSFODNN7EXAMPL0",
+		},
+		"aws access key too short": {
+			ruleID:    "aws-access-key-id",
+			input:     `AKIA1234`,
+			wantMatch: false,
+		},
+		"github pat classic": {
+			ruleID:    "github-pat-classic",
+			input:     `ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij`,
+			wantMatch: true,
+			wantGroup: "ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij",
+		},
+		"github pat fine-grained": {
+			ruleID:    "github-pat-fine",
+			input:     `github_pat_abcdefghijABCDEFGHIJKL_abcdefghij0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789ABC`,
+			wantMatch: true,
+		},
+		"github oauth": {
+			ruleID:    "github-oauth-token",
+			input:     `gho_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij`,
+			wantMatch: true,
+			wantGroup: "gho_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij",
+		},
+		"github app token": {
+			ruleID:    "github-app-token",
+			input:     `ghs_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij`,
+			wantMatch: true,
+			wantGroup: "ghs_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij",
+		},
+		"github refresh token": {
+			ruleID:    "github-refresh-token",
+			input:     `ghr_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij`,
+			wantMatch: true,
+			wantGroup: "ghr_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghij",
+		},
+		"gitlab pat": {
+			ruleID:    "gitlab-pat",
+			input:     `glpat-xYz1234567890AbCdEfGh`,
+			wantMatch: true,
+			wantGroup: "glpat-xYz1234567890AbCdEfGh",
+		},
+		"gitlab pipeline trigger": {
+			ruleID:    "gitlab-pipeline-trigger",
+			input:     `glptt-abcdefghijklmnopqrstuvwxyz0123456789ABCD`,
+			wantMatch: true,
+			wantGroup: "glptt-a
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `builtin_test.go` was added to the `internal/rules` package, containing test functions for built-in rules. The tests cover registration of built-in rules, rule IDs, and specific pattern matches.

**Why it Was Likely Changed:**
This change likely aims to improve the testing coverage of the secrets scanner by adding comprehensive unit tests for the built-in rules. This ensures that all predefined security rules are correctly registered and can accurately detect sensitive information.

**Impact on Behavior:**
The addition of these tests does not directly impact the behavior of the existing code but significantly enhances its reliability through thorough validation. The `TestRegisterBuiltins` function verifies that at least 70 built-in rules are registered, while other tests ensure each rule has valid metadata and can correctly match patterns.

**Risks or Concerns:**
- **Complexity**: The test for pattern matches (`TestBuiltinPatternMatches`) is quite extensive with many cases. This could make the function harder to maintain.
- **Security Risks**: Some test inputs contain sensitive data marked as `nolint:gosec`, which should be reviewed to ensure they do not compromise security practices.

Overall, this change improves code quality and ensures that the secrets scanner functions as intended across various scenarios.

---

*Generated by CodeWorm on 2026-02-22 21:32*
