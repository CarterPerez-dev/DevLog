# terminal

**Type:** Code Evolution
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/secrets-scanner/internal/reporter/terminal.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 294169a2
Message: feat: Complete Go secrets scanner - Portia
Author: CarterPerez-dev
File: PROJECTS/intermediate/secrets-scanner/internal/reporter/terminal.go
Change type: new file

Diff:
@@ -0,0 +1,219 @@
+// Â©AngelaMos | 2026
+// terminal.go
+
+package reporter
+
+import (
+	"fmt"
+	"io"
+	"sort"
+	"strings"
+
+	"github.com/CarterPerez-dev/portia/internal/ui"
+	"github.com/CarterPerez-dev/portia/pkg/types"
+)
+
+type Terminal struct{}
+
+type errWriter struct {
+	w   io.Writer
+	err error
+}
+
+func (ew *errWriter) printf(format string, args ...any) {
+	if ew.err != nil {
+		return
+	}
+	_, ew.err = fmt.Fprintf(ew.w, format, args...)
+}
+
+func (ew *errWriter) println(args ...any) {
+	if ew.err != nil {
+		return
+	}
+	_, ew.err = fmt.Fprintln(ew.w, args...)
+}
+
+func (t *Terminal) Report(
+	w io.Writer, result *types.ScanResult,
+) error {
+	ew := &errWriter{w: w}
+
+	if len(result.Findings) == 0 {
+		ew.printf("\n%s %s\n\n",
+			ui.Check,
+			ui.Green("No secrets detected"),
+		)
+		t.printSummary(ew, result)
+		return ew.err
+	}
+
+	ew.printf("\n%s %s\n\n",
+		ui.Warning,
+		ui.RedBold(fmt.Sprintf(
+			"%d secret(s) detected",
+			len(result.Findings),
+		)),
+	)
+
+	sorted := make([]types.Finding, len(result.Findings))
+	copy(sorted, result.Findings)
+	sort.Slice(sorted, func(i, j int) bool {
+		return sorted[i].Severity.Rank() < sorted[j].Severity.Rank()
+	})
+
+	for i, f := range sorted {
+		if i > 0 {
+			ew.println()
+		}
+		t.printFinding(ew, &f)
+	}
+
+	t.printSummary(ew, result)
+	return ew.err
+}
+
+func (t *Terminal) printFinding(
+	ew *errWriter, f *types.Finding,
+) {
+	sevColor := severityColor(f.Severity)
+
+	ew.printf("%s %s - %s\n",
+		ui.HiGreen(ui.Diamond),
+		sevColor(f.Severity.String()),
+		ui.HiWhite(f.Description),
+	)
+
+	ew.printf("  %s %s %s\n",
+		ui.Green(ui.Arrow), ui.HiBlue("Rule:    "), ui.Cyan(f.RuleID))
+	ew.printf("  %s %s %s\n",
+		ui.Green(ui.Arrow), ui.HiBlue("File:    "),
+		ui.WhiteBold(fmt.Sprintf("%s:%d", f.FilePath, f.LineNumber)))
+	ew.printf(
+		"  %s %s %s\n",
+		ui.Green(
+			ui.Arrow,
+		),
+		ui.HiBlue("Secret:  "),
+		ui.YellowBold(maskSecret(f.Secret)),
+	)
+
+	if f.Entropy > 0 {
+		ew.printf("  %s %s %s\n",
+			ui.Green(ui.Arrow), ui.HiBlue("Entropy: "),
+			ui.HiGreenUnderline(fmt.Sprintf("%.2f bits", f.Entropy)))
+	}
+
+	if f.CommitSHA != "" {
+		ew.printf("  %s %s %s\n",
+			ui.Green(ui.Arrow), ui.HiBlue("Commit:  "),
+			ui.Magenta(truncateSHA(f.CommitSHA)))
+	}
+	if f.Author != "" {
+		ew.printf("  %s %s %s\n",
+			ui.Green(ui.Arrow), ui.HiBlue("Author:  "), f.Author)
+	}
+
+	if f.HIBPStatus == types.HIBPBreached {
+		ew.printf("  %s Breached: %s (%d occurrences)\n",
+			ui.Warning,
+			ui.RedBold("FOUND IN BREACHES"),
+			f.BreachCount,
+		)
+	} else if f.HIBPStatus == types.HIBPClean {
+		ew.printf("  %s HIBP:     %s\n",
+			ui.Shield, ui.Green("not found in breaches"))
+	}
+
+	if f.LineContent != "" {
+		ew.printf("  %s %s %s\n",
+			ui.Green(ui.Arrow), ui.HiBlue("Context: "
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `terminal.go` was added to the `reporter` package in the `secrets-scanner` project. This file introduces a terminal reporter that handles the output of scan results, including formatting and printing findings.

**Why it was Likely Changed:**
The addition of this file likely aims to provide a structured way to display scan results directly in the terminal, enhancing user experience by presenting findings clearly and colorfully. The use of custom colors and symbols (e.g., checkmarks, warnings) improves readability and highlights severity levels.

**Impact on Behavior:**
This change significantly alters how scan results are presented to users. It ensures that critical information such as secret detections, file paths, line numbers, and entropy values are displayed in a visually distinct manner. The summary section provides an overview of the scan's duration, total files, rules, findings, and HIBP status.

**Risks or Concerns:**
- **Complexity**: Adding a new reporter introduces complexity to the project structure.
- **Error Handling**: While error handling is implemented using `errWriter`, potential issues might arise if the underlying writer fails (e.g., network errors during output).
- **Customization**: The current implementation uses hardcoded colors and symbols, which may not be suitable for all terminal environments or user preferences. Consideration should be given to making these customizable.

Overall, this change enhances the project's usability by providing a clear and informative output mechanism.

---

*Generated by CodeWorm on 2026-02-22 21:28*
