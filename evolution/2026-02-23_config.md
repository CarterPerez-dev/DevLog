# config

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/config/config.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/config/config.go
Change type: new file

Diff:
@@ -0,0 +1,90 @@
+/*
+AngelaMos | 2025
+config.go
+*/
+
+package config
+
+import "github.com/CarterPerez-dev/docksec/internal/finding"
+
+type Config struct {
+	Targets           []string
+	Files             []string
+	Output            string
+	OutputFile        string
+	Severity          []string
+	CISControls       []string
+	ExcludeContainers []string
+	IncludeContainers []string
+	FailOn            string
+	Quiet             bool
+	Verbose           bool
+	Workers           int
+}
+
+func New() *Config {
+	return &Config{
+		Targets: []string{"all"},
+		Output:  "terminal",
+		Workers: DefaultWorkerCount,
+	}
+}
+
+func (c *Config) ShouldScanContainers() bool {
+	return c.containsTarget("all") || c.containsTarget("containers")
+}
+
+func (c *Config) ShouldScanDaemon() bool {
+	return c.containsTarget("all") || c.containsTarget("daemon")
+}
+
+func (c *Config) ShouldScanImages() bool {
+	return c.containsTarget("all") || c.containsTarget("images")
+}
+
+func (c *Config) HasFileTargets() bool {
+	return len(c.Files) > 0
+}
+
+func (c *Config) containsTarget(target string) bool {
+	for _, t := range c.Targets {
+		if t == target {
+			return true
+		}
+	}
+	return false
+}
+
+func (c *Config) GetFailOnSeverity() (finding.Severity, bool) {
+	if c.FailOn == "" {
+		return finding.SeverityInfo, false
+	}
+	sev, ok := finding.ParseSeverity(c.FailOn)
+	return sev, ok
+}
+
+func (c *Config) GetSeverityFilters() []finding.Severity {
+	if len(c.Severity) == 0 {
+		return nil
+	}
+	var severities []finding.Severity
+	for _, s := range c.Severity {
+		if sev, ok := finding.ParseSeverity(s); ok {
+			severities = append(severities, sev)
+		}
+	}
+	return severities
+}
+
+func (c *Config) ShouldIncludeSeverity(sev finding.Severity) bool {
+	filters := c.GetSeverityFilters()
+	if len(filters) == 0 {
+		return true
+	}
+	for _, f := range filters {
+		if f == sev {
+			return true
+		}
+	}
+	return false
+}

```

---

## Code Evolution

### Change Analysis for Commit 5a7c48c4

**What was Changed:**
A new file `config.go` was added to the `internal/config` package, defining a `Config` struct and several helper functions to manage configuration settings. The `New()` function initializes default values, while methods like `ShouldScanContainers()`, `ShouldScanDaemon()`, and `ShouldScanImages()` determine if certain targets should be scanned based on user input.

**Why it was Likely Changed:**
This change introduces a structured way to handle application configuration in the `docksec` project. It likely aims to centralize configuration management, making it easier to manage different aspects of the application such as target scanning criteria and severity filters.

**Impact on Behavior:**
The introduction of this config struct allows for more flexible and dynamic configuration handling. Users can now specify various parameters like targets, files, output formats, and severity levels directly in the configuration. This impacts how the application behaves by determining which containers or images to scan and what severities to filter out.

**Risks or Concerns:**
- **Error Handling:** The `GetSeverityFilters()` method assumes that all parsed severities are valid, which could lead to panics if invalid strings are passed.
- **Default Values:** Default values like `Targets` being set to `"all"` might not always be appropriate and should be carefully considered based on the application's context.
- **Extensibility:** While the struct is flexible, adding new fields or methods in the future could require changes throughout the codebase.

---

*Generated by CodeWorm on 2026-02-23 15:39*
