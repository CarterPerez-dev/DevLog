# config

**Type:** Code Evolution
**Repository:** angela
**File:** internal/config/config.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: ea4cc501
Message: Create canonical module source location - release v1.0.0
Author: CarterPerez-dev
File: internal/config/config.go
Change type: new file

Diff:
@@ -0,0 +1,80 @@
+// Â©AngelaMos | 2026
+// config.go
+
+package config
+
+import (
+	"os"
+	"strings"
+
+	toml "github.com/pelletier/go-toml/v2"
+)
+
+// Config holds project-level angela settings loaded from .angela.toml
+// or [tool.angela] in pyproject.toml
+type Config struct {
+	MinSeverity string   `toml:"min-severity"`
+	Ignore      []string `toml:"ignore"`
+	IgnoreVulns []string `toml:"ignore-vulns"`
+}
+
+type pyprojectWrapper struct {
+	Tool struct {
+		Angela Config `toml:"angela"`
+	} `toml:"tool"`
+}
+
+// Load reads angela configuration using a cascading resolution order:
+// .angela.toml in current directory, then [tool.angela] in pyproject.toml
+func Load(pyprojectPath string) Config {
+	if cfg, err := loadFile(".angela.toml"); err == nil {
+		return cfg
+	}
+
+	if cfg, ok := loadFromPyproject(pyprojectPath); ok {
+		return cfg
+	}
+
+	return Config{}
+}
+
+func loadFile(path string) (Config, error) {
+	data, err := os.ReadFile(path) //nolint:gosec
+	if err != nil {
+		return Config{}, err
+	}
+
+	var cfg Config
+	if err := toml.Unmarshal(data, &cfg); err != nil {
+		return Config{}, err
+	}
+
+	cfg.MinSeverity = strings.ToLower(
+		strings.TrimSpace(cfg.MinSeverity),
+	)
+	return cfg, nil
+}
+
+func loadFromPyproject(path string) (Config, bool) {
+	data, err := os.ReadFile(path) //nolint:gosec
+	if err != nil {
+		return Config{}, false
+	}
+
+	var wrapper pyprojectWrapper
+	if err := toml.Unmarshal(data, &wrapper); err != nil {
+		return Config{}, false
+	}
+
+	cfg := wrapper.Tool.Angela
+	if cfg.MinSeverity == "" &&
+		len(cfg.Ignore) == 0 &&
+		len(cfg.IgnoreVulns) == 0 {
+		return Config{}, false
+	}
+
+	cfg.MinSeverity = strings.ToLower(
+		strings.TrimSpace(cfg.MinSeverity),
+	)
+	return cfg, true
+}

```

---

## Code Evolution

### Change Analysis for Commit `ea4cc501`

**What was Changed:**
A new file, `config.go`, was added to the repository. This file introduces a `Config` struct and two functions: `Load` and helper functions `loadFile` and `loadFromPyproject`. The `Config` struct holds project-level settings such as minimum severity levels and ignored vulnerabilities.

**Why it Was Likely Changed:**
This change likely aims to centralize configuration handling for the `angela` tool, allowing it to read settings from both `.angela.toml` and `[tool.angela]` in `pyproject.toml`. This provides flexibility by allowing users to configure settings in either file.

**Impact on Behavior:**
The `Load` function now handles cascading configuration resolution, ensuring that if a user has specified settings in one of the supported files, those settings are used. If neither file contains valid configurations, an empty `Config` is returned.

**Risks or Concerns:**
- **Security Risks:** The use of `os.ReadFile` without proper validation or error handling could expose sensitive information.
- **Error Handling:** While basic error handling is present, more robust checks and logging should be implemented to ensure reliable configuration loading.
- **Code Duplication:** The helper functions `loadFile` and `loadFromPyproject` perform similar operations. Consider refactoring these into a single function with parameters for better code reuse.

Overall, this change improves the tool's configurability but requires attention to security and error handling best practices.

---

*Generated by CodeWorm on 2026-02-23 13:39*
