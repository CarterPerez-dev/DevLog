# rate_limit

**Type:** Code Evolution
**Repository:** social-media-notes
**File:** backend/app/core/rate_limit.py
**Language:** python
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```python
Commit: 8c757802
Message: easy peasy
Author: CarterPerez-dev
File: backend/app/core/rate_limit.py
Change type: new file

Diff:
@@ -0,0 +1,44 @@
+"""
+â’¸AngelaMos | 2025
+rate_limit.py
+"""
+
+import jwt
+from slowapi import Limiter
+from slowapi.util import get_remote_address
+from starlette.requests import Request
+
+from config import settings
+
+
+def get_identifier(request: Request) -> str:
+    """
+    Get rate limit identifier
+
+    Uses user ID if authenticated, otherwise falls back to IP address
+    (Will add more fingerprinting if needed depending on project)
+    """
+    auth_header = request.headers.get("Authorization")
+    if auth_header and auth_header.startswith("Bearer "):
+        try:
+            token = auth_header.split(" ")[1]
+            payload = jwt.decode(
+                token,
+                options = {"verify_signature": False},
+            )
+            user_id = payload.get("sub")
+            if user_id:
+                return f"user:{user_id}"
+        except Exception:
+            pass
+
+    return get_remote_address(request)
+
+
+limiter = Limiter(
+    key_func = get_identifier,
+    storage_uri = str(settings.REDIS_URL) if settings.REDIS_URL else None,
+    default_limits = [settings.RATE_LIMIT_DEFAULT],
+    headers_enabled = True,
+    in_memory_fallback_enabled = True,
+)

```

---

## Code Evolution

### Change Analysis

**What was Changed:**
A new file `rate_limit.py` was added to the project. This file introduces rate limiting functionality using the `slowapi` library and JWT token decoding for user identification.

**Why it was Likely Changed:**
The addition of this file likely aims to implement a rate-limiting mechanism in the application, enhancing security by controlling API usage frequency. The use of JWT tokens allows for more granular control based on user authentication status.

**Impact on Behavior:**
This change will enforce rate limits on API requests, either using the authenticated user ID or the IP address if no token is provided. This ensures that users are limited in their request frequency, which can help prevent abuse and ensure fair usage of the service.

**Risks or Concerns:**
- **Security Risks:** If JWT tokens are misused or stolen, unauthorized access could occur.
- **Performance Impact:** The additional processing required for token decoding might introduce minor performance overhead.
- **Complexity:** Introducing rate limiting can add complexity to request handling logic. Care must be taken to ensure that the implementation is robust and does not introduce bugs.

Overall, this change enhances security and resource management but requires careful monitoring and testing.

---

*Generated by CodeWorm on 2026-02-23 17:59*
