# terminal

**Type:** Code Evolution
**Repository:** docksec
**File:** internal/report/terminal.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: 5a7c48c4
Message: Initial release
Author: CarterPerez-dev
File: internal/report/terminal.go
Change type: new file

Diff:
@@ -0,0 +1,263 @@
+/*
+AngelaMos | 2025
+terminal.go
+*/
+
+package report
+
+import (
+	"fmt"
+	"io"
+	"sort"
+	"strings"
+
+	"github.com/CarterPerez-dev/docksec/internal/finding"
+)
+
+const (
+	colorReset   = "\033[0m"
+	colorBold    = "\033[1m"
+	colorRed     = "\033[31m"
+	colorGreen   = "\033[32m"
+	colorYellow  = "\033[33m"
+	colorBlue    = "\033[34m"
+	colorMagenta = "\033[35m"
+	colorCyan    = "\033[36m"
+	colorWhite   = "\033[37m"
+	colorGray    = "\033[90m"
+)
+
+type TerminalReporter struct {
+	w       io.Writer
+	closer  func() error
+	colored bool
+}
+
+func (r *TerminalReporter) Report(findings finding.Collection) error {
+	defer func() {
+		if r.closer != nil {
+			_ = r.closer()
+		}
+	}()
+
+	if len(findings) == 0 {
+		r.printLine(colorGreen, "No security issues found.")
+		return nil
+	}
+
+	r.printHeader(findings)
+	r.printFindings(findings)
+	r.printSummary(findings)
+
+	return nil
+}
+
+func (r *TerminalReporter) printHeader(findings finding.Collection) {
+	r.printLine(colorBold, "")
+	r.printLine(colorBold, "Security Scan Results")
+	r.printLine(colorBold, strings.Repeat("=", 60))
+	_, _ = fmt.Fprintln(r.w)
+}
+
+func (r *TerminalReporter) printFindings(findings finding.Collection) {
+	grouped := r.groupByCategory(findings)
+
+	categories := make([]string, 0, len(grouped))
+	for cat := range grouped {
+		categories = append(categories, cat)
+	}
+	sort.Strings(categories)
+
+	for _, category := range categories {
+		catFindings := grouped[category]
+		r.printCategory(category, catFindings)
+	}
+}
+
+func (r *TerminalReporter) printCategory(
+	category string,
+	findings finding.Collection,
+) {
+	r.printLine(colorBold+colorCyan, "[ "+category+" ]")
+	_, _ = fmt.Fprintln(r.w)
+
+	sorted := r.sortBySeverity(findings)
+
+	for _, f := range sorted {
+		r.printFinding(f)
+	}
+
+	_, _ = fmt.Fprintln(r.w)
+}
+
+func (r *TerminalReporter) printFinding(f *finding.Finding) {
+	sevColor := r.severityColor(f.Severity)
+	sevLabel := fmt.Sprintf("[%-8s]", f.Severity.String())
+
+	r.print(sevColor, sevLabel)
+	r.print(colorWhite, " ")
+	r.print(colorBold, f.Title)
+	_, _ = fmt.Fprintln(r.w)
+
+	r.print(colorGray, "           ")
+	r.print(colorGray, "Target: ")
+	r.printLine(colorWhite, f.Target.String())
+
+	if f.Location != nil {
+		r.print(colorGray, "           ")
+		r.print(colorGray, "Location: ")
+		r.printLine(colorWhite, f.Location.String())
+	}
+
+	if f.Description != "" {
+		r.print(colorGray, "           ")
+		wrapped := r.wrapText(f.Description, 60)
+		for i, line := range wrapped {
+			if i > 0 {
+				r.print(colorGray, "           ")
+			}
+			r.printLine(colorGray, line)
+		}
+	}
+
+	if f.Remediation != "" {
+		r.print(colorGray, "           ")
+		r.print(colorGreen, "Fix: ")
+		wrapped := r.wrapText(f.Remediation, 55)
+		for i, line := range wrapped {
+			if i > 0 {
+				r.print(colorGray, "      
```

---

## Code Evolution

### Change Analysis for `internal/report/terminal.go`

**What was Changed:**
The commit introduces a new file, `terminal.go`, which implements a terminal-based reporter for security findings. This includes functions to print headers, categorize and display findings, and generate summaries.

**Why it was Likely Changed:**
This change likely aims to provide a user-friendly way to display security scan results directly in the terminal. The use of color codes enhances readability and highlights severity levels, making it easier for users to quickly identify critical issues.

**Impact on Behavior:**
The `TerminalReporter` struct handles writing findings to an `io.Writer`, supporting colored output based on severity. This impacts how security reports are presented, making them more visually distinct and actionable.

**Risks or Concerns:**
- **Error Handling:** The `Report` function does not explicitly handle errors from the `closer` function, which could lead to resource leaks if an error occurs.
- **Performance:** Sorting findings by severity in memory might be a concern for very large datasets.
- **Customization:** Users may need more customization options (e.g., disabling colors) that are currently hard-coded.

Overall, this change enhances the usability of the security scanning tool by providing a clear and visually rich output format.

---

*Generated by CodeWorm on 2026-02-23 16:19*
