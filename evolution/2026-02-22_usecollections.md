# useCollections

**Type:** Code Evolution
**Repository:** oneIsNun_
**File:** react-scss/src/api/hooks/useCollections.ts
**Language:** typescript
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```typescript
Commit: fc968a71
Message: feat: transform to MongoDB management dashboard

Major refactor from auth template to MongoDB dashboard:

Backend:
- Fix WebSocket context issue (use context.Background instead of r.Context)
- Add Dockerfile.dev with Air hot reload and mongodb-database-tools
- Update go.mod to Go 1.25
- Add Makefile for mongo and app management
- Add dev.compose.yml for Docker development environment
- Configure mongo-rs.yml for 3-node replica set

Frontend:
- Add HydrateFallback to silence React Router warning
- Update CSP to allow localhost:8080 and ws connections
- Replace auth pages with dashboard, collections, backups, slow-queries
- Add WebSocket hook for real-time metrics
- Add metrics, backups, collections API hooks and types
- Update shell with connection status indicator
- Remove auth-related code (login, register, protected routes)

Removed legacy GO/*.md architecture docs (moved to CLAUDE.md)
Author: CarterPerez-dev
File: react-scss/src/api/hooks/useCollections.ts
Change type: new file

Diff:
@@ -0,0 +1,84 @@
+// ===================
+// AngelaMos | 2026
+// useCollections.ts
+// ===================
+
+import { useQuery } from '@tanstack/react-query'
+import { apiClient } from '@/core/api'
+import { API_ENDPOINTS, QUERY_CONFIG, QUERY_KEYS } from '@/config'
+import {
+  parseApiResponse,
+  CollectionsListResponseSchema,
+  CollectionStatsSchema,
+  SchemaAnalysisSchema,
+  type CollectionsListResponse,
+  type CollectionStats,
+  type SchemaAnalysis,
+  type IndexInfo,
+} from '../types'
+import { z } from 'zod'
+
+export function useCollections() {
+  return useQuery({
+    queryKey: QUERY_KEYS.COLLECTIONS.LIST(),
+    queryFn: async (): Promise<CollectionsListResponse> => {
+      const { data } = await apiClient.get(API_ENDPOINTS.COLLECTIONS.LIST)
+      return parseApiResponse(CollectionsListResponseSchema, data)
+    },
+    staleTime: QUERY_CONFIG.STALE_TIME.COLLECTIONS,
+  })
+}
+
+export function useCollectionStats(name: string) {
+  return useQuery({
+    queryKey: QUERY_KEYS.COLLECTIONS.BY_NAME(name),
+    queryFn: async (): Promise<CollectionStats> => {
+      const { data } = await apiClient.get(API_ENDPOINTS.COLLECTIONS.BY_NAME(name))
+      return parseApiResponse(CollectionStatsSchema, data)
+    },
+    enabled: !!name,
+    staleTime: QUERY_CONFIG.STALE_TIME.COLLECTIONS,
+  })
+}
+
+export function useCollectionSchema(name: string, sampleSize?: number) {
+  return useQuery({
+    queryKey: QUERY_KEYS.COLLECTIONS.SCHEMA(name),
+    queryFn: async (): Promise<SchemaAnalysis> => {
+      const params = sampleSize ? `?sample_size=${sampleSize}` : ''
+      const { data } = await apiClient.get(
+        `${API_ENDPOINTS.COLLECTIONS.SCHEMA(name)}${params}`
+      )
+      return parseApiResponse(SchemaAnalysisSchema, data)
+    },
+    enabled: !!name,
+    staleTime: QUERY_CONFIG.STALE_TIME.COLLECTIONS,
+  })
+}
+
+export function useCollectionIndexes(name: string) {
+  return useQuery({
+    queryKey: QUERY_KEYS.C
```

---

## Code Evolution

### Change Analysis

**What was Changed:**
The commit introduces `useCollections.ts`, a new file in the React frontend that provides custom hooks for interacting with MongoDB collections. These hooks include `useCollections`, `useCollectionStats`, `useCollectionSchema`, `useCollectionIndexes`, and `useCollectionDocuments`. Each hook fetches data from MongoDB using an API client, parses responses with Zod schemas, and returns them to the React components.

**Why it was Likely Changed:**
This change likely aims to centralize and standardize MongoDB interaction logic in the frontend. By creating these hooks, developers can easily manage collections-related operations without duplicating code. The use of `@tanstack/react-query` ensures efficient data fetching with caching and stale-while-revalidate strategies.

**Impact on Behavior:**
These new hooks will enable React components to interact more seamlessly with MongoDB collections. Developers can now leverage these hooks to fetch collection lists, stats, schema analysis, indexes, and documents directly from the backend, enhancing the dashboard's functionality.

**Risks or Concerns:**
- **Complexity:** Adding multiple hooks might introduce complexity if not managed properly.
- **Performance:** Frequent API calls could impact performance; ensuring efficient caching is crucial.
- **Error Handling:** Proper error handling should be implemented to manage potential issues during data fetching.

---

*Generated by CodeWorm on 2026-02-22 23:31*
