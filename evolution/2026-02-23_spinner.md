# spinner

**Type:** Code Evolution
**Repository:** angela
**File:** internal/ui/spinner.go
**Language:** go
**Lines:** 1-1
**Complexity:** 0.0

---

## Source Code

```go
Commit: ea4cc501
Message: Create canonical module source location - release v1.0.0
Author: CarterPerez-dev
File: internal/ui/spinner.go
Change type: new file

Diff:
@@ -0,0 +1,87 @@
+// ©AngelaMos | 2026
+// spinner.go
+
+package ui
+
+import (
+	"fmt"
+	"strings"
+	"sync"
+	"time"
+)
+
+var frames = []string{
+	"⠋", "⠙", "⠹", "⠸", "⠼", "⠴", "⠦", "⠧", "⠇", "⠏",
+}
+
+// Spinner displays an animated braille spinner in the terminal.
+type Spinner struct {
+	msg    string
+	done   chan struct{}
+	wg     sync.WaitGroup
+	mu     sync.Mutex
+	active bool
+}
+
+// NewSpinner creates a spinner with the given message.
+func NewSpinner(msg string) *Spinner {
+	return &Spinner{msg: msg}
+}
+
+// Start begins the spinner animation in a goroutine.
+func (s *Spinner) Start() {
+	s.mu.Lock()
+	if s.active {
+		s.mu.Unlock()
+		return
+	}
+	s.active = true
+	s.done = make(chan struct{})
+	s.wg.Add(1)
+	s.mu.Unlock()
+
+	go s.run()
+}
+
+// Stop halts the spinner and clears the line.
+func (s *Spinner) Stop() {
+	s.mu.Lock()
+	if !s.active {
+		s.mu.Unlock()
+		return
+	}
+	s.active = false
+	close(s.done)
+	s.mu.Unlock()
+	s.wg.Wait()
+}
+
+func (s *Spinner) run() {
+	defer s.wg.Done()
+	fmt.Print("\033[?25l")
+
+	ticker := time.NewTicker(80 * time.Millisecond)
+	defer ticker.Stop()
+
+	idx := 0
+	for {
+		select {
+		case <-s.done:
+			clearLine()
+			fmt.Print("\033[?25h")
+			return
+		case <-ticker.C:
+			frame := frames[idx%len(frames)]
+			fmt.Printf(
+				"\r  %s %s",
+				CyanBold(frame),
+				HiMagenta(s.msg),
+			)
+			idx++
+		}
+	}
+}
+
+func clearLine() {
+	fmt.Print("\r" + strings.Repeat(" ", 80) + "\r")
+}

```

---

## Code Evolution

### Change Analysis for `spinner.go`

**What was Changed:**
The commit introduces a new file, `spinner.go`, which implements an animated spinner for terminal output. The code defines a `Spinner` struct with methods to start and stop the animation.

**Why it was Likely Changed:**
This change likely aims to enhance user experience by providing visual feedback during long-running operations in the terminal. The spinner uses ANSI escape codes to clear and update the line, making it appear as if the cursor is moving.

**Impact on Behavior:**
The introduction of this `Spinner` module allows developers to easily add animated loading indicators to their applications. This can improve user engagement by providing visual feedback during asynchronous operations.

**Risks or Concerns:**
- **Resource Management:** The use of goroutines and channels ensures proper cleanup when the spinner is stopped, but it's crucial that all resources are correctly managed.
- **Error Handling:** While basic error handling is implied (e.g., stopping the spinner), more robust error management could be added to handle unexpected issues.
- **Performance Impact:** Frequent updates to the terminal can introduce minor performance overhead. However, given the short duration of each update (80 ms), this should not significantly impact application performance.

Overall, this change is a feature addition that enhances usability without introducing significant risks.

---

*Generated by CodeWorm on 2026-02-23 14:54*
