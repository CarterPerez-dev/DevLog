# decorator_pattern

**Type:** Pattern Analysis
**Repository:** CertGames-Core
**File:** backend/api/core/decorators/response.py
**Language:** python
**Lines:** 1-41
**Complexity:** 0.0

---

## Source Code

```python
"""
CertGames API Response Decorator
/api/core/decorators/response.py
"""

from functools import wraps
from pydantic import BaseModel


def CertGamesAPI(schema_class: type[BaseModel]):
    """
    CertGames API response schema decorator for Pydantic models
    """
    def decorator(f):
        @wraps(f)
        def wrapper(*args, **kwargs):
            result = f(*args, **kwargs)

            if isinstance(result, tuple):
                data, status_code = result
                if isinstance(data, dict):
                    validated = schema_class(**data)
                    return validated.model_dump(mode = 'json'), status_code
                return result

            if isinstance(result, dict):
                validated = schema_class(**result)
                return validated.model_dump(mode = 'json')

            if isinstance(result, BaseModel):
                if isinstance(result, schema_class):
                    return result.model_dump(mode = 'json')
                validated = schema_class(**result.model_dump())
                return validated.model_dump(mode = 'json')

            return result

        return wrapper

    return decorator

```

---

## Pattern Analysis

### Pattern Analysis

**Pattern Used:** Decorator Pattern

The `CertGamesAPI` decorator wraps a function to ensure that its return value conforms to a specified Pydantic schema. This implementation uses Python's `functools.wraps` and a nested decorator structure.

- **Implementation**: The outer `@wraps(f)` preserves the original function’s metadata, while the inner `wrapper` function processes the result according to the schema.
- **Benefits**:
  - Ensures consistent data validation and formatting across API responses.
  - Simplifies handling of different return types (tuple, dict, BaseModel) by abstracting common logic into a decorator.

- **Deviations**: 
  - The pattern deviates slightly from the standard where typically only one function is decorated. Here, it decorates another function that returns various data structures.
  - It handles multiple cases for result types (`tuple`, `dict`, `BaseModel`), making the logic more complex but also more flexible.

- **Appropriateness**:
  - This pattern is appropriate when you need to standardize API responses across a project, ensuring all outputs are validated and formatted consistently.
  - It’s particularly useful in web frameworks where consistent response handling is crucial for maintaining data integrity and ease of use.

---

*Generated by CodeWorm on 2026-02-21 23:59*
