# repository_pattern

**Type:** Pattern Analysis
**Repository:** my-portfolio
**File:** v1/backend/app/blog/service.py
**Language:** python
**Lines:** 1-109
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025
service.py
"""

from uuid import UUID

from sqlalchemy.ext.asyncio import AsyncSession

import config
from config import (
    BlogCategory,
    Language,
)
from core.exceptions import BlogNotFound
from .repository import BlogRepository
from .schemas import (
    BlogBriefResponse,
    BlogListResponse,
    BlogResponse,
)


class BlogService:
    """
    Business logic for blog operations.
    """
    def __init__(self, session: AsyncSession) -> None:
        self.session = session

    async def get_by_id(self, blog_id: UUID) -> BlogResponse:
        """
        Get blog post by ID.
        """
        blog = await BlogRepository.get_by_id(self.session, blog_id)
        if not blog:
            raise BlogNotFound(str(blog_id))
        return BlogResponse.model_validate(blog)

    async def list_visible(
        self,
        language: Language,
        skip: int = config.PAGINATION_DEFAULT_SKIP,
        limit: int = config.PAGINATION_DEFAULT_LIMIT,
    ) -> BlogListResponse:
        """
        List visible blog posts for a language.
        """
        blogs = await BlogRepository.get_visible_by_language(
            self.session,
            language,
            skip,
            limit,
        )
        total = await BlogRepository.count_visible_by_language(
            self.session,
            language,
        )
        return BlogListResponse(
            items = [BlogResponse.model_validate(b) for b in blogs],
            total = total,
            skip = skip,
            limit = limit,
        )

    async def list_featured(
        self,
        language: Language,
        limit: int = config.PAGINATION_FEATURED_LIMIT,
    ) -> list[BlogResponse]:
        """
        List featured blog posts for a language.
        Used for overview page highlights.
        """
        blogs = await BlogRepository.get_featured_by_language(
            self.session,
            language,
            limit,
        )
        return [BlogResponse.model_validate(b) for b in blogs]

    async def list_by_category(
        self,
        category: BlogCategory,
        language: Language,
    ) -> list[BlogResponse]:
        """
        List blog posts by category and language.
        """
        blogs = await BlogRepository.get_by_category_and_language(
            self.session,
            category,
            language,
        )
        return [BlogResponse.model_validate(b) for b in blogs]

    async def get_nav_items(
        self,
        language: Language,
    ) -> list[BlogBriefResponse]:
        """
        Get brief blog data for sidebar navigation.
        """
        blogs = await BlogRepository.get_visible_by_language(
            self.session,
            language,
        )
        return [BlogBriefResponse.model_validate(b) for b in blogs]

```

---

## Pattern Analysis

### Pattern Analysis

**Pattern Used:** Repository Pattern

**Implementation:**
The `BlogService` class interacts with a `BlogRepository` to perform various operations such as fetching blog posts by ID, listing visible blogs, and categorizing them. The repository handles the data access logic, while the service layer focuses on business logic.

```python
class BlogService:
    def __init__(self, session: AsyncSession) -> None:
        self.session = session

    async def get_by_id(self, blog_id: UUID) -> BlogResponse:
        blog = await BlogRepository.get_by_id(self.session, blog_id)
        if not blog:
            raise BlogNotFound(str(blog_id))
        return BlogResponse.model_validate(blog)

    # Other methods...
```

**Benefits:**
1. **Separation of Concerns:** The repository handles data access, while the service layer manages business logic.
2. **Testability:** Repositories can be easily mocked for unit testing.
3. **Flexibility:** Easier to change database technology or storage mechanism without affecting the service.

**Deviations:**
- The `BlogService` class does not implement a strict repository pattern, as it directly interacts with the session object rather than using an abstracted data access layer.
- The methods in `BlogService` return specific response models (`BlogResponse`, `BlogListResponse`, etc.), which is a deviation from the typical pattern where repositories return raw data.

**Appropriateness:**
This pattern is appropriate when you need to separate business logic from data access and ensure that your service layer remains clean and focused on high-level operations. However, the direct session interaction might make it less flexible if database changes are required in the future.

---

*Generated by CodeWorm on 2026-02-26 11:41*
