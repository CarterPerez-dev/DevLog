# factory

**Type:** Pattern Analysis
**Repository:** my-portfolio
**File:** v1/backend/app/factory.py
**Language:** python
**Lines:** 1-167
**Complexity:** 0.0

---

## Source Code

```python
"""
â’¸AngelaMos | 2025
factory.py
"""

from collections.abc import AsyncIterator
from contextlib import asynccontextmanager

from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse
from slowapi import _rate_limit_exceeded_handler
from slowapi.errors import RateLimitExceeded
from fastapi_rc import cachemanager

import config
from config import settings
from core.database import sessionmanager
from core.exceptions import BaseAppException
from core.logging import configure_logging
from core.rate_limit import limiter
from middleware.correlation import CorrelationIdMiddleware
from core.common_schemas import AppInfoResponse
from core.health_routes import router as health_router
from user.routes import router as user_router
from auth.routes import router as auth_router
from admin.routes import router as admin_router
from project.routes import router as project_router
from experience.routes import router as experience_router
from certification.routes import router as certification_router
from blog.routes import router as blog_router
from search.routes import router as search_router
from it_was_never_real import register_psyop_handler


@asynccontextmanager
async def lifespan(app: FastAPI) -> AsyncIterator[None]:
    """
    Application lifespan handler for startup and shutdown
    """
    configure_logging()
    sessionmanager.init(str(settings.DATABASE_URL))
    if settings.REDIS_URL:
        cachemanager.init(str(settings.REDIS_URL))
    yield
    if cachemanager.is_available:
        await cachemanager.close()
    await sessionmanager.close()


OPENAPI_TAGS = [
    {
        "name": "root",
        "description": "API information"
    },
    {
        "name": "health",
        "description": "Health check endpoints"
    },
    {
        "name": "projects",
        "description": "Portfolio projects"
    },
    {
        "name": "experiences",
        "description": "Work experience history"
    },
    {
        "name": "certifications",
        "description": "Professional certifications"
    },
    {
        "name": "blogs",
        "description": "External blog posts"
    },
    {
        "name": "search",
        "description": "Full-text search across portfolio content"
    },
    {
        "name": "auth",
        "description": "Authentication and authorization"
    },
    {
        "name": "users",
        "description": "User registration and profile management"
    },
    {
        "name": "admin",
        "description": "Admin only operations"
    },
]


def create_app() -> FastAPI:
    """
    Application factory
    """
    app = FastAPI(
        title = settings.APP_NAME,
        summary = settings.APP_SUMMARY,
        description = settings.APP_DESCRIPTION,
        version = settings.APP_VERSION,
        contact = {
            "name": settings.APP_CONTACT_NAME,
            "email": settings.APP_CONTACT_EMAIL,
        },
        license_info = {
            "name": 
```

---

## Pattern Analysis

### Pattern Analysis

**Pattern Used:** Factory Method

The `create_app` function in `factory.py` acts as a factory method, responsible for creating an instance of the `FastAPI` application with all its configurations and middleware initialized. This implementation follows the factory method pattern by providing a way to create objects (in this case, the FastAPI app) without specifying the exact class of object that will be created.

**Benefits:**
- **Decoupling:** The `create_app` function abstracts the creation process, making it easier to change or extend the application's configuration and behavior.
- **Flexibility:** It allows for easy addition of new routers or middleware by simply including them in the factory method without altering existing code.

**Deviations:**
- The pattern is slightly extended to include multiple router registrations and exception handlers. While this is not a deviation from the core pattern, it does add complexity.
- The `lifespan` manager is used to manage application startup and shutdown, which is an additional feature that enhances the factory method's utility.

**Appropriateness:**
This pattern is highly appropriate for initializing complex applications like FastAPI services. It ensures that all necessary components are set up in a consistent manner, making the codebase easier to maintain and extend.

---

*Generated by CodeWorm on 2026-02-26 11:09*
