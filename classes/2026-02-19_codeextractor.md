# CodeExtractor

**Type:** Class Documentation
**Repository:** CodeWorm
**File:** codeworm/analysis/parser.py
**Language:** python
**Lines:** 133-393
**Complexity:** 0.0

---

## Source Code

```python
class CodeExtractor:
    """
    Extracts functions and classes from parsed syntax trees
    """
    def __init__(self, source: str, language: CodeLanguage) -> None:
        """
        Initialize extractor with source code and language
        """
        self.source = source
        self.source_bytes = source.encode("utf-8")
        self.language = language
        self.tree = ParserManager.parse(source, language)

    def _node_text(self, node: Node) -> str:
        """
        Get the text content of a node
        """
        return self.source_bytes[node.start_byte : node.end_byte].decode("utf-8")

    def _get_docstring(self, node: Node) -> str | None:
        """
        Extract docstring from function or class body
        """
        if self.language != CodeLanguage.PYTHON:
            return None

        body = None
        for child in node.children:
            if child.type == "block":
                body = child
                break

        if not body or not body.children:
            return None

        first_stmt = body.children[0]
        if first_stmt.type == "expression_statement":
            expr = first_stmt.children[0] if first_stmt.children else None
            if expr and expr.type == "string":
                text = self._node_text(expr)
                text = text.strip('"').strip("'")
                return text

        return None

    def extract_functions(self) -> Iterator[ParsedFunction]:
        """
        Extract all functions from the source code
        """
        if self.language == CodeLanguage.PYTHON:
            yield from self._extract_python_functions()
        elif self.language in (CodeLanguage.TYPESCRIPT,
                               CodeLanguage.TSX,
                               CodeLanguage.JAVASCRIPT):
            yield from self._extract_js_functions()
        elif self.language == CodeLanguage.GO:
            yield from self._extract_go_functions()
        elif self.language == CodeLanguage.RUST:
            yield from self._extract_rust_functions()

    def _extract_python_functions(self) -> Iterator[ParsedFunction]:
        """
        Extract functions from Python source
        """
        def visit(node: Node,
                  class_name: str | None = None) -> Iterator[ParsedFunction]:
            if node.type == "class_definition":
                name_node = node.child_by_field_name("name")
                if name_node:
                    current_class = self._node_text(name_node)
                    for child in node.children:
                        yield from visit(child, current_class)
                return

            if node.type == "function_definition":
                name_node = node.child_by_field_name("name")
                params_node = node.child_by_field_name("parameters")

                if name_node:
                    name = self._node_text(name_node)
                    params = []
                    if params_node:
                        for param
```

---

## Class Documentation

### CodeExtractor Class Documentation

**Class Responsibility and Purpose:**
The `CodeExtractor` class is responsible for parsing source code to extract functions and classes, particularly focusing on Python, JavaScript/TypeScript, Go, and Rust languages. It leverages a syntax tree generated by a parser manager to identify and document relevant elements such as function definitions, class definitions, and their associated docstrings.

**Public Interface:**
- `__init__(source: str, language: CodeLanguage)`: Initializes the extractor with source code and specifies the programming language.
- `extract_functions() -> Iterator[ParsedFunction]`: Extracts all functions from the source code based on the specified language.
- `_node_text(node: Node) -> str`: Helper method to get the text content of a node.
- `_get_docstring(node: Node) -> str | None`: Extracts docstrings from function or class bodies, primarily for Python.

**Design Patterns Used:**
- **Strategy Pattern**: The `extract_functions` method delegates extraction logic based on the language using different strategies (`_extract_python_functions`, `_extract_js_functions`, etc.).
- **Visitor Pattern**: Implicitly used in `_extract_python_functions` and `_extract_js_functions` to traverse the syntax tree.

**Relationship to Other Classes:**
The `CodeExtractor` class interacts with the `ParserManager` for parsing source code into a syntax tree, which is then traversed by the extractor. It also works closely with the `ParsedFunction` class to store extracted function details.

This class plays a crucial role in the CodeWorm analysis module, providing foundational functionality for extracting and analyzing code structures from various programming languages.

---

*Generated by CodeWorm on 2026-02-19 12:41*
