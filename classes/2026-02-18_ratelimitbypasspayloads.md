# RateLimitBypassPayloads

**Type:** Class Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/api-security-scanner/backend/scanners/payloads.py
**Language:** python
**Lines:** 274-366
**Complexity:** 0.0

---

## Source Code

```python
class RateLimitBypassPayloads:
    """
    Rate limiting bypass techniques and patterns
    """

    HEADER_PATTERNS = {
        "limit":
        r"x-ratelimit-limit|x-rate-limit-limit|ratelimit-limit",
        "remaining":
        r"x-ratelimit-remaining|x-rate-limit-remaining|ratelimit-remaining",
        "reset":
        r"x-ratelimit-reset|x-rate-limit-reset|ratelimit-reset",
        "retry_after": r"retry-after",
    }

    ENDPOINT_VARIATIONS = [
        "/",
        "//",
        "/./",
        "/.",
        "/?",
        "/?dummy=1",
        "/?test=1",
        "/;",
        "/%2e",
        "/%00",
    ]

    HEADER_SPOOFING = [
        {
            "X-Forwarded-For": "127.0.0.1"
        },
        {
            "X-Forwarded-For": "8.8.8.8"
        },
        {
            "X-Real-IP": "127.0.0.1"
        },
        {
            "X-Originating-IP": "127.0.0.1"
        },
        {
            "X-Remote-IP": "127.0.0.1"
        },
        {
            "X-Client-IP": "127.0.0.1"
        },
        {
            "CF-Connecting-IP": "127.0.0.1"
        },
        {
            "True-Client-IP": "127.0.0.1"
        },
    ]

    USER_AGENT_ROTATION = [
        "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
        "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",
        "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36",
        "Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15",
        "curl/7.64.1",
        "python-requests/2.31.0",
    ]

    @classmethod
    def get_bypass_headers(cls) -> list[dict[str, str]]:
        """
        Get rate limit bypass header combinations

        Returns:
            list[dict[str, str]]: Header combinations for testing
        """
        return cls.HEADER_SPOOFING

    @classmethod
    def get_header_patterns(cls) -> dict[str, str]:
        """
        Get rate limit header detection patterns

        Returns:
            dict[str, str]: Regex patterns for rate limit headers
        """
        return cls.HEADER_PATTERNS

    @classmethod
    def get_endpoint_variations(cls) -> list[str]:
        """
        Get endpoint variations for bypass testing

        Returns:
            list[str]: Endpoint path variations
        """
        return cls.ENDPOINT_VARIATIONS
```

---

## Class Documentation

### RateLimitBypassPayloads Documentation

**Class Responsibility and Purpose:**
The `RateLimitBypassPayloads` class is designed to provide a collection of techniques and patterns for bypassing rate limits on API endpoints, enhancing an API security scanner's capabilities by simulating various header spoofing and endpoint variations.

**Public Interface (Key Methods):**
- **get_bypass_headers()**: Returns a list of header combinations used for testing.
- **get_header_patterns()**: Provides regex patterns to detect common rate limit headers.
- **get_endpoint_variations()**: Returns a list of endpoint path variations for bypass testing.

**Design Patterns Used:**
The class leverages the **Strategy Pattern** through its methods, allowing different strategies (header spoofing and endpoint variations) to be applied dynamically. It also uses **Factory Method** by providing factory-like methods that return predefined sets of payloads without tightly coupling clients with their creation logic.

**How it Fits in the Architecture:**
This class is part of a larger API security scanner framework, where it serves as a utility module for generating and applying bypass techniques. Its methods are intended to be called by higher-level components responsible for executing security tests against APIs. By abstracting the specific payloads and patterns, this class promotes flexibility and maintainability in the overall architecture.

---

*Generated by CodeWorm on 2026-02-18 11:02*
