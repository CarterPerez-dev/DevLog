# NotificationBatch

**Type:** Class Documentation
**Repository:** CertGames-Core
**File:** backend/app/clients/webhooks.py
**Language:** python
**Lines:** 283-319
**Complexity:** 0.0

---

## Source Code

```python
class NotificationBatch:
    """
    Batch multiple notifications to reduce noise
    """
    def __init__(self):
        self.notifications: list[dict] = []

    def add(
        self,
        notification_type: NotificationType,
        title: str,
        message: str,
        **kwargs
    ):
        self.notifications.append(
            {
                "type": notification_type,
                "title": title,
                "message": message,
                **kwargs
            }
        )

    def send(self):
        if not admin_notifier or not self.notifications:
            return

        admin_notifier.send_notification(
            NotificationType.DAILY_SUMMARY,
            f"{len(self.notifications)} Updates",
            "Tap to view all notifications",
            priority = "normal",
            data = {"batch": self.notifications},
            badge_increment = len(self.notifications)
        )

        self.notifications.clear()
```

---

## Class Documentation

### NotificationBatch Class Documentation

**Class Responsibility and Purpose:**
The `NotificationBatch` class is designed to batch multiple notifications, reducing noise by sending them as a single message when conditions are met. This approach ensures that users receive fewer but more relevant updates.

**Public Interface (Key Methods):**
- **`__init__()`**: Initializes an empty list to store notifications.
- **`add(notification_type: NotificationType, title: str, message: str, **kwargs)`**: Adds a notification to the batch with specified type, title, and message. Additional keyword arguments can be passed for custom fields.
- **`send()`**: Sends a single notification containing all accumulated messages if certain conditions are met (e.g., an admin notifier is available). It then clears the batch.

**Design Patterns Used:**
This class does not explicitly use any design patterns but follows Pythonic practices. The `add` method allows for flexible additional keyword arguments, making it adaptable to various scenarios.

**Relationship to Other Classes:**
- **AdminNotifier**: This class interacts with `NotificationBatch` through its `send_notification` method when conditions are met.
- **Notifications**: Notifications are stored in a list and managed by the `NotificationBatch`.

**State Management Approach:**
The state of the batch is managed using an internal list (`self.notifications`). The `add` method appends new notifications, while the `send` method clears this list after sending.

This class fits into the architecture by providing a mechanism to aggregate and send multiple notifications efficiently, reducing server load and improving user experience.

---

*Generated by CodeWorm on 2026-02-18 15:03*
