# PartnerRepository

**Type:** Class Documentation
**Repository:** ios-test
**File:** fastapi/app/partner/repository.py
**Language:** python
**Lines:** 16-63
**Complexity:** 0.0

---

## Source Code

```python
class PartnerRepository(BaseRepository[Partner]):
    """
    Database operations for Partner model
    """
    model = Partner

    @classmethod
    async def get_by_user_id(
        cls,
        session: AsyncSession,
        user_id: UUID,
    ) -> Partner | None:
        """
        Get partner by user ID (one partner per user)
        """
        result = await session.execute(
            select(Partner).where(Partner.user_id == user_id)
        )
        return result.scalars().first()

    @classmethod
    async def exists_for_user(
        cls,
        session: AsyncSession,
        user_id: UUID,
    ) -> bool:
        """
        Check if partner exists for user
        """
        result = await session.execute(
            select(Partner.id).where(Partner.user_id == user_id)
        )
        return result.scalars().first() is not None

    @classmethod
    async def update_last_period(
        cls,
        session: AsyncSession,
        partner: Partner,
        last_period_start: date,
    ) -> Partner:
        """
        Update last period start date
        """
        partner.last_period_start = last_period_start
        await session.flush()
        await session.refresh(partner)
        return partner
```

---

## Class Documentation

### PartnerRepository Documentation

**Class Responsibility and Purpose:**
The `PartnerRepository` class is responsible for handling database operations related to the `Partner` model. It provides a layer of abstraction over SQLAlchemy sessions, enabling efficient querying and updating of partner records.

**Public Interface (Key Methods):**
- `get_by_user_id(session: AsyncSession, user_id: UUID) -> Partner | None`: Retrieves a partner associated with a given user ID.
- `exists_for_user(session: AsyncSession, user_id: UUID) -> bool`: Checks if a partner exists for the specified user ID.
- `update_last_period(session: AsyncSession, partner: Partner, last_period_start: date) -> Partner`: Updates the `last_period_start` attribute of an existing partner.

**Design Patterns Used:**
The class employs the **Repository Pattern**, which encapsulates data access logic and provides a clean interface for interacting with database records. This pattern is particularly useful in maintaining separation between business logic and data storage concerns.

**How it Fits in the Architecture:**
In the architecture, `PartnerRepository` acts as an intermediary layer between the application's domain logic and the database. It ensures that all database operations are performed through a consistent interface, promoting modularity and testability. The use of async methods (`async def`) aligns with FastAPI's asynchronous capabilities, optimizing performance in web applications.

This class is part of the `ios-test` project, specifically located in `/home/yoshi/dev/ios-test/fastapi/app/partner/repository.py`.

---

*Generated by CodeWorm on 2026-02-19 09:28*
