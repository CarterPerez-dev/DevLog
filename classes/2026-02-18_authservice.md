# AuthService

**Type:** Class Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/api-security-scanner/backend/services/auth_service.py
**Language:** python
**Lines:** 27-115
**Complexity:** 0.0

---

## Source Code

```python
class AuthService:
    """
    User registration, login, and token generation
    """

    @staticmethod
    def register_user(db: Session, user_data: UserCreate) -> UserResponse:
        """
        Register a new user

        Args:
            db: Database session
            user_data: User registration data

        Returns:
            UserResponse: Created user data
        """
        existing_user = UserRepository.get_by_email(db, user_data.email)
        if existing_user:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="Email already registered",
            )

        hashed_password = hash_password(user_data.password)

        user = UserRepository.create_user(
            db=db,
            email=user_data.email,
            hashed_password=hashed_password,
        )

        return UserResponse.model_validate(user)

    @staticmethod
    def login_user(db: Session, login_data: UserLogin) -> TokenResponse:
        """
        Authenticate user and generate access token

        Args:
            db: Database session
            login_data: User login credentials

        Returns:
            TokenResponse: JWT access token
        """
        user = UserRepository.get_by_email(db, login_data.email)

        if not user:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Invalid email or password",
            )

        if not verify_password(login_data.password, user.hashed_password):
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Invalid email or password",
            )

        if not user.is_active:
            raise HTTPException(
                status_code=status.HTTP_403_FORBIDDEN,
                detail="Account is inactive",
            )

        access_token = create_access_token(
            data={"sub": user.email},
            expires_delta=timedelta(minutes=settings.ACCESS_TOKEN_EXPIRE_MINUTES),
        )

        return TokenResponse(access_token=access_token, token_type="bearer")

    @staticmethod
    def get_user_by_email(db: Session, email: str) -> UserResponse | None:
        """
        Get user by email address

        Args:
            db: Database session
            email: User email

        Returns:
            UserResponse | None: User data or None if not found
        """
        user = UserRepository.get_by_email(db, email)
        if user:
            return UserResponse.model_validate(user)
        return None
```

---

## Class Documentation

### AuthService Documentation

**Class Responsibility and Purpose**
The `AuthService` class is responsible for handling user registration, login, and token generation within the application. It ensures that users can securely create accounts, log in, and receive JWT access tokens.

**Public Interface (Key Methods)**
- **register_user**: Registers a new user by validating input data, hashing passwords, and saving to the database.
- **login_user**: Authenticates a user based on email and password, checks account status, and generates an access token.
- **get_user_by_email**: Retrieves a user's details from the database using their email address.

**Design Patterns Used**
The class uses the **Factory Method** pattern for creating users through `UserRepository.create_user`. It also employs validation patterns to ensure input data is correct before processing.

**How it Fits in the Architecture**
`AuthService` acts as a service layer that interacts with the database via `UserRepository` and handles business logic related to user authentication. This separation ensures that the core application logic remains clean and modular, making the system easier to maintain and extend. The class interfaces with other services and repositories, providing a clear and focused responsibility for managing user sessions and credentials.

---

*Generated by CodeWorm on 2026-02-18 11:21*
