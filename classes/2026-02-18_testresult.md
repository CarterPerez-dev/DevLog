# TestResult

**Type:** Class Documentation
**Repository:** Cybersecurity-Projects
**File:** PROJECTS/intermediate/api-security-scanner/backend/models/TestResult.py
**Language:** python
**Lines:** 24-90
**Complexity:** 0.0

---

## Source Code

```python
class TestResult(BaseModel):
    """
    Stores individual test results for each security scan
    """

    __tablename__ = "test_results"

    scan_id = Column(
        Integer,
        ForeignKey("scans.id",
                   ondelete = "CASCADE"),
        nullable = False,
        index = True,
    )
    test_name = Column(
        Enum(TestType),
        nullable = False,
        index = True,
    )
    status = Column(
        Enum(ScanStatus),
        nullable = False,
        index = True,
    )
    severity = Column(
        Enum(Severity),
        nullable = False,
        index = True,
    )
    details = Column(Text, nullable = False)
    evidence_json = Column(JSON, nullable = False, default = dict)
    recommendations_json = Column(
        JSON,
        nullable = False,
        default = list
    )

    scan = relationship("Scan", back_populates = "test_results")

    def __repr__(self) -> str:
        """
        String representation of TestResult
        """
        return (
            f"<TestResult(id={self.id}, test_name={self.test_name.value}, "
            f"status={self.status.value})>"
        )

    @property
    def is_vulnerable(self) -> bool:
        """
        Check if this test result indicates a vulnerability

        Returns:
            bool: True if status is vulnerable
        """
        return self.status == ScanStatus.VULNERABLE

    @property
    def is_high_severity(self) -> bool:
        """
        Check if this is a high severity vulnerability

        Returns:
            bool: True if severity is high
        """
        return self.severity == Severity.HIGH
```

---

## Class Documentation

### TestResult Class Documentation

**Class Responsibility and Purpose:**
The `TestResult` class is responsible for storing individual test results from security scans. It captures essential details such as the scan ID, test name, status, severity, and additional information like evidence and recommendations.

**Public Interface (Key Methods):**
- **__tablename__: "test_results"**: Defines the database table associated with this model.
- **scan_id: Integer**: Foreign key linking to the `Scan` entity.
- **test_name: Enum(TestType)**: The name of the security test performed.
- **status: Enum(ScanStatus)**: The status of the test (e.g., VULNERABLE, PASSED).
- **severity: Enum(Severity)**: The severity level of the vulnerability detected.
- **details: Text**: Additional details about the test result.
- **evidence_json: JSON**: JSON representation of evidence related to the test result.
- **recommendations_json: JSON**: JSON recommendations for mitigating the issue.
- **__repr__: str**: Provides a string representation of the `TestResult` object, useful for debugging and logging.
- **is_vulnerable: bool**: Checks if the test result indicates a vulnerability.
- **is_high_severity: bool**: Determines if the severity level is high.

**Design Patterns Used:**
The class leverages Python's built-in `Enum` to define the status and severity of tests, ensuring type safety. It also uses SQLAlchemy ORM for database interaction through the `__tablename__`, `scan_id`, and relationships with other models like `Scan`.

**How it Fits in the Architecture:**
In the overall architecture, `TestResult` acts as a data model within the backend API security scanner application. It is part of the data layer that interacts with the database to store and retrieve test results. The class is related to the `Scan` model through a one-to-many relationship, where each scan can have multiple test results. This design ensures that all relevant details about each security test are captured and managed efficiently.

---

*Generated by CodeWorm on 2026-02-18 11:45*
