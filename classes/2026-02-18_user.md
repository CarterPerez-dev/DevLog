# User

**Type:** Class Documentation
**Repository:** fullstack-template
**File:** stacks/fastapi-react/backend/app/user/User.py
**Language:** python
**Lines:** 34-75
**Complexity:** 0.0

---

## Source Code

```python
class User(Base, UUIDMixin, TimestampMixin):
    """
    User account model
    """
    __tablename__ = "users"

    email: Mapped[str] = mapped_column(
        String(EMAIL_MAX_LENGTH),
        unique = True,
        index = True,
    )
    hashed_password: Mapped[str] = mapped_column(
        String(PASSWORD_HASH_MAX_LENGTH)
    )

    full_name: Mapped[str | None] = mapped_column(
        String(FULL_NAME_MAX_LENGTH),
        default = None,
    )

    is_active: Mapped[bool] = mapped_column(default = True)
    is_verified: Mapped[bool] = mapped_column(default = False)

    role: Mapped[UserRole] = mapped_column(
        SafeEnum(UserRole,
                 unknown_value = UserRole.UNKNOWN),
        default = UserRole.USER,
    )

    token_version: Mapped[int] = mapped_column(default = 0)

    refresh_tokens: Mapped[list[RefreshToken]] = relationship(
        back_populates = "user",
        cascade = "all, delete-orphan",
        lazy = "raise",
    )

    def increment_token_version(self) -> None:
        """
        Invalidate all existing tokens for this user
        """
        self.token_version += 1
```

---

## Class Documentation

### User Class Documentation

**Class Responsibility and Purpose:**
The `User` class models a user account within the application, adhering to the Single Responsibility Principle by focusing solely on representing user data and behavior. It integrates with SQLAlchemy for database interactions.

**Public Interface (Key Methods):**
- **increment_token_version()**: Increments the token version to invalidate all existing tokens associated with the user.

**Design Patterns Used:**
The class leverages:
- **Mixins (`Base`, `UUIDMixin`, `TimestampMixin`)**: These mixins provide common functionality such as unique identifiers and timestamping, promoting code reuse.
- **Database ORM (SQLAlchemy Mapped Columns)**: The use of SQLAlchemy's `mapped_column` for defining database columns ensures a clean separation between the model and the database schema.

**Relationship to Other Classes:**
The `User` class has a relationship with the `RefreshToken` class through a one-to-many association. This relationship is managed via the `refresh_tokens` attribute, which uses SQLAlchemy's `relationship` method to handle cascading operations like token deletion when a user is deleted.

**State Management Approach:**
The class manages various states such as `email`, `hashed_password`, and `is_active`. These attributes are mapped directly to database columns with appropriate constraints (e.g., unique email, hashed password). The `increment_token_version` method ensures state changes that affect token management are handled efficiently.

---

*Generated by CodeWorm on 2026-02-18 15:55*
