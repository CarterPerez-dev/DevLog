# User

**Type:** Class Documentation
**Repository:** my-portfolio
**File:** v1/backend/app/user/User.py
**Language:** python
**Lines:** 32-73
**Complexity:** 0.0

---

## Source Code

```python
class User(Base, UUIDMixin, TimestampMixin):
    """
    User account model
    """
    __tablename__ = "users"

    email: Mapped[str] = mapped_column(
        String(config.EMAIL_MAX_LENGTH),
        unique = True,
        index = True,
    )
    hashed_password: Mapped[str] = mapped_column(
        String(config.PASSWORD_HASH_MAX_LENGTH)
    )

    full_name: Mapped[str | None] = mapped_column(
        String(config.FULL_NAME_MAX_LENGTH),
        default = None,
    )

    is_active: Mapped[bool] = mapped_column(default = True)
    is_verified: Mapped[bool] = mapped_column(default = False)

    role: Mapped[UserRole] = mapped_column(
        SafeEnum(UserRole,
                 unknown_value = UserRole.UNKNOWN),
        default = UserRole.USER,
    )

    token_version: Mapped[int] = mapped_column(default = 0)

    refresh_tokens: Mapped[list[RefreshToken]] = relationship(
        back_populates = "user",
        cascade = "all, delete-orphan",
        lazy = "raise",
    )

    def increment_token_version(self) -> None:
        """
        Invalidate all existing tokens for this user
        """
        self.token_version += 1
```

---

## Class Documentation

### User Class Documentation

**Class Responsibility and Purpose:**
The `User` class models a user account within the application, adhering to the SQLAlchemy ORM pattern for database interaction. It encapsulates essential attributes such as email, password hash, full name, active status, verification status, role, and refresh tokens.

**Public Interface (Key Methods):**
- **increment_token_version()**: Increments the token version, invalidating all existing tokens associated with this user.

**Design Patterns Used:**
The class leverages several design patterns:
- **Single Responsibility Principle**: The `User` class is responsible for managing a user's account details and related metadata.
- **Active Record Pattern**: By inheriting from SQLAlchemy base classes (`Base`, `UUIDMixin`, `TimestampMixin`), the class manages its own persistence.

**Relationship to Other Classes:**
The `User` class has a relationship with the `RefreshToken` class through a one-to-many association. This allows for tracking and invalidating tokens when necessary.

**State Management Approach:**
The state of the user is managed by various attributes, including email, password hash, full name, active status, verification status, role, and token version. The use of SQLAlchemy's `mapped_column` ensures that these states are persisted in the database.

This class fits into the architecture as a core entity, providing essential functionality for user management and security within the application.

---

*Generated by CodeWorm on 2026-02-18 22:29*
