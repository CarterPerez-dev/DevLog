# UserService

**Type:** Class Documentation
**Repository:** Cybersecurity-Projects
**File:** TEMPLATES/fullstack-template/examples/minimal-production/backend/app/user/service.py
**Language:** python
**Lines:** 28-94
**Complexity:** 0.0

---

## Source Code

```python
class UserService:
    """
    Business logic for user operations
    """
    def __init__(self, session: AsyncSession) -> None:
        self.session = session

    async def create_user(
        self,
        user_data: UserCreate,
    ) -> UserResponse:
        """
        Register a new user
        """
        if await UserRepository.email_exists(self.session,
                                             user_data.email):
            raise EmailAlreadyExists(user_data.email)

        hashed = await hash_password(user_data.password)
        user = await UserRepository.create_user(
            self.session,
            email = user_data.email,
            hashed_password = hashed,
        )
        return UserResponse.model_validate(user)

    async def get_user_by_id(
        self,
        user_id: UUID,
    ) -> UserResponse:
        """
        Get user by ID
        """
        user = await UserRepository.get_by_id(self.session, user_id)
        if not user:
            raise UserNotFound(str(user_id))
        return UserResponse.model_validate(user)

    async def change_password(
        self,
        user: User,
        current_password: str,
        new_password: str,
    ) -> None:
        """
        Change user password
        """
        is_valid, _ = await verify_password(current_password, user.hashed_password)
        if not is_valid:
            raise InvalidCredentials()

        hashed = await hash_password(new_password)
        await UserRepository.update_password(self.session, user, hashed)

    async def deactivate_user(
        self,
        user: User,
    ) -> UserResponse:
        """
        Deactivate user account
        """
        updated = await UserRepository.update(
            self.session,
            user,
            is_active = False
        )
        return UserResponse.model_validate(updated)
```

---

## Class Documentation

### UserService Documentation

**Class Responsibility and Purpose:**
The `UserService` class handles all business logic related to user operations within the application, including creating new users, retrieving user details by ID, changing passwords, and deactivating user accounts.

**Public Interface (Key Methods):**
- **create_user(user_data: UserCreate) -> UserResponse:** Registers a new user with provided data.
- **get_user_by_id(user_id: UUID) -> UserResponse:** Retrieves a user by their unique identifier.
- **change_password(user: User, current_password: str, new_password: str) -> None:** Updates a user's password if the current password is valid.
- **deactivate_user(user: User) -> UserResponse:** Deactivates an existing user account.

**Design Patterns Used:**
The class employs the **Repository Pattern** for data access, ensuring that business logic remains separate from database operations. The `UserRepository` handles all database interactions, while `UserService` focuses on application-specific logic.

**How it Fits in the Architecture:**
`UserService` acts as a service layer between the repository and the controller or client. It encapsulates user-related operations, making the code more modular and easier to maintain. By leveraging asynchronous methods (`async def`), the class supports efficient handling of I/O-bound tasks without blocking the event loop.

This design promotes separation of concerns, enhances testability, and facilitates future changes in either the business logic or data access layer.

---

*Generated by CodeWorm on 2026-02-18 11:01*
