# DescriptionAuditor

**Type:** Class Documentation
**Repository:** vuemantics
**File:** backend/core/validators/description.py
**Language:** python
**Lines:** 24-339
**Complexity:** 0.0

---

## Source Code

```python
class DescriptionAuditor:
    """
    Audits AI-generated descriptions for quality and sanity.
    Returns confidence score 0-100 and list of issues found.
    """

    BAD_TOKEN_PATTERNS: ClassVar[list[str]] = [
        "<|",
        "|>",
    ]

    @classmethod
    def audit(cls, description: str) -> AuditResult:
        """
        Audit a description and return score + issues.
        Score is 0-100, higher is better.
        """
        score = 100
        issues: list[str] = []

        if not description or not description.strip():
            return AuditResult(
                score = 0,
                issues = ["Empty description"],
                passed = False
            )

        text = description.strip()

        score, issues = cls._check_complete_garbage(text, score, issues)
        score, issues = cls._check_bad_tokens(text, score, issues)
        score, issues = cls._check_length(text, score, issues)
        score, issues = cls._check_word_diversity(text, score, issues)
        score, issues = cls._check_consecutive_repeats(text, score, issues)
        score, issues = cls._check_gibberish_ratio(text, score, issues)
        score, issues = cls._check_sentence_structure(text, score, issues)
        score, issues = cls._check_common_words(text, score, issues)

        final_score = max(0, score)
        passed = final_score >= config.DESCRIPTION_AUDIT_PASS_THRESHOLD

        return AuditResult(
            score = final_score,
            issues = issues,
            passed = passed
        )

    @classmethod
    def _check_complete_garbage(cls,
                                text: str,
                                score: int,
                                issues: list[str]) -> tuple[int,
                                                            list[str]]:
        """
        Check if description is complete garbage (mostly random special chars).
        This catches catastrophic AI failures that produce gibberish.
        """
        if len(text) == 0:
            return score, issues

        # Check alpha ratio
        alphabetic = sum(1 for c in text if c.isalpha())
        alpha_ratio = alphabetic / len(text)

        if alpha_ratio < 0.3:
            score -= 70
            issues.append(
                f"Complete garbage: only {alpha_ratio:.1%} alphabetic characters"
            )
            return score, issues

        # Check for random character sequences (e.g., "4#2>*)=-C4>8B")
        # Real text doesn't mix letters, numbers, and special chars randomly
        tokens = re.findall(r'[^\s]+', text)
        garbage_tokens = 0

        for token in tokens[:100]:  # Check first 100 tokens
            # Count different character types
            letters = sum(1 for c in token if c.isalpha())
            digits = sum(1 for c in token if c.isdigit())
            special = sum(1 for c in token if not c.isalnum())

            # If token has all three types and is short, it's likely garbage
            if len(
```

---

## Class Documentation

### DescriptionAuditor

**Class Responsibility and Purpose:**
The `DescriptionAuditor` class is responsible for auditing AI-generated descriptions to ensure they are of high quality and free from issues such as gibberish, incomplete content, and poor sentence structure. It returns a confidence score (0-100) along with a list of identified issues.

**Public Interface:**
- **audit(description: str) -> AuditResult:** This method audits the provided description and returns an `AuditResult` object containing the final score and a list of issues.
  
**Design Patterns Used:**
The class employs several design patterns:
- **Strategy Pattern:** The `_check_*` methods are strategies for different types of checks, allowing for flexible and extensible quality assessment.
- **Factory Method:** Implicitly used through the `audit` method which creates an instance of `AuditResult`.

**Relationship to Other Classes:**
This class interacts with other validation classes or configurations defined in the repository. It is part of a broader system that ensures AI-generated content meets specific quality standards before being used.

**State Management Approach:**
The class maintains state through local variables (`score`, `issues`) during the audit process, ensuring all checks are performed sequentially and results are accumulated appropriately. The final score and issues list are returned at the end of the method.

---

*Generated by CodeWorm on 2026-02-19 02:22*
