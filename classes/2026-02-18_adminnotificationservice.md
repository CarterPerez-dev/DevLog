# AdminNotificationService

**Type:** Class Documentation
**Repository:** CertGames-Core
**File:** backend/app/clients/webhooks.py
**Language:** python
**Lines:** 31-90
**Complexity:** 0.0

---

## Source Code

```python
class AdminNotificationService:
    """
    Service to send push notifications to iOS Admin App
    Future implementation for my custom admin panel iOS app
    """
    def __init__(self, webhook_url: str, api_key: str = None):
        self.webhook_url = webhook_url
        self.api_key = api_key
        self.enabled = bool(webhook_url)

    def send_notification(
        self,
        notification_type: NotificationType,
        title: str,
        message: str,
        *,
        priority: str = "normal",
        data: dict[str,
                   Any] = None,
        badge_increment: int = 1
    ) -> bool:
        """
        Send notification to iOS admin app
        """
        if not self.enabled:
            return False

        payload = {
            "type": notification_type.value,
            "title": title,
            "body": message,
            "priority": priority,
            "timestamp": datetime.now(UTC).isoformat(),
            "badge_increment": badge_increment,
            "data": data or {},
            "sound":
            "critical.caf" if priority == "critical" else "default"
        }

        headers = {
            "Content-Type": "application/json",
        }

        if self.api_key:
            headers["Authorization"] = f"Bearer {self.api_key}"

        try:
            response = requests.post(
                self.webhook_url,
                json = payload,
                headers = headers,
                timeout = 5
            )
            return response.status_code in [200, 201, 204]
        except Exception as e:  # pylint: disable=broad-exception-caught
            current_app.logger.error(
                "Failed to send admin notification: %s",
                str(e)
            )
            return False
```

---

## Class Documentation

### AdminNotificationService

**Class Responsibility and Purpose:**
The `AdminNotificationService` class is responsible for sending push notifications to an iOS admin app via a webhook URL. It encapsulates the logic required to construct and send notification payloads, ensuring that only enabled services can send notifications.

**Public Interface (Key Methods):**
- **Constructor (`__init__`)**: Initializes the service with a `webhook_url` and optional `api_key`. Sets the `enabled` state based on whether a valid URL is provided.
- **`send_notification`**: Sends a notification to the iOS admin app. Accepts parameters such as `notification_type`, `title`, `message`, and additional metadata like `priority` and `data`.

**Design Patterns Used:**
The class does not explicitly use any design patterns, but it follows Pythonic practices by using type hints for method parameters and return values.

**How It Fits in the Architecture:**
This service is part of a broader system where custom admin panels interact with backend services. The `AdminNotificationService` acts as an intermediary between the application logic and the external webhook endpoint, ensuring that notifications are sent reliably and securely. Its state management approach ensures that only enabled services can send notifications, which helps maintain the integrity of the notification system.

---

*Generated by CodeWorm on 2026-02-18 15:11*
