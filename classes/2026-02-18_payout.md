# Payout

**Type:** Class Documentation
**Repository:** stripe-referral
**File:** src/stripe_referral/models/Payout.py
**Language:** python
**Lines:** 45-109
**Complexity:** 0.0

---

## Source Code

```python
class Payout(Base, TimestampMixin):
    """
    Payout record for referral rewards
    """
    __tablename__ = "payouts"

    id: Mapped[int] = mapped_column(
        primary_key = True,
        autoincrement = True
    )

    user_id: Mapped[str] = mapped_column(
        String(MAX_USER_ID_LENGTH),
        index = True
    )
    tracking_id: Mapped[int] = mapped_column(
        ForeignKey("referral_trackings.id"),
        nullable = False,
        unique = True
    )

    amount: Mapped[float] = mapped_column(Float, nullable = False)
    currency: Mapped[str] = mapped_column(
        String(3),
        default = CurrencyCode.USD.value
    )

    status: Mapped[str] = mapped_column(
        String(20),
        default = PayoutStatus.PENDING.value,
        index = True
    )

    adapter_type: Mapped[str] = mapped_column(
        String(50),
        nullable = False
    )
    recipient_data: Mapped[dict[str,
                                Any]] = mapped_column(
                                    JSON,
                                    default = dict
                                )

    processed_at: Mapped[datetime | None] = mapped_column(
        DateTime(timezone = True),
        nullable = True
    )
    failed_at: Mapped[datetime | None] = mapped_column(
        DateTime(timezone = True),
        nullable = True
    )

    external_transaction_id: Mapped[str | None] = mapped_column(
        String(MAX_TRANSACTION_ID_LENGTH),
        nullable = True
    )
    error_message: Mapped[str | None] = mapped_column(
        String(MAX_ERROR_MESSAGE_LENGTH),
        nullable = True
    )

    tracking: Mapped[ReferralTracking] = relationship(
        "ReferralTracking",
        back_populates = "payout"
    )
```

---

## Class Documentation

### Payout Class Documentation

**Class Responsibility and Purpose:**
The `Payout` class models a record for referral rewards payouts. It tracks various attributes such as user ID, tracking ID, amount, currency, status, adapter type, and transaction details.

**Public Interface (Key Methods):**
- No public methods are defined in the class itself; all interactions with this class would be through its attributes.
- Key attributes include `id`, `user_id`, `tracking_id`, `amount`, `currency`, `status`, `adapter_type`, `recipient_data`, and relationships like `tracking`.

**Design Patterns Used:**
The class leverages SQLAlchemy ORM patterns for database interaction, specifically using mapped columns to define the schema. There is no explicit use of design patterns such as Factory, Observer, or Strategy.

**How It Fits in the Architecture:**
`Payout` is part of the data model layer and interacts with the `ReferralTracking` class through a relationship. This class is designed to be used by services that handle payout processing, tracking, and status updates. The `status` attribute indicates whether the payout has been processed or failed, which helps in managing the state of each payout record.

The use of foreign keys and relationships ensures data integrity with other models like `ReferralTracking`. The class also supports JSON storage for dynamic recipient data, making it flexible to accommodate varying recipient information.

---

*Generated by CodeWorm on 2026-02-18 23:55*
