# BaseRepository

**Type:** Class Documentation
**Repository:** stripe-referral
**File:** src/stripe_referral/repositories/base.py
**Language:** python
**Lines:** 20-83
**Complexity:** 0.0

---

## Source Code

```python
class BaseRepository(Generic[T]):
    """
    Base repository with common CRUD operations
    """
    def __init__(self, db: Session, model: type[T]) -> None:
        """
        Initialize repository with database session and model type
        """
        self.db = db
        self.model = model

    def create(self, **kwargs: Any) -> T:
        """
        Create a new record
        """
        instance = self.model(**kwargs)
        self.db.add(instance)
        self.db.commit()
        self.db.refresh(instance)
        return instance

    def get_by_id(self, record_id: int) -> T | None:
        """
        Get record by ID
        """
        return self.db.get(self.model, record_id)

    def get_all(self,
                limit: int | None = None,
                offset: int = 0) -> list[T]:
        """
        Get all records with pagination
        """
        stmt = select(self.model).offset(offset)
        if limit:
            stmt = stmt.limit(limit)
        return list(self.db.execute(stmt).scalars().all())

    def update(self, record_id: int, **kwargs: Any) -> T | None:
        """
        Update record by ID
        """
        instance = self.get_by_id(record_id)
        if not instance:
            return None

        for key, value in kwargs.items():
            setattr(instance, key, value)

        self.db.commit()
        self.db.refresh(instance)
        return instance

    def delete(self, record_id: int) -> bool:
        """
        Delete record by ID
        """
        instance = self.get_by_id(record_id)
        if not instance:
            return False

        self.db.delete(instance)
        self.db.commit()
        return True
```

---

## Class Documentation

### BaseRepository Documentation

**Class Responsibility and Purpose:**
The `BaseRepository` class serves as a generic base for CRUD operations, providing common functionality to interact with database records using SQLAlchemy sessions. It encapsulates basic data access logic, ensuring consistency across repositories.

**Public Interface (Key Methods):**
- **`create(**kwargs: Any) -> T:`**: Creates a new record.
- **`get_by_id(record_id: int) -> T | None:`**: Retrieves a record by its ID.
- **`get_all(limit: int | None = None, offset: int = 0) -> list[T]:`**: Fetches all records with optional pagination.
- **`update(record_id: int, **kwargs: Any) -> T | None:`**: Updates an existing record by ID.
- **`delete(record_id: int) -> bool:`**: Deletes a record by its ID.

**Design Patterns Used:**
The class employs the **Strategy Pattern** through generic type parameters (`T`) to support various model types. It also follows the **Repository Pattern**, abstracting database interactions and providing a clean interface for business logic.

**How it Fits in the Architecture:**
`BaseRepository` is part of the data access layer, designed to be extended by specific repository classes tailored to different models (e.g., `UserRepository`, `ReferralRepository`). This abstraction allows for consistent CRUD operations across the application while maintaining a clear separation between business logic and database interactions.

---

*Generated by CodeWorm on 2026-02-18 22:54*
