# SearchRequest

**Type:** Class Documentation
**Repository:** vuemantics
**File:** backend/schemas/search.py
**Language:** python
**Lines:** 30-107
**Complexity:** 0.0

---

## Source Code

```python
class SearchRequest(BaseModel):
    """
    Semantic search request with advanced filtering options
    """
    model_config = ConfigDict(
        extra = "forbid",
        str_strip_whitespace = True,
    )

    query: str = Field(
        description = "Natural language search query",
        min_length = 1,
        max_length = MAX_QUERY_LENGTH,
    )

    limit: int = Field(
        default = DEFAULT_PAGE_SIZE,
        ge = 1,
        le = MAX_PAGE_SIZE,
        description = "Maximum number of results"
    )

    similarity_threshold: float = Field(
        default = SEARCH_DEFAULT_SIMILARITY_THRESHOLD,
        ge = 0.0,
        le = 1.0,
        description = "Minimum similarity score (0-1)"
    )

    file_types: list[FileType] | None = Field(
        default = None,
        description = "Filter by file types (None = all types)"
    )

    date_from: datetime | None = Field(
        default = None,
        description = "Filter uploads created after this date"
    )

    date_to: datetime | None = Field(
        default = None,
        description = "Filter uploads created before this date"
    )

    user_id: UUID | None = Field(
        default = None,
        description =
        "Search only within specific user's uploads (admin feature)",
    )

    @field_validator("query")
    @classmethod
    def clean_query(cls, v: str) -> str:
        """
        Clean and validate search query.
        """
        cleaned = " ".join(v.split())

        if not cleaned:
            raise ValueError("Query cannot be empty after cleaning")

        return cleaned

    @field_validator("date_to")
    @classmethod
    def validate_date_range(
        cls,
        v: datetime | None,
        info: ValidationInfo
    ) -> datetime | None:
        """
        Ensure date_to is after date_from if both provided
        """
        if v is not None and "date_from" in info.data:
            date_from = info.data["date_from"]
            if date_from is not None and v <= date_from:
                raise ValueError("date_to must be after date_from")
        return v
```

---

## Class Documentation

### SearchRequest Documentation

**Class Responsibility and Purpose:**
The `SearchRequest` class is a data model for handling advanced filtering options in semantic search queries. It ensures that all input parameters are validated and cleaned before processing, adhering to specific constraints such as query length, date ranges, and file types.

**Public Interface (Key Methods):**
- **Fields**: The class defines several fields with validation rules using Pydantic's `Field` and `field_validator`. Key fields include `query`, `limit`, `similarity_threshold`, `file_types`, `date_from`, `date_to`, and `user_id`.
- **Validators**:
  - `clean_query`: Cleans the search query by stripping whitespace and ensuring it is not empty.
  - `validate_date_range`: Ensures that `date_to` is after `date_from` if both are provided.

**Design Patterns Used:**
The class employs Pydantic's data validation mechanisms, which include:
- **Field Validators**: Custom validators (`clean_query`, `validate_date_range`) to enforce business rules.
- **Configurable Model**: The `model_config` attribute configures the model behavior (e.g., extra fields handling).

**Relationship to Other Classes:**
This class is part of a larger schema definition in the `/home/yoshi/dev/CURRENT/vuemantics/backend/schemas/search.py` file. It interacts with other models and services that handle search requests, ensuring data integrity before processing.

**State Management Approach:**
The class uses Pydantic's field annotations to manage state, leveraging validation at both field and model levels to ensure data consistency. This approach minimizes the need for external state management libraries or complex validation logic in service layers.

---

*Generated by CodeWorm on 2026-02-19 07:04*
