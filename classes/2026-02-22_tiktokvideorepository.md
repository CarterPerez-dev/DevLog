# TikTokVideoRepository

**Type:** Class Documentation
**Repository:** angelamos-operations
**File:** CarterOS-Server/src/aspects/analytics/facets/data_input/repository.py
**Language:** python
**Lines:** 17-109
**Complexity:** 0.0

---

## Source Code

```python
class TikTokVideoRepository(BaseRepository[TikTokVideo]):
    """
    Repository for TikTok video analytics operations
    """
    model = TikTokVideo

    @classmethod
    async def get_by_rank_range(
        cls,
        session: AsyncSession,
        min_rank: int,
        max_rank: int,
    ) -> Sequence[TikTokVideo]:
        """
        Get videos within a rank range
        """
        result = await session.execute(
            select(TikTokVideo).where(
                TikTokVideo.rank >= min_rank,
                TikTokVideo.rank <= max_rank
            ).order_by(TikTokVideo.rank)
        )
        return result.scalars().all()

    @classmethod
    async def get_by_date_range(
        cls,
        session: AsyncSession,
        start_date: date,
        end_date: date,
    ) -> Sequence[TikTokVideo]:
        """
        Get videos posted within a date range
        """
        result = await session.execute(
            select(TikTokVideo).where(
                TikTokVideo.date_posted >= start_date,
                TikTokVideo.date_posted <= end_date
            ).order_by(TikTokVideo.date_posted.desc())
        )
        return result.scalars().all()

    @classmethod
    async def get_by_min_views(
        cls,
        session: AsyncSession,
        min_views: int,
    ) -> Sequence[TikTokVideo]:
        """
        Get videos with minimum view count
        """
        result = await session.execute(
            select(TikTokVideo).where(TikTokVideo.views >= min_views
                                      ).order_by(TikTokVideo.views.desc())
        )
        return result.scalars().all()

    @classmethod
    async def search_videos(
        cls,
        session: AsyncSession,
        query: str,
    ) -> Sequence[TikTokVideo]:
        """
        Search across hook, description, hashtags, CTA, and transcription
        """
        search_term = f"%{query}%"
        result = await session.execute(
            select(TikTokVideo).where(
                or_(
                    TikTokVideo.hook.ilike(search_term),
                    TikTokVideo.description.ilike(search_term),
                    TikTokVideo.cta.ilike(search_term),
                    TikTokVideo.full_transcription.ilike(search_term),
                )
            ).order_by(TikTokVideo.rank)
        )
        return result.scalars().all()

    @classmethod
    async def get_all_ordered(
        cls,
        session: AsyncSession,
        order_by: str = "rank",
    ) -> Sequence[TikTokVideo]:
        """
        Get all videos ordered by specified field
        """
        order_field = getattr(TikTokVideo, order_by, TikTokVideo.rank)
        result = await session.execute(
            select(TikTokVideo).order_by(order_field)
        )
        return result.scalars().all()
```

---

## Class Documentation

### TikTokVideoRepository Documentation

**Class Responsibility:**
The `TikTokVideoRepository` class is responsible for managing operations related to TikTok video analytics, providing a structured way to interact with TikTokVideo data stored in a database.

**Public Interface:**
- `get_by_rank_range`: Fetches videos within a specified rank range.
- `get_by_date_range`: Retrieves videos posted between two dates.
- `get_by_min_views`: Fetches videos that meet or exceed a minimum view count.
- `search_videos`: Searches for videos based on various fields like hook, description, CTA, and transcription.
- `get_all_ordered`: Returns all videos ordered by a specified field.

**Design Patterns:**
The class uses the **Repository Pattern**, which encapsulates data access logic. The methods are designed to be agnostic of how the data is stored, allowing for potential changes in storage mechanisms without affecting the client code.

**Relationship and Architecture:**
- This repository interacts with `TikTokVideo` model objects.
- It is part of a broader analytics system within the `angelamos-operations` project, providing essential functionality to manage video data efficiently.
- The methods are designed to be called by higher-level services or controllers that need to perform CRUD-like operations on TikTok videos.

This class ensures a clean separation between business logic and database interactions, making it easier to maintain and scale.

---

*Generated by CodeWorm on 2026-02-22 02:38*
